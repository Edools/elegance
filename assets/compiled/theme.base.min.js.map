{"version":3,"sources":["theme.base.min.js","app.js","blazy.js","categoryList.js","chat.js","checkout.js","ckeditor.js","colaborativeDiscussion.js","contrastMode.js","courseRating.js","datepicker.js","deadpoolChat.js","examQuestionForm.js","fixOnScroll.js","follow.js","forumFeed.js","lessonList.js","lessonPage.js","mask.js","notepad.js","postsForm.js","readmore.js","recaptcha.js","simpleEditor.js","statistics.js","strongPassword.js","studentDoubts.js","timetags.js","timezone.js","main.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","window","app","bindGlobal","FastClick","attach","document","body","$","timeago","trigger","bindOpenOnLoad","toOpen","length","each","i","elem","open","attr","bindTooltips","tooltip","selector","checkFormValidity","event","form","currentTarget","submitButton","find","checkValidity","removeAttr","bindCepService","on","_event","result","val","street","city","state","neighborhood","complement","bindValidationCpf","$userCpf","data","$field","this","$parents","parent","$validationMessage","class","text","$button","parents","$validationMessagesList","isValid","CPF","validate","size","after","prop","remove","init","bindRecaptcha","bindBlazy","bindMasks","bindReadMore","bindDatepicker","bindFixOnScroll","ckeditor","bindCkeditor","bindCheckout","bindForumFeed","bindCourseRating","deadpoolChat","bindDeadpool","lessonList","chat","studentDoubts","notepad","categoryList","bindExamQuestionForm","changeTimeZone","followBind","lessonPage","timeTags","bindPostsForm","accessibility","bindStrongPassword","randomQuizStatistics","bindCollaborativeDiscussion","e","Blazy","self","$categoryList","isActive","bindClicks","expandParents","expandParent","$parent","animate","$nextListGroup","first","$parentCategoryItem","stop","slideToggle","toggle","toggleClass","$loopItem","groupsPagination","page","perPage","totalPages","collaboratorsPagination","followsPagination","$chat","$groups","$students","$roomTitle","$roomUsersCount","$text","$messagesContainer","$messagesScroll","$sendForm","$loadMoreGroupsButton","$loadMoreCollaboratorsButton","$loadMoreStudentsButton","$generalChatGroup","user","schoolId","apiKey","userId","id","chatType","chatLesson","bindScroll","empty","keyup","code","keyCode","which","shiftKey","submitMessage","simpleEditor","firebase","apps","initializeApp","CHAT_CONFIG","database","authenticate","lessonRoomUsers","ref","hide","changeRoom","registerCurrentUser","loadRoomOnlineUsers","off","userFirebase","loadSchoolGroup","loadGroups","loadCollaborators","loadFollows","listenConnectionChanges","ajax","url","CHAT_FIREBASE_SERVICE_HOST","method","headers","Authorization","success","auth","signInWithCustomToken","firebase_token","then","response","monitorConnectionState","error","console","userRef","child","uid","snap","onDisconnect","set","onIdle","onAway","onBack","connectionsRef","updateStatus","status","$element","orderByChild","equalTo","Number","once","snapshot","hasChildren","forEach","html","height","parentHeight","isPercentHeight","indexOf","replace","chatHeight","scrollbar","sanitizeHtml","$root","children","el","$el","tagName","last","get","pad","n","preventDefault","$html","focus","date","Date","messages","push","name","first_name","avatar_url","cover_image_url","timestamp","moment","unix","schedule","getHours","getMinutes","scrollToEnd","scrollTop","scrollHeight","renderMessage","renderTemplate","avatar","format","append","liquid","template","Liquid","parse","render","loadMessages","setMessage","bind","limitToLast","setUser","removeUser","CORE_HOST","is_school","prepend","total_pages","groups","_","sortBy","map","g","group","selectFirstRoomAvailable","addProfileItems","collaborators","users","divClass","removeClass","roomName","title","addClass","ids","parseInt","sort","$selectedRoom","click","change","is","src","loadAsset","index","ckeditorObj","config","buildConfiguration","placeholder","CKEDITOR","bindCkeditorSubmit","language","skin","uploadUrl","extraPlugins","imageUploadUrl","filebrowserImageUploadUrl","editor","$editor","$form","editorId","hasCaptcha","$submitButton","instances","bindNotifications","getData","cancelNotification","evt","notification","override","cancel","plugins","message","lang","uploadwidget","uploadOne","type","show","update","doneOne","commentId","$comment","toggleHighContrast","arrayOfPrices","itemList","element","price","innerHTML","currencyPosition","hasPor","commaPosition","substring","posAfterComma","slice","setAttribute","scrollToDiv","_possibleAddresses","location","address","possibleAddresses","","pageName","divName","cart","sign_in","enrollments","forums","products","edit","certificates","channels","orders","profile","href","search","lastIndexOf","$mainContentDiv","$elementToScroll","offset","top","checkAccessibiltyFunction","selectedElement","keydown","courseId","modal","fn","datepicker","defaults","$hidden","insertBefore","frontDate","utc","serverDate","$deadpool","$jwt","$message_list","$message_inputs","$chat_room","$is_before","$message_form","$message_input","message_body","renderNewMessage","buildNotification","that","deadpool","joinRoom","connect","log","hour","$msg_html","_this","bindMessageEvents","bindPresenceEvent","join","_this2","should_scroll_to_bottom","presenceList","sendMessage","options","$question","optionIndex","assertionId","hasClass","innerWidth","wrap","$wrapper","width","outerWidth","outerHeight","css","position","left","z-index","mouseenter","mouseleave","$this","openText","closeText","$accordionBody","collapse","fixForumFeed","topicId","$postsCounter","$postsCounterSize","counter","buildLazyLoadUrl","enrollmentId","getPaymentMethod","warn","request","async","responseJSON","payment_method","getLessonsInfo","lessons_info","onTrial","paymentMethod","undefined","courseTreeExists","courseTree","course","enrollment","courseContent","userType","lessonActions","downloadAction","currentLessonId","hasRequirements","translations","renderAttendanceElement","lessonsInfo","assign","lessonProgress","completed","progressIcon","checkNextButtonUnlocked","handleLessons","loadTopModules","bindChangeLesson","$mediaControls","enrollment_id","requirementsExists","$item","content_id","checkLessonCompleted","lazyLoadButtons","lessons","currentLesson","toggleButton","lessonListPanel","iconType","progress","cb","requirementsElements","filter","item","requirementsUnified","idx","requirements","toArray","exists","lesson_id","lessons_progresses","bindChangeLessonActive","course_path_regex","lesson_path_regex","path","pathname","lesson_path","test","path_array","split","changeLesson","target","stopPropagation","loadChildren","toggleSidebar","getLessonIcon","lesson","lessonIcon","activity","media","getContentPath","content","getContentDownloadPath","checkLessonLocked","lessonLockAt","lock_at","lessonLockAfter","lock_after","enrollmentActivatedAt","activated_at","startOf","lessonLockTime","add","checkLessonAvailability","releaseAt","release_at","releaseAfter","release_after","releaseTime","checkTrialByType","constrainsName","$tree","schoolProduct","constrainsTree","trial_constrains","constrains","hasConstrains","keys","hasOwnProperty","on_trial","fetchModules","level","$list","res","modules","course_modules","m","module","allModules","available","course_content_ids","$modules","fetchChildren","courseContents","course_contents","$courseContents","active","hideInProgressIcon","hideCompletedIcon","lessonReleased","releaseType","releaseDate","lessonLocked","lockLessonType","lockLessonDate","in_progress","requirement","JSON","stringify","views","max_attendance_length","max_attendance_type","translation","zone","tz","guess","isDownloadableMedia","downloadable","isAttempts","topModules","x","parent_course_module","disabled","prev","fadeOut","fadeIn","expandParentModules","parent_modules_hash","opacity","appendTo","when","slideDown","slideUp","originalEvent","$new","direction","$targetLesson","$prev","prevAll","$next","nextAll","parentModules","loopModule","course_module","parent_module","reverse","eachSeries","moduleId","$module","REGEX_COLLABORATIVE_DISCUSSIONS","REGEX_EXAM_ANSWERS","isCollaborativeDiscuttion","isExamAnswer","ajaxSuccess","xhr","settings","$currentItemIcon","phoneMaskBehavior","phoneMaskOptions","onKeyPress","field","mask","apply","arguments","noteContainer","loadNote","saveNote","note","note_id","buttonLabel","_id","post","speed","collapsedHeight","moreText","lessText","currHeight","innerHeight","showLink","readmore","moreLink","lessLink","onLoadRecaptcha","$recaptcha","grecaptcha","sitekey","elId","disableButton","buttonSelector","$formButton","callback","createShortcut","bindKey","isMac","navigator","platform","toUpperCase","bindFunction","character","String","fromCharCode","ctrl","ctrlKey","meta","metaKey","score","handleDrag","handleDrop","clientX","y","clientY","file","dataTransfer","files","URLObj","URL","webkitURL","source","createObjectURL","match","img","createElement","range","caretPositionFromPoint","pos","createRange","setStart","offsetNode","insertNode","caretRangeFromPoint","updateButtons","bold","queryCommandState","italic","underline","container","$container","$input","$btnAction","registerTriggers","registerDropZone","registerShortcuts","action","execCommand","dropZone","$statistic","statisticArray","finalArray","property","attributes","tag","difficulty","quantity","hits","groupedTags","uniqBy","currentID","matchedTags","matches","totalQuantity","totalHits","finalTag","finalDifficulty","totalErrors","performance","toFixed","total","correct_anwsers","wrong_answers","vocabulary","$div","textAnswered","textRight","textWrong","textPerformance","strength","pass","force","lowerLetters","upperLetters","numbers","symbols","input","alert","doubtsContainer","expandButton","hideButton","loadMoreButton","loadDoubts","per_page","complete","$btn","$edoolsPlayerContainer","edoolsPlayer","time","setTime","ready"],"mappings":"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","file":"theme.base.min.js","sourcesContent":["'use strict';\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n(function () {\n  'use strict';\n\n  window.app = {\n    bindGlobal: function bindGlobal() {\n      FastClick.attach(document.body);\n\n      $('.timeago').timeago();\n\n      $(document).trigger('app:bind:global');\n    },\n\n    bindOpenOnLoad: function bindOpenOnLoad() {\n      var toOpen = $('.js-open-on-load');\n      if (toOpen.length > 0) {\n        $.each(toOpen, function (i, elem) {\n          window.open($(elem).attr('href'));\n        });\n      }\n\n      $(document).trigger('app:bind:open_on_load');\n    },\n\n    bindTooltips: function bindTooltips() {\n      $(\"body\").tooltip(\"destroy\").tooltip({\n        selector: '[data-toggle=\"tooltip\"]'\n      });\n\n      $(document).trigger('app:bind:tooltips');\n    },\n\n    checkFormValidity: function checkFormValidity(event) {\n      var form = event.currentTarget;\n      var submitButton = $(form).find('button[type=\"submit\"]');\n\n      if (form.checkValidity()) {\n        submitButton.removeAttr('disabled');\n      } else {\n        submitButton.attr('disabled', 'disabled');\n      }\n\n      $(document).trigger('app:bind:check_form_validity');\n    },\n\n    bindCepService: function bindCepService() {\n      $(document).on('cep-result', function (_event, result) {\n        if (result) {\n          $('input[name=\"user[address_attributes][street]\"]').val(result.street);\n          $('input[name=\"user[address_attributes][city]\"]').val(result.city);\n          $('input[name=\"user[address_attributes][state]\"]').val(result.state);\n          $('input[name=\"user[address_attributes][district]\"]').val(result.neighborhood);\n          $('input[name=\"user[address_attributes][complement]\"]').val(result.complement);\n        }\n      });\n    },\n    bindValidationCpf: function bindValidationCpf() {\n      var $userCpf = $('#user-cpf');\n\n      if ($userCpf.data('validate-cpf')) {\n        $userCpf.on('keyup', function () {\n          var $field = $(this);\n          var $parents = $field.parent();\n          var $validationMessage = $('<span />', {\n            class: 'color-danger',\n            text: 'O cpf preenchido é inválido.'\n          });\n          var $button = $field.parents('form').find('button[type=\"submit\"], input[type=\"submit\"]');\n          var $validationMessagesList = $parents.find('.color-danger');\n          var isValid = CPF.validate($field.val());\n\n          if ($validationMessagesList.size() < 1 && !isValid && $field.val() !== '') {\n            $field.after($validationMessage);\n\n            $button.prop('disabled', true);\n          }\n\n          if (isValid || $field.val() === '') {\n            $validationMessagesList.remove();\n\n            $button.prop('disabled', false);\n          }\n        });\n      }\n    },\n\n\n    init: function init() {\n      app.bindGlobal();\n      app.bindRecaptcha();\n      app.bindBlazy();\n      app.bindOpenOnLoad();\n      app.bindMasks();\n      app.bindTooltips();\n      app.bindReadMore();\n      app.bindDatepicker();\n      app.bindFixOnScroll();\n      app.ckeditor.bindCkeditor();\n      app.bindCheckout();\n      app.bindForumFeed();\n      app.bindCourseRating();\n      app.deadpoolChat.bindDeadpool();\n      app.lessonList.init();\n      app.chat.init();\n      app.studentDoubts.init();\n      app.notepad.init();\n      app.categoryList.init();\n      app.bindExamQuestionForm();\n      app.changeTimeZone();\n      app.followBind();\n      app.lessonPage();\n      app.timeTags();\n      app.bindPostsForm();\n      app.accessibility();\n      app.bindStrongPassword();\n      app.bindValidationCpf();\n      app.randomQuizStatistics();\n      app.bindCepService();\n\n      $(document).on('app:bind:ckeditor_submit', app.bindCollaborativeDiscussion);\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindBlazy = function (e) {\n    new Blazy();\n\n    $(document).trigger('app:bind:blazy');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.categoryList = {\n    init: function init() {\n      var self = this;\n      self.$categoryList = $('#js-category-list');\n\n      if (self.$categoryList.length == 0) return;\n\n      self.isActive = self.$categoryList.data('is-active') || self.isActive;\n\n      if (!self.isActive) {\n        self.bindClicks();\n        self.$categoryList.attr('data-is-active', true);\n        self.isActive = true;\n      }\n\n      self.expandParents();\n    },\n\n    bindClicks: function bindClicks() {\n      var self = this;\n\n      $(document).on('click', '#js-category-list .category-item .toggle-btn', function () {\n        self.expandParent($(this).parent('.category-item'), true);\n      });\n    },\n\n    expandParent: function expandParent($parent, animate) {\n      var $nextListGroup = $parent.find('.list-group').first();\n      var $parentCategoryItem = $parent;\n\n      if (animate) {\n        $nextListGroup.stop().slideToggle('fast');\n      } else {\n        $nextListGroup.stop().toggle();\n      }\n\n      $parentCategoryItem.toggleClass('expanded');\n    },\n\n    expandParents: function expandParents() {\n      var self = this;\n      var $loopItem = self.$categoryList.find('.category-item.current').first();\n\n      while ($loopItem) {\n        self.expandParent($loopItem, false);\n\n        var $parent = $loopItem.parents('.category-item').first();\n\n        if ($parent.length > 0) {\n          $loopItem = $parent;\n        } else {\n          $loopItem = null;\n        }\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.chat = {\n    groupsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    collaboratorsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    followsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n\n    init: function init() {\n      var self = this;\n\n      self.$chat = $('.js-chat');\n\n      if (self.$chat.length <= 0) {\n        return;\n      }\n\n      self.$groups = $('.js-groups', self.$chat);\n      self.$students = $('.js-students', self.$chat);\n      self.$roomTitle = $('#js-room-title');\n      self.$roomUsersCount = $('#js-room-users-count');\n      self.$text = $('.js-chat-text');\n      self.$messagesContainer = $('.js-chat-messages .js-content');\n      self.$messagesScroll = $('.js-chat-messages .js-scroll');\n      self.$sendForm = $('#js-send-messages');\n      self.$loadMoreGroupsButton = self.$chat.find('.js-load-more-groups');\n      self.$loadMoreCollaboratorsButton = self.$chat.find('.js-load-more-collaborators');\n      self.$loadMoreStudentsButton = self.$chat.find('.js-load-more-students');\n      self.$generalChatGroup = self.$chat.find('.js-chat-group-general');\n\n      self.user = self.$chat.data('user');\n      self.schoolId = self.$chat.data('school-id');\n      self.apiKey = self.$chat.data('api-key');\n      self.userId = self.user.id;\n      self.chatType = self.$chat.data('type');\n      self.chatLesson = self.$chat.data('lesson');\n\n      self.bindScroll();\n\n      self.$messagesContainer.empty();\n\n      // bind form\n      self.$text.keyup(function (e) {\n        var code = e.keyCode ? e.keyCode : e.which;\n        if (code === 13 && !e.shiftKey) {\n          self.submitMessage(e);\n        }\n      });\n\n      app.simpleEditor.init('#js-send-messages');\n      self.$sendForm.on('submit', self.submitMessage);\n\n      if (firebase.apps.length <= 0) {\n        firebase.initializeApp(window.CHAT_CONFIG);\n      }\n\n      self.database = firebase.database();\n\n      self.authenticate();\n\n      if (self.chatType === 'lesson-chat') {\n        self.lessonRoomUsers = self.database.ref('lesson_room_users/' + self.chatLesson.id);\n        self.$loadMoreStudentsButton.hide();\n        self.changeRoom(null);\n        self.registerCurrentUser();\n        self.loadRoomOnlineUsers();\n\n        $(document).off('page:before-change').on('page:before-change', function () {\n          if (self.userFirebase) {\n            self.userFirebase.remove();\n          }\n        });\n      } else {\n        self.loadSchoolGroup();\n        self.loadGroups();\n        self.loadCollaborators();\n        self.loadFollows();\n\n        self.$loadMoreGroupsButton.on('click', function () {\n          self.loadGroups();\n        });\n\n        self.$loadMoreCollaboratorsButton.on('click', function () {\n          self.loadCollaborators();\n        });\n\n        self.$loadMoreStudentsButton.on('click', function () {\n          self.loadFollows();\n        });\n\n        self.$generalChatGroup.on('click', function () {\n          self.changeRoom({\n            currentTarget: self.$generalChatGroup\n          });\n        });\n      }\n\n      self.listenConnectionChanges();\n    },\n\n    authenticate: function authenticate() {\n      var self = app.chat;\n\n      $.ajax({\n        url: window.CHAT_FIREBASE_SERVICE_HOST + '/authenticate',\n        method: 'POST',\n        headers: {\n          'Authorization': self.apiKey\n        }\n      }).success(function (data) {\n        firebase.auth().signInWithCustomToken(data.body.firebase_token).then(function (response) {\n          self.monitorConnectionState(response);\n        }).catch(function (error) {\n          console.error('Error creating custom token:', error);\n        });\n      }).error(function (error) {\n        console.error('Could not authenticate', error);\n      });\n    },\n\n    monitorConnectionState: function monitorConnectionState(response) {\n      var userRef = firebase.database().ref('user_status').child(response.uid);\n\n      // Monitor connection state on browser tab\n      firebase.database().ref('.info/connected').on('value', function (snap) {\n        if (snap.val()) {\n          // if we lose network then remove this user from the list\n          userRef.onDisconnect().set('offline');\n          // set user's online status\n          userRef.set('online');\n        }\n      });\n\n      document.onIdle = function () {\n        userRef.set('idle');\n      };\n\n      document.onAway = function () {\n        userRef.set('away');\n      };\n\n      document.onBack = function () {\n        userRef.set('online');\n      };\n    },\n\n    listenConnectionChanges: function listenConnectionChanges() {\n      var self = app.chat;\n      var connectionsRef = this.database.ref('user_status');\n\n      connectionsRef.on('child_added', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_changed', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_removed', function (data) {\n        self.updateStatus(data.val(), 'offline');\n      });\n    },\n\n    updateStatus: function updateStatus(status, userId) {\n      var self = this;\n\n      var $element = $('*[data-id=\"' + userId + '\"]');\n\n      if (self.chatType === 'lesson-chat') {\n        if (status === 'offline') {\n          if ($element.length) {\n            $element.remove();\n          }\n\n          self.lessonRoomUsers.orderByChild('id').equalTo(Number(userId)).once('value').then(function (snapshot) {\n            if (snapshot.hasChildren()) {\n              snapshot.forEach(function (snap) {\n                self.lessonRoomUsers.child(snap.key).remove();\n              });\n            }\n\n            self.$roomUsersCount.html($('.chat-profile-list-item', self.$students).length);\n          });\n        }\n      } else {\n        if ($element.length) {\n          $('.status .icon', $element).first().attr('class', 'icon icon-' + status);\n        }\n      }\n    },\n\n    bindScroll: function bindScroll() {\n      var height = this.$chat.data('height');\n      var parent = this.$chat.data('parent');\n      var parentHeight = parent ? $(parent).height() : $(window).height();\n      var isPercentHeight = height.indexOf('%') > -1;\n      height = Number(height.replace('%', '').replace('px', ''));\n\n      if (isPercentHeight === true) {\n        this.chatHeight = parentHeight / 100 * height;\n      } else {\n        this.chatHeight = height;\n      }\n\n      this.$chat.height(this.chatHeight);\n      this.$chat.find('.js-sidebar-scroll').scrollbar({});\n      this.$chat.find('.js-chat-messages .js-scroll').scrollbar({});\n    },\n\n    sanitizeHtml: function sanitizeHtml($root) {\n      $root.find('div:empty').remove();\n\n      // Removes elements with only '<br/>' children\n      $root.children().each(function (i, el) {\n        var $el = $(el);\n        if (el.tagName !== 'BR' && $el.find('br').length > 0 && $el.find('br').length == $el.children().length) {\n          $el.remove();\n        }\n      });\n\n      // Removes last '<br/>'\n      if ($root.last().get(0).tagName === 'BR') {\n        $root.last().remove();\n      }\n\n      return $root;\n    },\n\n    submitMessage: function submitMessage(event) {\n      event.preventDefault();\n      var self = app.chat;\n\n      var $html = self.sanitizeHtml(self.$text);\n      var text = $html.html();\n\n      if (text.length <= 0) return;\n\n      self.$text.html('').focus();\n\n      function pad(n) {\n        return n < 10 ? '0' + n : n;\n      }\n\n      var date = new Date();\n\n      self.messages.push({\n        id: self.user.id,\n        name: self.user.first_name,\n        avatar_url: self.user.cover_image_url,\n        text: text,\n        timestamp: moment().unix(),\n        schedule: pad(date.getHours()) + ':' + pad(date.getMinutes())\n      });\n    },\n\n    scrollToEnd: function scrollToEnd() {\n      var self = this;\n      self.$messagesScroll.scrollTop(self.$messagesScroll[0].scrollHeight);\n    },\n\n    renderMessage: function renderMessage(data) {\n      var self = app.chat;\n      var html = self.renderTemplate('chat-message', {\n        avatar: data.avatar_url,\n        name: data.name,\n        text: data.text,\n        schedule: moment.unix(data.timestamp).format('LLL')\n      });\n\n      self.$messagesContainer.append(html);\n      self.scrollToEnd();\n    },\n\n    renderTemplate: function renderTemplate(key, data) {\n      var liquid = $('#' + key + '-template').html();\n      var template = Liquid.parse(liquid);\n\n      return template.render(data);\n    },\n\n    loadMessages: function loadMessages() {\n      var self = app.chat;\n      var setMessage = function (data) {\n        self.renderMessage(data.val());\n      }.bind(self);\n\n      self.messages.limitToLast(12).on('child_added', setMessage);\n      self.messages.limitToLast(12).on('child_changed', setMessage);\n    },\n\n    loadRoomOnlineUsers: function loadRoomOnlineUsers() {\n      var self = app.chat;\n      var setUser = function (data) {\n        var $html = $(self.renderTemplate('chat-profile-list-item', data.val()));\n        $('.js-students', self.$chat).append($html);\n        self.$roomUsersCount.html($('.chat-profile-list-item', self.$students).length);\n      }.bind(self);\n\n      var removeUser = function (data) {\n        $('.js-students [data-id=\"' + data.val().id + '\"]').remove();\n        self.$roomUsersCount.html($('.chat-profile-list-item', self.$students).length);\n      }.bind(self);\n\n      self.lessonRoomUsers.on('child_added', setUser);\n      self.lessonRoomUsers.on('child_removed', removeUser);\n    },\n\n    loadSchoolGroup: function loadSchoolGroup() {\n      var self = app.chat;\n      $.ajax({\n        url: window.CORE_HOST + '/chat/school_group',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        data.is_school = true;\n\n        var $html = $(self.renderTemplate('chat-group-list-item', data));\n        $html.on('click', app.chat.changeRoom);\n        self.$groups.prepend($html);\n      });\n    },\n\n    loadGroups: function loadGroups() {\n      var self = app.chat;\n      self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/groups?per_page=' + self.groupsPagination.perPage + '&page=' + (self.groupsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.groupsPagination.page = self.groupsPagination.page + 1;\n        self.$loadMoreGroupsButton.removeAttr('disabled', 'disabled');\n        self.groupsPagination.totalPages = data.total_pages;\n\n        if (self.groupsPagination.page >= self.groupsPagination.totalPages) {\n          self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n        }\n\n        var groups = data.groups;\n        groups = _.sortBy(groups, { is_school: false });\n        groups = _.map(groups, function (g) {\n          g.is_school = false;\n          return g;\n        });\n\n        groups.forEach(function (group) {\n          var $html = $(self.renderTemplate('chat-group-list-item', group));\n          $html.on('click', app.chat.changeRoom);\n          self.$groups.append($html);\n        });\n\n        self.selectFirstRoomAvailable();\n      });\n    },\n\n    loadCollaborators: function loadCollaborators() {\n      var self = app.chat;\n      self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/collaborators?per_page=' + self.collaboratorsPagination.perPage + '&page=' + (self.collaboratorsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.collaboratorsPagination.page = self.collaboratorsPagination.page + 1;\n        self.$loadMoreCollaboratorsButton.removeAttr('disabled', 'disabled');\n        self.collaboratorsPagination.totalPages = data.total_pages;\n\n        if (self.collaboratorsPagination.page >= self.collaboratorsPagination.totalPages) {\n          self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n        }\n\n        self.addProfileItems(data.collaborators, 'js-team');\n        self.selectFirstRoomAvailable();\n      });\n    },\n\n    loadFollows: function loadFollows() {\n      var self = app.chat;\n      self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/follows?per_page=' + self.followsPagination.perPage + '&page=' + (self.followsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.followsPagination.page = self.followsPagination.page + 1;\n        self.$loadMoreStudentsButton.removeAttr('disabled', 'disabled');\n        self.followsPagination.totalPages = data.total_pages;\n\n        if (self.followsPagination.page >= self.followsPagination.totalPages) {\n          self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n        }\n\n        self.addProfileItems(data.users, 'js-students');\n        self.selectFirstRoomAvailable();\n      });\n    },\n\n    registerCurrentUser: function registerCurrentUser() {\n      var self = this;\n\n      self.lessonRoomUsers.orderByChild('id').equalTo(self.user.id).once('value').then(function (snapshot) {\n        if (!snapshot.hasChildren()) {\n          self.lessonRoomUsers.push(self.user).then(function (snap) {\n            self.userFirebase = snap;\n          });\n        }\n      });\n    },\n\n    addProfileItems: function addProfileItems(users, divClass) {\n      var self = app.chat;\n\n      users.forEach(function (user) {\n        var $html = $(self.renderTemplate('chat-profile-list-item', user));\n        $html.on('click', app.chat.changeRoom);\n        $('.' + divClass).append($html);\n      });\n    },\n\n    changeRoom: function changeRoom(event) {\n      var self = app.chat;\n\n      $('.chat-sidebar-list-item').removeClass('active');\n\n      var roomName = 'messages';\n\n      if (self.chatType === 'lesson-chat') {\n        roomName += '_lessons/' + self.chatLesson.id;\n\n        // change room name on div\n        self.$roomTitle.html(self.chatLesson.title);\n        self.$roomUsersCount.html(0);\n      } else {\n        var $element = $(event.currentTarget);\n        $element.addClass('active');\n\n        if ($element.data('type') === 'products') {\n          // room name on firebase\n          roomName += '_products/' + $element.data('id');\n\n          // change room name on div\n          self.$roomTitle.html($('.js-chat-group-name', $element).html());\n          self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n        } else if ($element.data('type') === 'users') {\n          var ids = [self.userId, parseInt($element.data('id'))].sort();\n          roomName += '_users/' + ids[0] + '/' + ids[1];\n\n          // change room name on div\n          self.$roomTitle.html($('.info .name', $element).html());\n          self.$roomUsersCount.html($('.info .location', $element).html());\n        } else if ($element.data('type') === 'schools') {\n          // room name on firebase\n          roomName += '_schools/' + self.schoolId;\n\n          // change room name on div\n          self.$roomTitle.html($('.js-chat-group-name', $element).html());\n          self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n        }\n      }\n\n      self.$messagesContainer.html('');\n\n      if (self.messages) {\n        self.messages.off();\n      }\n\n      self.messages = self.database.ref(roomName);\n      self.loadMessages();\n    },\n\n    selectFirstRoomAvailable: function selectFirstRoomAvailable() {\n      if (!self.$selectedRoom) {\n        // Select first room\n        self.$selectedRoom = $('.chat-sidebar-list-item').first();\n        self.$selectedRoom.click();\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCheckout = function () {\n    $('#js-terms-of-use-check').change(function () {\n      if ($(this).is(\":checked\") === true) {\n        $('.cta-checkout-cart').removeClass('disabled');\n      } else {\n        $('.cta-checkout-cart').addClass('disabled');\n      }\n    });\n\n    $(document).trigger('app:bind:checkout');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.ckeditor = {\n    bindCkeditor: function bindCkeditor() {\n      var src = '//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js';\n\n      if ($('.js-ckeditor').length) {\n        loadAsset('window.CKEDITOR', src, function () {\n          $('.js-ckeditor').each(function (index, ckeditorObj) {\n            if (!$('#cke_' + ckeditorObj.id).length) {\n              var config = app.ckeditor.buildConfiguration(ckeditorObj);\n              config.placeholder = ckeditorObj.placeholder; // TODO: fix it\n\n              CKEDITOR.replace(ckeditorObj.id, config);\n            }\n          });\n\n          app.ckeditor.bindCkeditorSubmit();\n          $(document).trigger('app:bind:ckeditor');\n        });\n      }\n    },\n\n    buildConfiguration: function buildConfiguration(ckeditorObj) {\n      var config = {\n        language: 'pt-br',\n        skin: 'moono'\n      };\n\n      if ($(ckeditorObj).data('upload-image') == true) {\n        var uploadUrl = '/files/full_upload';\n\n        config.extraPlugins = 'uploadimage';\n        config.imageUploadUrl = uploadUrl;\n        config.filebrowserImageUploadUrl = uploadUrl;\n      }\n\n      return config;\n    },\n\n    bindCkeditorSubmit: function bindCkeditorSubmit() {\n      $.each($('.js-ckeditor'), function (index, editor) {\n        var $editor = $(editor);\n        var $form = $editor.parents('form');\n        var editorId = $editor.attr('id');\n        var hasCaptcha = $form.find('.js-recaptcha').size();\n\n        if ($form) {\n          var $submitButton = $form.find('button[type=\"submit\"]');\n          var editor = CKEDITOR.instances[editorId];\n\n          app.ckeditor.bindNotifications(editor);\n\n          editor.on('change', function () {\n            if (this.getData().length && !hasCaptcha) {\n              $submitButton.attr('disabled', false);\n            } else {\n              $submitButton.attr('disabled', true);\n            }\n          });\n        }\n      });\n\n      $(document).trigger('app:bind:ckeditor_submit');\n    },\n\n    bindNotifications: function bindNotifications(editor) {\n      var cancelNotification = function cancelNotification(evt) {\n        if (evt.data.notification.override !== true) {\n          evt.cancel();\n        }\n      };\n\n      editor.on('notificationShow', cancelNotification);\n      editor.on('notificationUpdate', cancelNotification);\n\n      editor.on('fileUploadRequest', function () {\n        editor.notification = new CKEDITOR.plugins.notification(editor, {\n          message: editor.lang.uploadwidget.uploadOne.replace('({percentage}%)', ''),\n          type: 'progress',\n          override: true\n        });\n\n        editor.notification.show();\n      });\n\n      editor.on('fileUploadResponse', function () {\n        editor.notification.update({\n          message: editor.lang.uploadwidget.doneOne,\n          type: 'success'\n        });\n      });\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCollaborativeDiscussion = function () {\n    $(document).on('click', '#collaborative-discussion .js-edit-button', function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').addClass('hide');\n      $comment.find('.js-edit-container').removeClass('hide');\n    });\n\n    $(document).on('click', '#collaborative-discussion .js-cancel-button', function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').removeClass('hide');\n      $comment.find('.js-edit-container').addClass('hide');\n    });\n\n    $(document).trigger('app:bind:collaborative_discussion');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.accessibility = function () {\n\n    var adjustPricesForAccessibility = function () {\n      //This function generates Aria-Labels for the tags with prices.\n      //Screen Readers can find some issues when reading '$' and ','.\n\n      var arrayOfPrices = [];\n      var itemList = $('.product-accessibility-list').find('li').find('a');\n\n      for (var i = 0; i < itemList.length; i++) {\n        arrayOfPrices[i] = itemList[i];\n      }\n\n      arrayOfPrices.forEach(function (element) {\n\n        var price = element.innerHTML.replace(/\\s+/g, ' ').replace('<span>', '').replace('</span>', '').replace('<a>', '').replace('</a>', '');\n\n        var currencyPosition = price.indexOf('R$');\n        var hasPor = price.indexOf('por');\n        var commaPosition = price.indexOf(',');\n\n        if (currencyPosition != -1) {\n\n          if (hasPor != -1) {\n\n            price = price.substring(currencyPosition + 3, price.length);\n            var posAfterComma = commaPosition + 3;\n            price = price.slice(0, posAfterComma) + ' reais' + price.slice(posAfterComma, price.length);\n          } else {\n            price = price.substring(currencyPosition + 3, commaPosition + 3) + ' reais';\n          }\n\n          price = price.replace(',00', '');\n        }\n        element.setAttribute('aria-label', price);\n      });\n    }();\n\n    var toggleHighContrast = function toggleHighContrast() {\n      $(\"html\").toggleClass('accessible');\n      $(\".accessibility-constrast-state-on\").toggleClass(\"hidden\");\n      $(\".accessibility-constrast-state-off\").toggleClass(\"hidden\");\n    };\n\n    $(\".contrast-on-btn\").on('click', function () {\n      toggleHighContrast();\n    });\n\n    var checkPageName = function () {\n      var _possibleAddresses;\n\n      //This function generates a text inside the \"accessibility-location\" div.\n      //It works like a map for Blind Users, since they may find it hard to know exactly on which page they're in.\n      var possibleAddresses = (_possibleAddresses = {\n        \"\": {\n          pageName: \"Página Inicial\",\n          divName: \"home\"\n        },\n        \"cart\": {\n          pageName: \"Carrinho\",\n          divName: \"cart\"\n        },\n        \"sign_in\": {\n          pageName: \"Fazer Login\",\n          divName: \"login\"\n        },\n        \"enrollments\": {\n          pageName: \"Meus Cursos\",\n          divName: \"enrollments\"\n        },\n        \"forums\": {\n          pageName: \"Fóruns\",\n          divName: \"forums\"\n        },\n        \"products\": {\n          pageName: \"Produtos\",\n          divName: \"products\"\n        },\n        \"edit\": {\n          pageName: \"Meu Perfil\",\n          divName: \"profile\"\n        },\n        \"certificates\": {\n          pageName: \"Meus Certificados\",\n          divName: \"certificates\"\n        },\n        \"channels\": {\n          pageName: \"Mensagens\",\n          divName: \"messages\"\n        },\n        \"orders\": {\n          pageName: \"Meus Pedidos\",\n          divName: \"orders\"\n        },\n        \"profile\": {\n          pageName: \"Perfil Público\",\n          divName: \"profile\"\n        }\n      }, _defineProperty(_possibleAddresses, 'products', {\n        pageName: \"Matrículas\",\n        divName: \"products\"\n      }), _defineProperty(_possibleAddresses, \"media\", {\n        pageName: \"Portifólio\",\n        divName: \"portifolio\"\n      }), _possibleAddresses);\n\n      var location, address;\n      location = window.location.href;\n\n      if (location.search('/profile/') != -1) {\n        if (location.search('products') != -1) address = 'products';else if (location.search('media') != -1) {\n          address = 'media';\n        } else {\n          address = 'profile';\n        }\n      } else {\n        address = location.substring(location.lastIndexOf('/') + 1, location.length);\n      }\n\n      window.$mainContentDiv = address && possibleAddresses && possibleAddresses[address] && possibleAddresses[address].divName;\n      address = address && possibleAddresses && possibleAddresses[address] && possibleAddresses[address].pageName;\n\n      if (address) {\n        $(\"#accessibility-location\").text(\"Você está em: \" + address + \" - Topo da Página\");\n      }\n    }();\n\n    var scrollToDiv = function scrollToDiv(id) {\n      var $elementToScroll = $(id);\n\n      if ($elementToScroll.size() > 0) {\n        $(window).scrollTop($elementToScroll.offset().top - 50);\n        $elementToScroll.focus();\n      }\n    };\n\n    var checkAccessibiltyFunction = function checkAccessibiltyFunction(selectedElement) {\n      // This Function listens to the accessibility-shortcuts.\n      // It helps the Screen Readers' users to navigate through the website.\n      var a = $mainContentDiv;\n\n      if (selectedElement == null) var selectedElement = $(':focus').attr('id');\n\n      switch (selectedElement) {\n        case 'accessibility-btn-1':\n          scrollToDiv(\"#accessibility-main-content-\" + $mainContentDiv);\n          break;\n        case 'accessibility-btn-2':\n          scrollToDiv(\"#main-navbar\");\n          break;\n        case 'accessibility-btn-3':\n          scrollToDiv(\"#accessibility-contact\");\n          break;\n        case 'accessibility-btn-4':\n          scrollToDiv(\"#accessibility-location\");\n          break;\n      }\n    };\n\n    $(window).keydown(function (e) {\n      if (!$(':focus').is('input')) {\n        //It avoids problems with SHIFT inside 'INPUTS'\n        switch (e.which) {\n          case 13:\n            //Enter\n            checkAccessibiltyFunction();\n            break;\n          case 49:\n            //1\n            if (e.shiftKey) checkAccessibiltyFunction('accessibility-btn-1');\n            break;\n          case 50:\n            //2\n            if (e.shiftKey) checkAccessibiltyFunction('accessibility-btn-2');\n            break;\n          case 51:\n            //3\n            if (e.shiftKey) checkAccessibiltyFunction('accessibility-btn-3');\n            break;\n          case 52:\n            //4\n            if (e.shiftKey) checkAccessibiltyFunction('accessibility-btn-4');\n            break;\n        }\n      }\n    });\n\n    $(document).trigger('app:bind:accessibility');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCourseRating = function () {\n    $(document).on(\"rate-course\", function (event, courseId) {\n      $('#js-rating-course-' + courseId + '-modal').modal();\n    });\n\n    $(document).on(\"course-rating-created\", function (event, courseId) {\n      $('#js-rating-course-' + courseId + '-modal').modal('hide');\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindDatepicker = function () {\n    // TODO: Handle i18n\n    $.fn.datepicker.defaults.language = 'pt-BR';\n\n    $('.datepicker').each(function (i, el) {\n      var $el = $(el);\n      var $hidden = $('<input type=\"hidden\" />').insertBefore($el.parent());\n      var frontDate = moment($el.val()).utc().format('DD/MM/YYYY');\n      var serverDate = moment($el.val()).utc().format('YYYY-MM-DD');\n      serverDate = serverDate === 'Invalid date' ? null : serverDate;\n\n      $hidden.attr('id', $el.attr('id'));\n      $hidden.attr('name', $el.attr('name'));\n      $hidden.attr('value', serverDate);\n\n      $el.removeAttr('id');\n      $el.removeAttr('name');\n\n      if ($el.val() !== \"\") {\n        $el.val(frontDate);\n      }\n\n      $(el).datepicker().on('change', function () {\n        var date = moment($el.val(), 'DD/MM/YYYY').utc().format('YYYY-MM-DD');\n        date = date === 'Invalid date' ? null : date;\n        $hidden.val(date);\n      });\n    });\n\n    $(document).trigger('app:bind:datepicker');\n  };\n})();\n\n/*********************************************************************\n *\n *  components/deadpoolChat.js\n *  @name: DeadpoolChat\n *\n *********************************************************************/\n\n(function () {\n  'use strict';\n\n  app.deadpoolChat = {\n    bindDeadpool: function bindDeadpool() {\n      var src = \"https://staging-cdn.eadbox.com/deadpooljs/dist.js\";\n\n      this.$deadpool = $('.deadpool-chat');\n      this.$jwt = this.$deadpool.data(\"jwt\");\n      this.$message_list = $('.chat-message-list');\n      this.$message_inputs = $('.message-inputs');\n      this.$chat_room = this.$deadpool.data(\"chat-room\");\n      this.$is_before = this.$deadpool.data(\"is-before\");\n      this.$message_form = $('form#message');\n      this.$message_input = this.$message_form.find('textarea[name=message-body]');\n\n      if (!this.$is_before) {\n        if (this.$deadpool.length) {\n          var that = this;\n          loadAsset('Deadpool', src, function () {\n            try {\n              deadpool.default.on('connected', function () {\n                app.deadpoolChat.joinRoom();\n              });\n\n              deadpool.default.on('connection_failed', function () {\n                var notification = {\n                  \"type\": \"close\",\n                  \"message_body\": \"Falha ao conectar com o chat!\"\n                };\n\n                app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n              });\n\n              deadpool.default.on('disconnected', function () {\n                var notification = {\n                  \"type\": \"exclamation\",\n                  \"message_body\": \"A conexão com o chat foi encerrada!\"\n                };\n\n                app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n              });\n\n              deadpool.default.connect(\"wss://deadpool.herospark.com/chat-service\", that.$jwt);\n            } catch (error) {\n              console.log(error);\n            }\n\n            $(document).trigger('app:deadpool:connected');\n          });\n\n          $(document).trigger('app:bind:deadpool');\n        }\n      } else {\n        var notification = {\n          \"type\": \"exclamation\",\n          \"message_body\": \"Esse Webinar ainda não começou\"\n        };\n\n        app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n      }\n    },\n    renderNewMessage: function renderNewMessage(message) {\n      var hour = moment(message.date).format(\"HH:mm\");\n\n      if (!this.$is_before && !message.notification) {\n        var $msg_html = $('\\n          <div class=\"row message-item\">\\n            <div class=\"message-header\">\\n              <div class=\"col-md-9\">\\n                <h5>' + message.user.name + '</h5>\\n              </div>\\n              <div class=\"col-md-3 message-timestamp\">\\n                <span class=\"message-timestamp\">' + hour + '</span>\\n              </div>\\n            </div>\\n            <div class=\"col-md-12 message-body\">\\n              <p>' + message.message + '</p>\\n            </div>\\n          </div>\\n        ');\n      } else {\n        var $msg_html = $('\\n          <div class=\"row message-item\">\\n            <div class=\"col-md-12 message-header\">\\n              <i class=\"icon-' + message.type + '\"> ' + message.message + '</i>\\n            </div>\\n          </div>\\n        ');\n      }\n\n      this.$message_list.append($msg_html);\n    },\n    joinRoom: function joinRoom() {\n      var _this = this;\n\n      try {\n        deadpool.default.on('joined_room', function () {\n          var notification = {\n            \"type\": \"check\",\n            \"message_body\": \"Conectado ao chat com sucesso!\"\n          };\n\n          app.deadpoolChat.bindMessageEvents();\n          app.deadpoolChat.bindPresenceEvent();\n\n          _this.$message_inputs.removeAttr('disabled');\n          app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n        });\n\n        deadpool.default.on('join_timeout join_crashed join_failed', function () {\n          var notification = {\n            \"type\": \"close\",\n            \"message_body\": \"Falha ao conectar com o chat!\"\n          };\n\n          app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n        });\n\n        deadpool.default.on('closed_room', function () {\n          var notification = {\n            \"type\": \"exclamation\",\n            \"message_body\": \"O chat da transmissão foi encerrado!\"\n          };\n\n          app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n        });\n\n        deadpool.default.join(this.$chat_room);\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    bindMessageEvents: function bindMessageEvents() {\n      var _this2 = this;\n\n      deadpool.default.on('new_message', function (message) {\n        var should_scroll_to_bottom = _this2.$message_list.scrollTop() + _this2.$message_list.height() == _this2.$message_list.prop(\"scrollHeight\");\n        app.deadpoolChat.renderNewMessage(message);\n\n        if (should_scroll_to_bottom) _this2.$message_list.animate({ scrollTop: _this2.$message_list.prop(\"scrollHeight\") }, 0);\n      });\n\n      deadpool.default.on('message_sent', function (message) {\n        var should_scroll_to_bottom = _this2.$message_list.scrollTop() + _this2.$message_list.height() == _this2.$message_list.prop(\"scrollHeight\");\n        app.deadpoolChat.renderNewMessage(message);\n\n        if (should_scroll_to_bottom) _this2.$message_list.animate({ scrollTop: _this2.$message_list.prop(\"scrollHeight\") }, 0);\n      });\n\n      this.$message_input.on('keyup', function (e) {\n        if (e.keyCode === 13) {\n          e.preventDefault();\n          app.deadpoolChat.submitMessage();\n        }\n      });\n\n      this.$message_form.on('submit', function (e) {\n        e.preventDefault();\n        app.deadpoolChat.submitMessage();\n      });\n\n      deadpool.default.on('message_failed message_timeout', function () {\n        var notification = {\n          \"type\": \"close\",\n          \"message_body\": \"Falha ao enviar messagem!\"\n        };\n\n        app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n      });\n    },\n    bindPresenceEvent: function bindPresenceEvent() {\n      // Binding the other events\n      deadpool.default.on('presence', function (presenceList) {\n        // `presenceList` is an array of users, use this to track who is online\n        $('#watch-number').text(' ' + presenceList.length);\n      });\n    },\n    submitMessage: function submitMessage() {\n      var message_body = this.$message_input.val();\n      this.$message_input.val('');\n\n      deadpool.default.sendMessage(message_body);\n    },\n    buildNotification: function buildNotification(options) {\n      var notification = {\n        \"notification\": true,\n        \"type\": options.type,\n        \"message\": options.message_body\n      };\n\n      return notification;\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindExamQuestionForm = function () {\n    $(document).on('click', '#js-remake-exam', function () {\n      $('#answers-container').addClass('hide');\n      $('#form-container').removeClass('hide');\n    });\n\n    $(document).on('click', '.js-clean-associative-options', function () {\n      $(this).parents('.associative-question').find('.js-associative-select option:selected').removeAttr('selected');\n    });\n\n    $(document).on('change', '.js-associative-select', function () {\n      var $question = $(this).parents('.associative-question');\n      var optionIndex = $(this).data('option-index');\n      var assertionId = $(this).find('option:selected').data('first-assertion-id');\n\n      $question.find('.js-associate-assertion[data-option-index=\"' + optionIndex + '\"]').val(assertionId);\n    });\n\n    // bind all form's inputs\n    $(document).on('change', '#exam_answer_form', app.checkFormValidity);\n    // bind all form's textareas for all types of typing\n    $(document).on('input propertychange', '#exam_answer_form', app.checkFormValidity);\n\n    $(document).trigger('app:bind:bind_exam_question_form');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindFixOnScroll = function () {\n    $('.js-fix-on-scroll').each(function (i, el) {\n      if (!$(el).hasClass('js-fix-on-scroll-mobile') && window.innerWidth < 992) {\n        return;\n      }\n\n      var $el = $(el);\n      $el.wrap('<div class=\"js-fix-scroll-wrapper\"/>');\n      var $wrapper = $el.parent('.js-fix-scroll-wrapper');\n\n      var offset = $el.offset();\n      var size = {\n        width: $el.outerWidth(),\n        height: $el.outerHeight()\n      };\n\n      $wrapper.width(size.width);\n      $wrapper.height(size.height);\n\n      $(document).on('scroll', function (e) {\n        var scrollTop = $(document).scrollTop();\n\n        if (scrollTop >= offset.top) {\n          if ($el.css('position') === 'fixed') return;\n\n          $el.parent().addClass('scroll');\n          $el.addClass('scroll');\n          $el.css({\n            position: 'fixed',\n            left: offset.left,\n            top: 0,\n            width: size.width,\n            height: size.height,\n            'z-index': '10000'\n          });\n        } else {\n          if ($el.css('position') === 'static') return;\n\n          $el.removeClass('scroll');\n          $el.parent().removeClass('scroll');\n          $el.css({\n            position: 'static',\n            left: 'auto',\n            top: 'auto',\n            width: 'auto',\n            height: 'auto'\n          });\n        }\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.followBind = function () {\n    $(document).on({\n      mouseenter: function mouseenter() {\n        $(this).addClass('hidden');\n        $('#js-unfollow').removeClass('hidden');\n      }\n    }, '#js-following');\n\n    $(document).on({\n      mouseleave: function mouseleave() {\n        $('#js-following').removeClass('hidden');\n        $(this).addClass('hidden');\n      }\n    }, '#js-unfollow');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindForumFeed = function () {\n    $(document).on(\"click\", \".js-collapse-toggle-text\", function (event) {\n      event.preventDefault();\n      var $this = $(this);\n      var openText = $this.data('open-text');\n      var closeText = $this.data('close-text');\n      var $accordionBody = $($this.attr('href'));\n\n      if ($accordionBody.hasClass('in')) {\n        $accordionBody.collapse('hide');\n        $this.html(closeText);\n      } else {\n        $accordionBody.collapse('show');\n        $this.html(openText);\n        app.bindBlazy();\n      }\n    });\n\n    $(document).on(\"fix_forum_feed\", function () {\n      app.fixForumFeed();\n    });\n\n    $(document).on(\"forum_feed_post_created\", function (event, topicId) {\n      var $postsCounter = $(\"#js-topic-item-\" + topicId + \" .js-posts-count\");\n      var $postsCounterSize = $postsCounter.find('.size');\n      var counter = parseInt($postsCounterSize.html());\n\n      $postsCounterSize.html(counter + 1);\n      $postsCounter.removeClass('hidden');\n      $(\"#js-topic-\" + topicId + \"-posts\").removeClass('hidden');\n      $(\"#js-topic-\" + topicId + \"-posts-list-panel\").collapse('show');\n\n      app.fixForumFeed();\n    });\n\n    $('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n      app.fixForumFeed();\n    });\n  };\n\n  app.fixForumFeed = function () {\n    app.bindGlobal();\n    app.bindBlazy();\n  };\n})();\n\n(function () {\n  'use strict';\n\n  /*\n    Alguns métodos foram sobrescritos no core,\n    visando manter compatibilidade com temas que não possuem a elegance atualizada.\n    - Métodos sobrescritos:\n      - init\n      - checkTrialByType\n  */\n\n  var buildLazyLoadUrl = function buildLazyLoadUrl(enrollmentId, courseId, type) {\n    return ('/enrollments/:enrollment_id/courses/:course_id/' + type).replace(':enrollment_id', enrollmentId).replace(':course_id', courseId);\n  };\n\n  var getPaymentMethod = function getPaymentMethod(enrollmentId, courseId, apiKey) {\n    if (courseId === null || enrollmentId === null) {\n      return false;\n    }\n\n    console.warn('executed: lessonList.getPaymentMethod');\n\n    var request = $.ajax({\n      url: buildLazyLoadUrl(enrollmentId, courseId, 'payment_method'),\n      async: false,\n      headers: {\n        'Authorization': 'Token token=' + apiKey\n      }\n    });\n\n    return request && request.responseJSON.payment_method;\n  };\n\n  var getLessonsInfo = function getLessonsInfo(enrollmentId, courseId, apiKey) {\n    if (courseId === null || enrollmentId === null) {\n      return false;\n    }\n\n    console.warn('executed: lessonList.getLessonInfo');\n\n    var request = $.ajax({\n      url: buildLazyLoadUrl(enrollmentId, courseId, 'lessons_info'),\n      async: false,\n      headers: {\n        'Authorization': 'Token token=' + apiKey\n      }\n    });\n\n    return request && request.responseJSON.lessons_info;\n  };\n\n  app.lessonList = {\n    onTrial: {},\n    paymentMethod: undefined,\n    init: function init() {\n      var self = this;\n\n      self.courseTreeExists = self.courseTree().length;\n      self.isActive = self.courseTree().data('is-active');\n      self.course = self.courseTree().data('course');\n      self.enrollment = self.courseTree().data('enrollment');\n      self.courseContent = self.courseTree().data('course-content');\n      self.userType = self.courseTree().data('user-type');\n      self.lessonActions = self.courseTree().data('lesson-actions');\n      self.downloadAction = self.courseTree().data('download-action');\n      self.currentLessonId = parseInt(self.courseTree().data('current-lesson-id'));\n      self.hasRequirements = $('.lesson-list-panel [data-requirements]').length > 0;\n      self.apiKey = self.courseTree().data('api-key');\n      self.translations = {};\n      self.translations['lesson.release_at'] = self.courseTree().data('translation-release-at');\n      self.translations['lesson.release_after'] = self.courseTree().data('translation-release-after');\n      self.translations['lesson.lock_at'] = self.courseTree().data('translation-lock-at');\n      self.translations['lesson.lock_after'] = self.courseTree().data('translation-lock-after');\n      self.translations['product.course_content.views'] = self.courseTree().data('translation-course_content-views');\n\n      if (self.renderAttendanceElement) {\n        $(document).on('activated-lesson', function () {\n          self.renderAttendanceElement();\n        });\n      }\n\n      if (self.course && self.enrollment) {\n        var lessonsInfo = getLessonsInfo(self.enrollment.id, self.course.id, self.apiKey);\n\n        self.courseTree().data('enrollment', Object.assign({}, self.enrollment, { lessons_info: lessonsInfo }));\n      }\n\n      if (self.lessonProgress() && self.lessonProgress().completed) {\n        $('.btn-next-lesson').removeClass('disabled');\n      }\n\n      if (self.lessonProgress() && !self.lessonProgress().completed) {\n        self.progressIcon('progress').removeClass('hide');\n      }\n\n      if (self.hasRequirements) {\n        self.checkNextButtonUnlocked();\n      }\n\n      if (self.courseTreeExists && !self.isActive) {\n        self.bindClicks();\n        self.handleLessons();\n        self.loadTopModules();\n        self.bindChangeLesson();\n\n        $(document).trigger('app:bind:lesson_sidebar');\n\n        $(document).on('lesson-completed', function (event, lessonProgress) {\n          var $mediaControls = $('.btn-next-lesson');\n          var enrollmentId = lessonProgress.data.enrollment_id;\n\n          if (self.progressIcon('completed').hasClass('hide')) {\n            self.progressIcon('completed').removeClass('hide');\n          }\n\n          if (!self.progressIcon('progress').hasClass('hide')) {\n            self.progressIcon('progress').addClass('hide');\n          }\n\n          if ($mediaControls.size() > 0) {\n            $mediaControls.removeClass('disabled');\n          }\n\n          app.lessonList.requirementsExists(lessonProgress.data, function ($item, content_id) {\n            if ($item && content_id) {\n              app.lessonList.checkLessonCompleted(enrollmentId, content_id, function (completed) {\n                if (completed) {\n                  $item.removeClass('blocked');\n                  $item.find('.right > .icon-lock').remove();\n                }\n              });\n            }\n          });\n        });\n      }\n    },\n\n    // Props\n    courseTree: function courseTree() {\n      return $('.course-content #js-course-tree-ajax');\n    },\n\n    lazyLoadButtons: function lazyLoadButtons() {\n      return $('.course-content #js-course-content-more-link, .course-content #js-course-content-prev-link');\n    },\n\n    lessons: function lessons() {\n      return this.courseTree().find('.js-content');\n    },\n\n    currentLesson: function currentLesson() {\n      return $(this.courseTree().find('.js-content.active')[0]);\n    },\n\n    toggleButton: function toggleButton() {\n      return $('.lesson-list-toggle .btn');\n    },\n\n    lessonListPanel: function lessonListPanel() {\n      return $('.lesson-list-panel');\n    },\n\n    lessonProgress: function lessonProgress() {\n      return $('#js-media-player').data('lesson-progress');\n    },\n\n    progressIcon: function progressIcon(type) {\n      var iconType = {\n        completed: '.js-completed-icon',\n        progress: '.js-in-progress-icon'\n      };\n\n      return this.currentLesson().find(iconType[type]);\n    },\n\n    requirementsExists: function requirementsExists(lessonProgress, cb) {\n      if (!lessonProgress) {\n        return false;\n      }\n\n      var requirementsElements = $('.lesson-list-panel [data-requirements]').filter(function (index, item) {\n        return $(item).data('requirements').length > 0;\n      });\n\n      var requirementsUnified = requirementsElements.map(function (idx, item) {\n        return {\n          item: $(item),\n          requirements: $(item).data('requirements')\n        };\n      }).toArray();\n\n      var exists = _.find(requirementsUnified, { requirements: [{ content_id: lessonProgress.lesson_id }] });\n\n      if (exists) {\n        var $item = exists.item;\n        if (cb) {\n          return cb($item, lessonProgress.lesson_id);\n        }\n      } else {\n        if (cb) {\n          return cb(null);\n        }\n      }\n    },\n\n    checkLessonCompleted: function checkLessonCompleted(enrollmentId, id, cb) {\n      var self = this;\n      var completed = false;\n      var apiKey = $('.course-content #js-course-tree-ajax').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/enrollments/' + enrollmentId + '/lessons_progresses?lesson_id=' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        completed = data.lessons_progresses[0].completed;\n\n        cb(completed);\n      });\n    },\n\n    // Actions\n    bindChangeLesson: function bindChangeLesson() {\n      var self = this;\n\n      if (!self.bindChangeLessonActive) {\n        self.bindChangeLessonActive = true;\n        var course_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+$/;\n        var lesson_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+\\/course_contents\\/\\d+$/;\n\n        $(document).on(\"ready page:load\", function (e) {\n          var path = window.location.pathname;\n          var lesson_path = lesson_path_regex.test(path);\n\n          if (course_path_regex.test(path) || lesson_path) {\n            self.lessons().removeClass('active');\n\n            if (lesson_path) {\n              var path_array = path.split('/');\n              var content_id = path_array[path_array.length - 1];\n\n              $(\"#content-\" + content_id + \".js-content\").addClass('active');\n            }\n          }\n        });\n      }\n    },\n\n    bindClicks: function bindClicks() {\n      var self = this;\n\n      self.lessons().find('a').on('click', function (e) {\n        e.preventDefault();\n        app.lessonList.changeLesson(null, $(this).parents('.js-content'));\n      });\n\n      self.courseTree().on('click', '.module', function (e) {\n        if (!$(e.target).hasClass('module') && !$(e.target).parent().hasClass('module')) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        self.loadChildren($(this));\n      });\n\n      self.courseTree().data('is-active', true);\n\n      self.toggleButton().on('click', this.toggleSidebar);\n    },\n\n    getLessonIcon: function getLessonIcon(lesson) {\n      var lessonIcon = '';\n\n      if (lesson.type === 'ExamLesson' && lesson.activity) {\n        switch (lesson.activity.type) {\n          case 'Quiz':\n            {\n              lessonIcon = 'icon-puzzle';\n              break;\n            }\n          case 'FileUpload':\n            {\n              lessonIcon = 'icon-arrow-up-circle';\n              break;\n            }\n          case 'CollaborativeDiscussion':\n            {\n              lessonIcon = 'icon-people';\n              break;\n            }\n          default:\n            {\n              lessonIcon = 'icon-puzzle';\n            }\n        }\n      } else if (lesson.media) {\n        switch (lesson.media.type) {\n          case 'Video':\n            {\n              lessonIcon = 'icon-camrecorder';\n              break;\n            }\n          case 'Audio':\n            {\n              lessonIcon = 'icon-microphone';\n              break;\n            }\n          case 'Slide':\n            {\n              lessonIcon = 'icon-chart';\n              break;\n            }\n          case 'Document':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'Image':\n            {\n              lessonIcon = 'icon-picture';\n              break;\n            }\n          case 'Text':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'LiveStream':\n            {\n              lessonIcon = 'icon-control-play';\n              break;\n            }\n          case 'VideoSlide':\n            {\n              lessonIcon = 'icon-film';\n              break;\n            }\n          case 'ScormPackage':\n            {\n              lessonIcon = 'icon-layers';\n              break;\n            }\n          case 'Html':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'Html5':\n            {\n              lessonIcon = 'icon-docs';\n              break;\n            }\n          default:\n            {\n              lessonIcon = 'icon-camrecorder';\n            }\n\n        }\n      }\n\n      return lessonIcon;\n    },\n\n    getContentPath: function getContentPath(content) {\n      var self = this;\n\n      var enrollmentId = self.enrollment.id;\n      var courseId = self.course.id;\n\n      var path = enrollmentId ? '/enrollments/' + enrollmentId : '/admin_view';\n      path = path + '/courses/' + courseId + '/course_contents/' + content.id;\n\n      return path;\n    },\n\n    getContentDownloadPath: function getContentDownloadPath(content) {\n      var self = this;\n      return self.getContentPath(content) + '/download';\n    },\n\n    checkLessonLocked: function checkLessonLocked(lesson, userType) {\n      var lessonLockAt = lesson.lock_at;\n      var lessonLockAfter = lesson.lock_after;\n\n      if (userType === 'Collaborator') {\n        return false;\n      }\n\n      if (!lessonLockAt && !lessonLockAfter) {\n        return false;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at).startOf('day');\n\n      var lessonLockTime = lessonLockAt ? moment(lessonLockAt).startOf('day') : enrollmentActivatedAt.add(lessonLockAfter, 'days');\n\n      return moment().startOf('day') >= lessonLockTime;\n    },\n\n    checkLessonAvailability: function checkLessonAvailability(lesson) {\n      var releaseAt = lesson.release_at;\n      var releaseAfter = lesson.release_after;\n\n      if (!releaseAt && !releaseAfter) {\n        return true;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at).startOf('day');\n\n      var releaseTime = releaseAt ? moment(releaseAt).startOf('day') : enrollmentActivatedAt.add(releaseAfter, 'days');\n\n      return moment().startOf('day') >= releaseTime;\n    },\n\n    checkTrialByType: function checkTrialByType(type, id) {\n      var self = this;\n      var apiKey = self.apiKey;\n      var constrainsName = 'trial_' + type + '_ids';\n      var enrollmentId = self.enrollment && self.enrollment.id;\n      var courseId = self.course && self.course.id;\n\n      var $tree = $('#js-course-tree-ajax');\n      var enrollment = $tree.data('enrollment');\n      var schoolProduct = $tree.data('school-product');\n\n      self.paymentMethod = self.paymentMethod !== undefined ? self.paymentMethod : getPaymentMethod(enrollmentId, courseId, apiKey);\n      var constrainsTree = schoolProduct && schoolProduct.trial_constrains;\n      var constrains = constrainsTree && self.paymentMethod && constrainsTree[self.paymentMethod] || {};\n      var hasConstrains = Object.keys(constrains).length > 0;\n\n      if (enrollmentId !== null && courseId !== null && !self.onTrial.hasOwnProperty(enrollmentId)) {\n        var request = $.ajax({\n          url: buildLazyLoadUrl(enrollmentId, courseId, 'on_trial'),\n          async: false,\n          headers: {\n            'Authorization': 'Token token=' + apiKey\n          }\n        });\n\n        self.onTrial[enrollmentId] = request && request.responseJSON.on_trial;\n      }\n\n      if (hasConstrains && !constrains.hasOwnProperty(constrainsName)) {\n        return false;\n      }\n\n      if (hasConstrains && constrains[constrainsName]) {\n        return constrains[constrainsName].indexOf(id) > -1;\n      }\n\n      if (enrollment && self.onTrial[enrollmentId]) {\n        return self.onTrial[enrollmentId];\n      }\n\n      return false;\n    },\n\n    fetchModules: function fetchModules($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var modules = _.sortBy(res.course_modules, 'order');\n\n          modules = _.filter(modules, function (m) {\n            var module = _.find(self.allModules, { id: m.id });\n            return module.available !== false && (module.course_content_ids.length > 0 || module.course_modules.length > 0);\n          });\n\n          var $modules = _.map(modules, function (module) {\n            return $('<li class=\"list-group-item module\" ' + 'data-id=\"' + module.id + '\"' + 'data-level=\"' + (level + 1) + '\">' + '<i class=\"icon icon-arrow-right\"></i>' + '<span>' + module.name + '</span>' + '<i class=\"busy busy-xs\"></i>' + '</li>');\n          });\n\n          $list.append($modules);\n        }\n      });\n    },\n\n    fetchChildren: function fetchChildren($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id + '/course_contents',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var courseContents = _.filter(res.course_contents, function (lesson) {\n            return lesson.available !== false;\n          });\n\n          courseContents = _.sortBy(courseContents, 'order');\n\n          if (self.enrollment) {\n            courseContents = _.map(courseContents, function (content) {\n              content.completed = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(content.lesson.id) > -1;\n              return content;\n            });\n          }\n\n          var $courseContents = _.map(courseContents, function (content) {\n            var active = self.currentLessonId === content.lesson.id ? 'active js' : '';\n            var lesson = content.lesson;\n            var lessonIcon = self.getLessonIcon(lesson);\n            var hideInProgressIcon = 'hide';\n            var hideCompletedIcon = 'hide';\n            var lessonReleased = null;\n            var releaseType = null;\n            var releaseDate = null;\n            var lessonLocked = null;\n            var lockLessonType = null;\n            var lockLessonDate = null;\n            var progress = null;\n            var requirements = content.requirements;\n            var available = true;\n\n            if (self.enrollment) {\n              lessonReleased = self.checkLessonAvailability(lesson) || self.userType === 'Collaborator';\n\n              lessonLocked = self.checkLessonLocked(lesson, self.userType);\n\n              if (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(lesson.id) > -1) {\n                hideInProgressIcon = 'hide';\n                hideCompletedIcon = null;\n              } else {\n                if (self.enrollment.lessons_info && self.enrollment.lessons_info.in_progress.indexOf(lesson.id) > -1) {\n                  hideInProgressIcon = null;\n                  hideCompletedIcon = 'hide';\n                } else {\n                  hideInProgressIcon = 'hide';\n                  hideCompletedIcon = 'hide';\n                }\n              }\n\n              if (lesson.release_at) {\n                releaseType = 'release_at';\n                releaseDate = lesson.release_at;\n              } else if (lesson.release_after) {\n                releaseType = 'release_after';\n                releaseDate = moment(self.enrollment.activated_at).add(lesson.release_after, 'days');\n              }\n\n              if (lesson.lock_at) {\n                lockLessonType = 'lock_at';\n                lockLessonDate = lesson.lock_at;\n              } else if (lesson.lock_after) {\n                lockLessonType = 'lock_after';\n                lockLessonDate = moment(self.enrollment.activated_at).add(lesson.lock_after, 'days');\n              }\n\n              if (self.lessonActions) {\n                progress = _.find(self.enrollment.lessons_progresses, { lesson_id: lesson.id });\n              }\n\n              _.each(requirements, function (requirement) {\n                var exists = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(requirement.content_id) > -1 || self.userType === 'Collaborator';\n                if (!exists) {\n                  available = false;\n                }\n              });\n            }\n\n            if (content.completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n            }\n\n            var html = '<li class=\"list-group-item content-lesson js-content list-group-item lesson module-item ' + active + (!available || self.enrollment && self.checkTrialByType('content', content.id) ? ' blocked' : '') + '\" ' + 'id=\"content-' + content.id + '\" ' + 'data-requirements=\\'' + JSON.stringify(requirements) + '\\'' + 'data-id=\"' + content.lesson.id + '\"' + 'data-level=\"1\">' + '<div id=\"lesson-' + lesson.id + '\" class=\"js-lesson content-lesson ' + active + (!lessonReleased ? ' not-released' : '') + (lessonLocked ? ' lesson-locked' : '') + '\" data-lesson-id=\"' + lesson.id + '\">' + '<div class=\"class-info\">' + '<div class=\"left\"><i class=\"' + lessonIcon + '\"></i></div>' + '<div class=\"center\">' + (self.lessonActions && lessonReleased && !lessonLocked ? '<a class=\"lesson-title\" href=\"' + self.getContentPath(content) + '\"><span>' + lesson.title + '</span></a>' : '<span class=\"lesson-title\"><span class=\"disabled\">' + lesson.title + '</span></span>') + '</div>' + '<div class=\"right\">' + (!available || self.enrollment && self.checkTrialByType('content', content.id) ? '<i class=\"icon-lock\"></i>' : '') + '<span class=\"progress-icon js-progress-icons\">' + '<i class=\"icon-check js-completed-icon ' + hideCompletedIcon + '\"></i>' + '<i class=\"icon-clock js-in-progress-icon ' + hideInProgressIcon + '\"></i>' + '</span>';\n\n            if (self.lessonActions) {\n              if (progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts') {\n                var translation = self.translations['product.course_content.views'];\n\n                translation = translation.replace('{{ progress.views }}', progress.views);\n                translation = translation.replace('{{ enrollment.max_attendance_length }}', self.enrollment.max_attendance_length);\n\n                html += '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + translation + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' + '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' + '</span>';\n              }\n\n              if (!lessonReleased) {\n                var zone = moment.tz.guess();\n                html += '<span class=\"release-date badge\">' + self.translations['lesson.' + releaseType] + '<span> ' + moment.tz(releaseDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n              }\n\n              if (lessonLocked) {\n                var zone = moment.tz.guess();\n                html += '<span class=\"lesson-locked-date badge\">' + self.translations['lesson.' + lockLessonType] + '<span> ' + moment.tz(lockLessonDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n              }\n\n              var isDownloadableMedia = content.lesson.media && ['Document', 'Audio', 'Download'].indexOf(content.lesson.media.type) > -1;\n\n              if ((self.downloadAction || content.downloadable) && isDownloadableMedia) html += '<a class=\"download-link\" href=\"' + self.getContentDownloadPath(content) + '\" data-no-turbolink>' + '<i class=\"icon-cloud-download\"></i>' + '</a>';\n            }\n\n            html += '</div>' + '</div>' + '</li>';\n\n            return $(html);\n          });\n\n          $list.append($courseContents);\n          self.checkNextButtonUnlocked();\n\n          $(document).trigger('loaded-children');\n        }\n      });\n    },\n\n    renderAttendanceElement: function renderAttendanceElement() {\n      var self = this;\n\n      if (!self.lessonProgress) return false;\n\n      var progress = self.lessonProgress();\n      var translation = self.translations['product.course_content.views'];\n\n      translation = translation.replace('{{ progress.views }}', progress.views);\n      translation = translation.replace('{{ enrollment.max_attendance_length }}', self.enrollment.max_attendance_length);\n\n      var el = $('.js-lesson[data-lesson-id=' + progress.lesson_id + '] .right');\n      var isAttempts = progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts';\n\n      if (el.find('.js-attendance').size() === 0 && self.lessonActions && isAttempts) {\n        var html = '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + translation + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' + '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' + '</span>';\n\n        el.append(html);\n      }\n    },\n\n    checkNextButtonUnlocked: function checkNextButtonUnlocked() {\n      var lessonProgress = this.lessonProgress();\n\n      app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n        if ($item && content_id) {\n          if (!content_id || !lessonProgress.hasOwnProperty('enrollment_id')) {\n            return;\n          }\n\n          app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n            if (completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n              $item.removeClass('blocked');\n              $item.find('.right > .icon-lock').remove();\n            }\n          });\n        } else {\n          $('.btn-next-lesson').removeClass('disabled');\n        }\n      });\n    },\n\n    loadTopModules: function loadTopModules() {\n      var self = this;\n\n      if (!self.course) return;\n\n      $.ajax({\n        url: window.CORE_HOST + '/courses/' + self.course.id + '/course_modules',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          if (!res.course_modules || res.course_modules.length <= 0) return;\n\n          self.allModules = res.course_modules;\n\n          self.topModules = _.filter(res.course_modules, function (x) {\n            return !x.parent_course_module && x.available !== false && (x.course_content_ids.length > 0 || x.course_modules.length > 0);\n          });\n\n          self.topModules = _.sortBy(self.topModules, 'order');\n\n          var $modules = _.map(self.topModules, function (module) {\n            var disabled = self.enrollment && self.checkTrialByType('module', module.id);\n\n            return $('<li class=\"list-group-item module ' + (disabled ? 'disabled' : '') + '\" ' + 'data-id=\"' + module.id + '\"' + 'data-level=\"1\">' + '<i class=\"icon icon-arrow-right\"></i>' + '<span>' + module.name + '</span>' + '<i class=\"busy busy-xs\"></i>' + '</li>');\n          });\n\n          self.courseTree().prev('.course-content-busy').fadeOut('fast', function () {\n            self.courseTree().css('display', 'none');\n            self.courseTree().html($modules);\n            self.courseTree().fadeIn('fast');\n\n            if (self.courseContent) {\n              self.expandParentModules(self.courseContent.parent_modules_hash);\n            }\n          });\n        }\n      });\n    },\n\n    loadChildren: function loadChildren(parent, cb) {\n      var self = this;\n      var $parent = $(parent);\n\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      if ($list.length <= 0) {\n        $parent.find('.busy').css({ opacity: 1 });\n        $list = $('<ul class=\"list-group\" style=\"display: none;\"></ul>');\n        $list.appendTo($parent);\n\n        $.when(self.fetchModules($parent), self.fetchChildren($parent)).then(function () {\n          $parent.addClass('expanded');\n          $parent.find('.busy').css({ opacity: 0 });\n\n          $list.slideDown('fast');\n\n          if (typeof cb === 'function') {\n            cb();\n          }\n        });\n      } else {\n        if ($parent.hasClass('expanded')) {\n          $parent.removeClass('expanded');\n          $list.slideUp('fast');\n        } else {\n          $parent.addClass('expanded');\n          $list.slideDown('fast');\n        }\n\n        if (typeof cb === 'function') {\n          cb();\n        }\n      }\n    },\n\n    handleLessons: function handleLessons() {\n      $(document).on('page:load page:restore', function (e) {\n\n        if (!e.originalEvent || !e.originalEvent.data || e.originalEvent.data.length == 0) return;\n\n        var $html = $(e.originalEvent.data[0]);\n        app.lessonList.lessons().each(function (i, el) {\n          var $el = $(el);\n          var $new = $html.find('#' + $el.attr('id'));\n          $el.html($new.html());\n        });\n      });\n    },\n\n    changeLesson: function changeLesson(direction, lesson) {\n      var $targetLesson = $(lesson);\n\n      if (direction === 'prev') {\n        var $prev = app.lessonList.currentLesson().prevAll('.js-content');\n\n        if ($prev.length > 0 && $prev.find('a').length > 0) $targetLesson = $($prev[0]);\n      } else if (direction === 'next') {\n        var $next = app.lessonList.currentLesson().nextAll('.js-content');\n\n        if ($next.length > 0 && $next.find('a').length > 0) $targetLesson = $($next[0]);\n      }\n\n      $targetLesson.find('a')[0].click();\n    },\n\n    expandParentModules: function expandParentModules(parentModules) {\n      var self = this;\n\n      var modules = [];\n      var loopModule = parentModules.course_module;\n      modules.push(loopModule.id);\n\n      while (loopModule.parent_module) {\n        loopModule = loopModule.parent_module;\n        modules.push(loopModule.id);\n      }\n\n      modules = modules.reverse();\n\n      async.eachSeries(modules, function (moduleId, cb) {\n        var $module = $('.module[data-id=\"' + moduleId + '\"]');\n        self.loadChildren($module, cb);\n      });\n    },\n\n    toggleSidebar: function toggleSidebar() {\n      app.lessonList.toggleButton().toggleClass('active');\n      app.lessonList.lessonListPanel().toggleClass('active');\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.lessonPage = function () {\n    var REGEX_COLLABORATIVE_DISCUSSIONS = /\\/collaborative_discussions\\/([0-9]+)\\/collaborative_comments/;\n    var REGEX_EXAM_ANSWERS = /\\/exam_answers/;\n\n    var isCollaborativeDiscuttion = function isCollaborativeDiscuttion(value) {\n      return REGEX_COLLABORATIVE_DISCUSSIONS.test(value);\n    };\n\n    var isExamAnswer = function isExamAnswer(value) {\n      return REGEX_EXAM_ANSWERS.test(value);\n    };\n\n    $(document).ajaxSuccess(function (event, xhr, settings) {\n      if (isCollaborativeDiscuttion(settings.url) || isExamAnswer(settings.url)) {\n        var lessonProgress = app.lessonList.lessonProgress();\n\n        app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n          if (content_id && lessonProgress.enrollment_id) {\n            app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n              if (completed) {\n                var $currentItemIcon = app.lessonList.currentLesson().find('.js-in-progress-icon');\n                $currentItemIcon.removeClass('icon-clock');\n                $currentItemIcon.removeClass('js-in-progress-icon');\n                $currentItemIcon.addClass('js-in-completed-icon');\n                $currentItemIcon.addClass('icon-check');\n\n                $('.btn-next-lesson').removeClass('disabled');\n                $item.removeClass('disabled');\n                $item.removeClass('blocked');\n                $item.find('.right > .icon-lock').remove();\n              }\n            });\n          }\n        }, function () {\n          $('.btn-next-lesson').removeClass('disabled');\n        });\n      }\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindMasks = function () {\n    var phoneMaskBehavior = function phoneMaskBehavior(val) {\n      return val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n    };\n\n    var phoneMaskOptions = {\n      onKeyPress: function onKeyPress(val, e, field, options) {\n        field.mask(phoneMaskBehavior.apply({}, arguments), options);\n      }\n    };\n\n    $('#user-phone').mask(phoneMaskBehavior, phoneMaskOptions);\n    $('#user-cpf').mask('999.999.999-99');\n    $('#user-cep').mask('99.999-999');\n\n    $(document).trigger('app:bind:masks');\n  };\n})();\n\napp.notepad = {\n  page: 1,\n\n  noteContainer: function noteContainer() {\n    return $('#notepad-container');\n  },\n\n  form: function form() {\n    return $('#js-notepad-form');\n  },\n\n  loadNote: function loadNote(lesson_id, cb) {\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'GET',\n      success: function success() {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  saveNote: function saveNote(cb) {\n    var note = $(\"#js-note\").html();\n    var note_id = $(\"#js_note_id\").val();\n\n    var $button = $(\"#save_notepad_button\");\n    var buttonLabel = $button.html();\n    $button.html($button.data(\"sending\"));\n    $button.prop('disabled', true);\n\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'POST',\n      data: {\n        _id: note_id,\n        note: note\n      },\n      success: function success() {\n        $button.html(buttonLabel);\n        $button.prop('disabled', false);\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function init() {\n    var self = this;\n    if (this.noteContainer().length <= 0) return;\n    this.loadNote($(\"#lesson_id\").val());\n\n    $(\"#notepad_form\").on('submit', function (event) {\n      event.preventDefault();\n      self.saveNote();\n    });\n  }\n};\n\n(function () {\n  'use strict';\n\n  app.bindPostsForm = function () {\n    $(document).on('click', '.js-post-edit', function () {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').addClass('hidden');\n      post.find('.js-post-form').removeClass('hidden');\n    });\n\n    $(document).on('click', '.js-post-cancel', function (e) {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').removeClass('hidden');\n      post.find('.js-post-form').addClass('hidden');\n    });\n\n    $(document).trigger('app:bind:bind_posts_form');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindReadMore = function () {\n    $('[role=\"readmore\"]').each(function (i, el) {\n      var speed = $(el).data('speed') || 100;\n      var collapsedHeight = $(el).data('collapsed-height') || 200;\n      var moreText = $(el).data('more-text') || 'Leia Mais';\n      var lessText = $(el).data('less-text') || 'Fechar';\n\n      var currHeight = $(el).innerHeight();\n      var showLink = currHeight <= collapsedHeight;\n\n      $(el).readmore({\n        speed: speed,\n        collapsedHeight: collapsedHeight,\n        moreLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + moreText + '</a>',\n        lessLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + lessText + '</a>'\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  window.onLoadRecaptcha = function () {\n    app.bindRecaptcha();\n  };\n\n  app.bindRecaptcha = function () {\n    var $recaptcha = $('.js-recaptcha');\n\n    if (!$recaptcha.length || typeof grecaptcha === 'undefined' || !grecaptcha.hasOwnProperty('render')) return;\n\n    $recaptcha.each(function (i, el) {\n      var $el = $(el);\n      var sitekey = $el.data('sitekey');\n      var elId = $el.attr('id');\n      var disableButton = $el.data('disable-button') === true;\n      var buttonSelector = $el.data('button-selector');\n\n      var $form = $el.parents('form');\n      var $formButton = buttonSelector ? $form.find(buttonSelector) : $form.find('button[type=\"submit\"], input[type=\"submit\"]');\n\n      if (disableButton) {\n        $formButton.prop('disabled', true);\n      }\n\n      grecaptcha.render(elId, {\n        'sitekey': sitekey,\n        'callback': function callback() {\n          if (disableButton) {\n            $formButton.prop('disabled', false);\n          }\n        }\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.simpleEditor = {\n    createShortcut: function createShortcut(bindKey, callback) {\n      var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n      var bindFunction = function bindFunction(e) {\n        var character = String.fromCharCode(e.keyCode);\n        var ctrl = e.ctrlKey;\n        var meta = !!e.metaKey;\n        var score = 0;\n\n        if (isMac && meta) {\n          score++;\n        } else if (ctrl) {\n          score++;\n        }\n\n        if (character === bindKey) {\n          score++;\n\n          if (score === 2) {\n            e.stopPropagation();\n            e.preventDefault();\n            return callback();\n          }\n        }\n      };\n\n      $('body').bind('keydown', bindFunction);\n    },\n\n    handleDrag: function handleDrag(e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n\n    handleDrop: function handleDrop(e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var x = e.clientX;\n      var y = e.clientY;\n      var file = e.dataTransfer.files[0];\n\n      var URLObj = window.URL || window.webkitURL;\n      var source = URLObj.createObjectURL(file);\n\n      if (file.type.match('image.*')) {\n\n        var img = document.createElement(\"img\");\n\n        img.src = source;\n\n        var range = null;\n\n        if (document.caretPositionFromPoint) {\n          var pos = document.caretPositionFromPoint(x, y);\n          range = document.createRange();\n          range.setStart(pos.offsetNode, pos.offset);\n          range.collapse();\n          range.insertNode(img);\n        } else if (document.caretRangeFromPoint) {\n          range = document.caretRangeFromPoint(x, y);\n          range.insertNode(img);\n        }\n      }\n    },\n\n    updateButtons: function updateButtons() {\n      var bold = document.queryCommandState(\"Bold\");\n      var italic = document.queryCommandState(\"Italic\");\n      var underline = document.queryCommandState(\"Underline\");\n\n      if (bold === true) {\n        $('[data-action=bold]').addClass('active');\n      } else {\n        $('[data-action=bold]').removeClass('active');\n      }\n\n      if (italic === true) {\n        $('[data-action=italic]').addClass('active');\n      } else {\n        $('[data-action=italic]').removeClass('active');\n      }\n\n      if (underline === true) {\n        $('[data-action=underline]').addClass('active');\n      } else {\n        $('[data-action=underline]').removeClass('active');\n      }\n    },\n\n    init: function init(container) {\n      this.$container = $(container);\n\n      if (this.$container.length <= 0) {\n        return;\n      }\n\n      this.$input = this.$container.find('.js-input');\n      this.$btnAction = this.$container.find('.js-btn-action');\n\n      this.registerTriggers();\n      this.registerDropZone();\n      this.registerShortcuts();\n    },\n\n    registerTriggers: function registerTriggers() {\n      var self = this;\n\n      self.$btnAction.on('click', function () {\n        var action = $(this).attr('data-action');\n        document.execCommand(action);\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('click', function () {\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('focusin', function () {\n        self.$container.addClass('focused');\n      });\n\n      self.$input.on('focusout', function () {\n        self.$container.removeClass('focused');\n      });\n    },\n\n    registerDropZone: function registerDropZone() {\n      var dropZone = $(this.container).find('.js-input');\n      dropZone.on('dragover', app.simpleEditor.handleDrag, false);\n      dropZone.on('drop', app.simpleEditor.handleDrop, false);\n    },\n\n    registerShortcuts: function registerShortcuts() {\n\n      app.simpleEditor.createShortcut('U', function () {\n        document.execCommand('underline');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('B', function () {\n        document.execCommand('bold');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('I', function () {\n        document.execCommand('italic');\n        app.simpleEditor.updateButtons();\n      });\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.randomQuizStatistics = function () {\n    var $statistic = $(\".statistic\");\n    var statisticArray = [];\n    var finalArray = [];\n\n    var getData = function getData(property) {\n      return $statistic[i].attributes[property].value;\n    };\n\n    for (var i = 0; i < $statistic.size(); i++) {\n\n      var tag = getData('data-tag');\n      var difficulty = getData('data-difficulty');\n      var quantity = getData('data-quantity');\n      var hits = getData('data-hits');\n\n      statisticArray.push({\n        'id': tag + '-' + difficulty,\n        'quantity': quantity,\n        'hits': hits,\n        'tag': tag,\n        'difficulty': difficulty\n      });\n    }\n\n    var groupedTags = _.uniqBy(statisticArray, 'id');\n\n    for (var i = 0; i < groupedTags.length; i++) {\n\n      var currentID = groupedTags[i].id;\n      var matchedTags = _.filter(statisticArray, _.matches({ 'id': currentID }));\n\n      var totalQuantity = 0,\n          totalHits = 0,\n          finalTag = '',\n          finalDifficulty = '';\n\n      _.forEach(matchedTags, function (value) {\n        totalQuantity += parseInt(value.quantity);\n        totalHits += parseInt(value.hits);\n        finalTag = value.tag;\n        finalDifficulty = value.difficulty;\n      });\n\n      var totalErrors = totalQuantity - totalHits;\n      var performance = (totalHits / totalQuantity * 100).toFixed() + '%';\n\n      finalArray.push({\n        'tag': finalTag,\n        'difficulty': finalDifficulty,\n        'total': totalQuantity,\n        'correct_anwsers': totalHits,\n        'wrong_answers': totalErrors,\n        'performance': performance\n      });\n    }\n\n    var vocabulary = $('.statistic-texts').first().data();\n    var $div = $('#course-statistics');\n\n    _.forEach(finalArray, function (value) {\n      var template = '<div class=\"row statistic-item\">    \\n                <div class=\"statistics-board\">        \\n                    <div class=\"row statistic-label\">\\n                        <h2 class=\"tag\">' + value.tag + '</h2>\\n                        <h2 class=\"difficulty\">' + value.difficulty + '</h2>\\n                    </div>\\n                    <div class=\"col-md-3 box-outline\">\\n                        <div class=\"statistic-box total\">\\n                            <p class=\"result\">' + value.total + '</p>\\n                            <p class=\"name\">' + vocabulary.textAnswered + '</p>\\n                            <div class=\"box-footer\">        \\n                            </div>\\n                        </div>\\n                    </div> \\n                    <div class=\"col-md-3 box-outline\">\\n                        <div class=\" statistic-box correct\">\\n                            <p class=\"result\">' + value.correct_anwsers + '</p>\\n                            <p class=\"name\">' + vocabulary.textRight + '</p>\\n                            <div class=\"box-footer\">\\n                            </div>\\n                        </div>\\n                    </div>\\n                    <div class=\"col-md-3 box-outline\">\\n                        <div class=\"statistic-box wrong\">\\n                            <p class=\"result\">' + value.wrong_answers + '</p>\\n                            <p class=\"name\">' + vocabulary.textWrong + '</p>\\n                            <div class=\"box-footer\">\\n                            </div>\\n                        </div>\\n                    </div>\\n                    <div class=\"col-md-3 box-outline\">\\n                        <div class=\"statistic-box performance\">\\n                            <p class=\"result\">' + value.performance + '</p>\\n                            <p class=\"name\">' + vocabulary.textPerformance + '</p>\\n                            <div class=\"box-footer\">\\n                            </div>\\n                        </div>\\n                    </div>\\n                </div>\\n            </div>';\n\n      $div.append(template);\n    });\n\n    $(document).trigger('app:bind:randomQuizStatistics');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  var strength = function strength(pass) {\n    var force = 0;\n\n    // rules\n    var lowerLetters = /[a-z]+/;\n    var upperLetters = /[A-Z]+/;\n    var numbers = /\\d+/;\n    var symbols = /.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/;\n\n    // check if password is > 6\n    if (pass.length >= 6) force++;\n\n    // check lowercase and uppercase \n    if (pass.match(lowerLetters) && pass.match(upperLetters)) force++;\n\n    // check numbers\n    if (pass.match(numbers)) force++;\n\n    // check symbols\n    if (pass.match(symbols)) force++;\n\n    // check if password is > 12\n    if (pass.length > 12) force++;\n\n    return force;\n  };\n\n  app.bindStrongPassword = function () {\n    var input = $('.strong--password'),\n        form = input.parents('form:first'),\n        alert = form.find('.alert');\n\n    $('.strong--password').bind('change focus paste keyup', function () {\n      if ($(this).val() !== '' && strength($(this).val()) >= 3) {\n        alert.hide();\n        form.find('input[type=\"submit\"]').removeClass('disabled');\n      } else {\n        alert.show();\n        form.find('input[type=\"submit\"]').addClass('disabled');\n      }\n    }).bind('blur', function () {\n      alert.hide();\n    });\n  };\n})();\n\napp.studentDoubts = {\n  page: 1,\n\n  doubtsContainer: function doubtsContainer() {\n    return $('#js-doubts-container');\n  },\n\n  form: function form() {\n    return $('#js-student-doubts-form');\n  },\n\n  expandButton: function expandButton() {\n    return $('#js-expand-student-doubts-form');\n  },\n\n  hideButton: function hideButton() {\n    return $('#js-hide-student-doubts-form');\n  },\n\n  loadMoreButton: function loadMoreButton() {\n    return $('#js-load-more-doubts');\n  },\n\n  loadDoubts: function loadDoubts(cb) {\n    var self = this;\n\n    $.ajax({\n      url: window.location.pathname + '/student_doubts/page/' + self.page,\n      method: 'GET',\n      data: {\n        per_page: 3\n      },\n      complete: function complete() {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function init() {\n    var self = this;\n\n    if (self.doubtsContainer().length <= 0) return;\n\n    self.expandButton().on('click', function () {\n      self.expandButton().hide();\n      self.form().slideDown('fast');\n    });\n\n    self.hideButton().on('click', function () {\n      self.form().slideUp('fast', function () {\n        self.expandButton().fadeIn('fast');\n      });\n    });\n\n    self.loadMoreButton().on('click', function () {\n      self.page = self.page + 1;\n      var $btn = $(this);\n\n      $btn.attr('disabled', 'disabled');\n      self.loadDoubts(function () {\n        $btn.removeAttr('disabled');\n      });\n    });\n\n    self.loadDoubts();\n  }\n};\n\n(function () {\n  'use strict';\n\n  app.timeTags = function () {\n    var $edoolsPlayerContainer = $('.js-edools-player');\n    if ($edoolsPlayerContainer.length <= 0) {\n      return;\n    }\n\n    var edoolsPlayer = $edoolsPlayerContainer[0].edoolsPlayer;\n\n    $('.js-timetags .list-group-item').on('click', function (e) {\n      e.preventDefault();\n\n      if ($edoolsPlayerContainer.length > 0) {\n        var time = $(this).data('time');\n\n        edoolsPlayer.setTime(time);\n      }\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.changeTimeZone = function () {\n    $('.js-to-client-timezone').each(function (i, el) {\n      var $el = $(el);\n      var format = $el.data('format');\n      var zone = moment.tz.guess();\n      var time = $el.data('timezone');\n\n      $el.html(moment.tz(time, zone).format(format));\n    });\n\n    $(document).trigger('app:change:timezone');\n  };\n\n  // TODO: FIXME: Essa chamada é para funcionar no primeiro load. Não deveria\n  // ser assim, parece ser algum erro com a inserção de cod no tema\n  app.changeTimeZone();\n})();\n\n(function () {\n  $(document).on('page:load', function () {\n    app.init();\n  });\n\n  $(document).on('page:partial-load', function () {\n    app.bindBlazy();\n  });\n\n  $(document).ready(function () {\n    app.init();\n  });\n})();","(function () {\n  'use strict';\n\n  window.app = {\n    bindGlobal: function () {\n      FastClick.attach(document.body);\n\n      $('.timeago').timeago();\n\n      $(document).trigger('app:bind:global');\n    },\n\n    bindOpenOnLoad: function () {\n      var toOpen = $('.js-open-on-load');\n      if (toOpen.length > 0) {\n        $.each(toOpen, function (i, elem) {\n          window.open($(elem).attr('href'));\n        });\n      }\n\n      $(document).trigger('app:bind:open_on_load');\n    },\n\n    bindTooltips: function () {\n      $(\"body\")\n        .tooltip(\"destroy\")\n        .tooltip({\n          selector: '[data-toggle=\"tooltip\"]'\n        });\n\n      $(document).trigger('app:bind:tooltips');\n    },\n\n    checkFormValidity: function (event) {\n      var form = event.currentTarget;\n      var submitButton = $(form).find('button[type=\"submit\"]');\n\n      if (form.checkValidity()) {\n        submitButton.removeAttr('disabled');\n      } else {\n        submitButton.attr('disabled', 'disabled');\n      }\n\n      $(document).trigger('app:bind:check_form_validity');\n    },\n\n    bindCepService() {\n      $(document).on('cep-result', function(_event, result){\n        if (result) {\n          $('input[name=\"user[address_attributes][street]\"]').val(result.street);\n          $('input[name=\"user[address_attributes][city]\"]').val(result.city);\n          $('input[name=\"user[address_attributes][state]\"]').val(result.state);\n          $('input[name=\"user[address_attributes][district]\"]').val(result.neighborhood);\n          $('input[name=\"user[address_attributes][complement]\"]').val(result.complement);\n        }\n      });\n    },\n\n    bindValidationCpf() {\n      var $userCpf = $('#user-cpf');\n\n      if ($userCpf.data('validate-cpf')) {\n        $userCpf.on('keyup', function() {\n          var $field = $(this);\n          var $parents = $field.parent();\n          var $validationMessage = $('<span />', {\n            class: 'color-danger',\n            text: 'O cpf preenchido é inválido.'\n          });\n          var $button = $field.parents('form').find('button[type=\"submit\"], input[type=\"submit\"]');\n          var $validationMessagesList = $parents.find('.color-danger');\n          var isValid = CPF.validate($field.val());\n\n          if ($validationMessagesList.size() < 1 && !isValid && $field.val() !== '') {\n            $field.after($validationMessage);\n\n            $button.prop('disabled', true);\n          }\n\n          if (isValid || $field.val() === '') {\n            $validationMessagesList.remove();\n\n            $button.prop('disabled', false);\n          }\n        });\n      }\n    },\n\n    init: function () {\n      app.bindGlobal();\n      app.bindRecaptcha();\n      app.bindBlazy();\n      app.bindOpenOnLoad();\n      app.bindMasks();\n      app.bindTooltips();\n      app.bindReadMore();\n      app.bindDatepicker();\n      app.bindFixOnScroll();\n      app.ckeditor.bindCkeditor();\n      app.bindCheckout();\n      app.bindForumFeed();\n      app.bindCourseRating();\n      app.deadpoolChat.bindDeadpool();\n      app.lessonList.init();\n      app.chat.init();\n      app.studentDoubts.init();\n      app.notepad.init();\n      app.categoryList.init();\n      app.bindExamQuestionForm();\n      app.changeTimeZone();\n      app.followBind();\n      app.lessonPage();\n      app.timeTags();\n      app.bindPostsForm();\n      app.accessibility();\n      app.bindStrongPassword();\n      app.bindValidationCpf();\n      app.randomQuizStatistics();\n      app.bindCepService();\n\n      $(document).on('app:bind:ckeditor_submit', app.bindCollaborativeDiscussion);\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindBlazy = function (e) {\n    new Blazy();\n\n    $(document).trigger('app:bind:blazy');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.categoryList = {\n    init: function () {\n      var self = this;\n      self.$categoryList = $('#js-category-list');\n\n      if (self.$categoryList.length == 0) return;\n\n      self.isActive = self.$categoryList.data('is-active') || self.isActive;\n\n      if (!self.isActive) {\n        self.bindClicks();\n        self.$categoryList.attr('data-is-active', true);\n        self.isActive = true;\n      }\n\n      self.expandParents();\n    },\n\n    bindClicks: function () {\n      var self = this;\n\n      $(document).on('click', '#js-category-list .category-item .toggle-btn', function () {\n        self.expandParent($(this).parent('.category-item'), true);\n      });\n    },\n\n    expandParent: function ($parent, animate) {\n      var $nextListGroup = $parent.find('.list-group').first();\n      var $parentCategoryItem = $parent;\n\n      if (animate) {\n        $nextListGroup.stop().slideToggle('fast');\n      } else {\n        $nextListGroup.stop().toggle();\n      }\n\n      $parentCategoryItem.toggleClass('expanded');\n    },\n\n    expandParents: function () {\n      var self = this;\n      var $loopItem = self.$categoryList.find('.category-item.current').first();\n\n      while ($loopItem) {\n        self.expandParent($loopItem, false);\n\n        var $parent = $loopItem\n          .parents('.category-item')\n          .first();\n\n        if ($parent.length > 0) {\n          $loopItem = $parent;\n        } else {\n          $loopItem = null;\n        }\n      }\n    }\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.chat = {\n    groupsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    collaboratorsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    followsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n\n    init: function () {\n      var self = this;\n\n      self.$chat = $('.js-chat');\n\n      if (self.$chat.length <= 0) {\n        return\n      }\n\n      self.$groups = $('.js-groups', self.$chat);\n      self.$students = $('.js-students', self.$chat);\n      self.$roomTitle = $('#js-room-title');\n      self.$roomUsersCount = $('#js-room-users-count');\n      self.$text = $('.js-chat-text');\n      self.$messagesContainer = $('.js-chat-messages .js-content');\n      self.$messagesScroll = $('.js-chat-messages .js-scroll');\n      self.$sendForm = $('#js-send-messages');\n      self.$loadMoreGroupsButton = self.$chat.find('.js-load-more-groups');\n      self.$loadMoreCollaboratorsButton = self.$chat.find('.js-load-more-collaborators');\n      self.$loadMoreStudentsButton = self.$chat.find('.js-load-more-students');\n      self.$generalChatGroup = self.$chat.find('.js-chat-group-general');\n\n      self.user = self.$chat.data('user');\n      self.schoolId = self.$chat.data('school-id');\n      self.apiKey = self.$chat.data('api-key');\n      self.userId = self.user.id;\n      self.chatType = self.$chat.data('type');\n      self.chatLesson = self.$chat.data('lesson');\n\n      self.bindScroll();\n\n      self.$messagesContainer.empty();\n\n      // bind form\n      self.$text.keyup(function (e) {\n        var code = e.keyCode ? e.keyCode : e.which;\n        if (code === 13 && !e.shiftKey) {\n          self.submitMessage(e);\n        }\n      });\n\n      app.simpleEditor.init('#js-send-messages');\n      self.$sendForm.on('submit', self.submitMessage);\n\n      if (firebase.apps.length <= 0) {\n        firebase.initializeApp(window.CHAT_CONFIG);\n      }\n\n      self.database = firebase.database();\n\n      self.authenticate();\n\n      if (self.chatType === 'lesson-chat') {\n        self.lessonRoomUsers = self.database.ref('lesson_room_users/' + self.chatLesson.id);\n        self.$loadMoreStudentsButton.hide();\n        self.changeRoom(null);\n        self.registerCurrentUser();\n        self.loadRoomOnlineUsers();\n\n        $(document).off('page:before-change')\n          .on('page:before-change', function () {\n            if (self.userFirebase) {\n              self.userFirebase.remove();\n            }\n          });\n\n      } else {\n        self.loadSchoolGroup();\n        self.loadGroups();\n        self.loadCollaborators();\n        self.loadFollows();\n\n        self.$loadMoreGroupsButton.on('click', function () {\n          self.loadGroups();\n        });\n\n        self.$loadMoreCollaboratorsButton.on('click', function () {\n          self.loadCollaborators();\n        });\n\n        self.$loadMoreStudentsButton.on('click', function () {\n          self.loadFollows();\n        });\n\n        self.$generalChatGroup.on('click', function () {\n          self.changeRoom({\n            currentTarget: self.$generalChatGroup\n          })\n        });\n      }\n\n      self.listenConnectionChanges();\n    },\n\n    authenticate: function () {\n      var self = app.chat;\n\n      $.ajax({\n        url: window.CHAT_FIREBASE_SERVICE_HOST + '/authenticate',\n        method: 'POST',\n        headers: {\n          'Authorization': self.apiKey\n        }\n      }).success(function (data) {\n        firebase.auth().signInWithCustomToken(data.body.firebase_token)\n          .then(function (response) {\n            self.monitorConnectionState(response);\n          })\n          .catch(function (error) {\n            console.error('Error creating custom token:', error);\n          });\n      }).error(function (error) {\n        console.error('Could not authenticate', error);\n      });\n    },\n\n    monitorConnectionState: function (response) {\n      const userRef = firebase.database().ref('user_status').child(response.uid);\n\n      // Monitor connection state on browser tab\n      firebase.database().ref('.info/connected')\n        .on('value', function (snap) {\n          if (snap.val()) {\n            // if we lose network then remove this user from the list\n            userRef.onDisconnect().set('offline');\n            // set user's online status\n            userRef.set('online');\n          }\n        });\n\n      document.onIdle = function () {\n        userRef.set('idle');\n      };\n\n      document.onAway = function () {\n        userRef.set('away');\n      };\n\n      document.onBack = function () {\n        userRef.set('online');\n      }\n    },\n\n    listenConnectionChanges: function () {\n      var self = app.chat;\n      var connectionsRef = this.database.ref('user_status');\n\n      connectionsRef.on('child_added', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_changed', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_removed', function (data) {\n        self.updateStatus(data.val(), 'offline');\n      });\n    },\n\n    updateStatus: function (status, userId) {\n      var self = this;\n\n      var $element = $('*[data-id=\"' + userId + '\"]');\n\n      if (self.chatType === 'lesson-chat') {\n        if (status === 'offline') {\n          if ($element.length) {\n            $element.remove();\n          }\n\n          self.lessonRoomUsers\n            .orderByChild('id')\n            .equalTo(Number(userId))\n            .once('value')\n            .then(function (snapshot) {\n              if (snapshot.hasChildren()) {\n                snapshot.forEach(function (snap) {\n                  self.lessonRoomUsers.child(snap.key).remove();\n                });\n              }\n\n              self.$roomUsersCount.html($('.chat-profile-list-item', self.$students).length);\n            });\n        }\n      } else {\n        if ($element.length) {\n          $('.status .icon', $element).first().attr('class', 'icon icon-' + status);\n        }\n      }\n    },\n\n    bindScroll: function () {\n      var height = this.$chat.data('height');\n      var parent = this.$chat.data('parent');\n      var parentHeight = parent ? $(parent).height() : $(window).height();\n      var isPercentHeight = height.indexOf('%') > -1;\n      height = Number(height.replace('%', '').replace('px', ''));\n\n      if (isPercentHeight === true) {\n        this.chatHeight = (parentHeight / 100) * height;\n      } else {\n        this.chatHeight = height;\n      }\n\n      this.$chat.height(this.chatHeight);\n      this.$chat.find('.js-sidebar-scroll').scrollbar({});\n      this.$chat.find('.js-chat-messages .js-scroll').scrollbar({});\n    },\n\n    sanitizeHtml: function ($root) {\n      $root.find('div:empty').remove();\n\n      // Removes elements with only '<br/>' children\n      $root.children().each(function (i, el) {\n        var $el = $(el);\n        if (el.tagName !== 'BR' && $el.find('br').length > 0 && $el.find('br').length == $el.children().length) {\n          $el.remove();\n        }\n      });\n\n      // Removes last '<br/>'\n      if ($root.last().get(0).tagName === 'BR') {\n        $root.last().remove();\n      }\n\n      return $root;\n    },\n\n    submitMessage: function (event) {\n      event.preventDefault();\n      var self = app.chat;\n\n      var $html = self.sanitizeHtml(self.$text);\n      var text = $html.html();\n\n      if (text.length <= 0) return;\n\n      self.$text.html('').focus();\n\n      function pad(n) {\n        return (n < 10) ? ('0' + n) : n;\n      }\n\n      var date = new Date();\n\n      self.messages.push({\n        id: self.user.id,\n        name: self.user.first_name,\n        avatar_url: self.user.cover_image_url,\n        text: text,\n        timestamp: moment().unix(),\n        schedule: pad(date.getHours()) + ':' + pad(date.getMinutes())\n      });\n    },\n\n    scrollToEnd: function () {\n      var self = this;\n      self.$messagesScroll.scrollTop(self.$messagesScroll[0].scrollHeight);\n    },\n\n    renderMessage: function (data) {\n      var self = app.chat;\n      var html = self.renderTemplate('chat-message', {\n        avatar: data.avatar_url,\n        name: data.name,\n        text: data.text,\n        schedule: moment.unix(data.timestamp).format('LLL')\n      });\n\n      self.$messagesContainer.append(html);\n      self.scrollToEnd();\n    },\n\n    renderTemplate: function (key, data) {\n      var liquid = $('#' + key + '-template').html();\n      var template = Liquid.parse(liquid);\n\n      return template.render(data);\n    },\n\n    loadMessages: function () {\n      var self = app.chat;\n      const setMessage = function (data) {\n        self.renderMessage(data.val());\n      }.bind(self);\n\n      self.messages.limitToLast(12).on('child_added', setMessage);\n      self.messages.limitToLast(12).on('child_changed', setMessage);\n    },\n\n    loadRoomOnlineUsers: function () {\n      var self = app.chat;\n      const setUser = function (data) {\n        var $html = $(self.renderTemplate('chat-profile-list-item', data.val()));\n        $('.js-students', self.$chat).append($html);\n        self.$roomUsersCount.html($('.chat-profile-list-item', self.$students).length);\n      }.bind(self);\n\n      const removeUser = function (data) {\n        $('.js-students [data-id=\"' + data.val().id + '\"]').remove();\n        self.$roomUsersCount.html($('.chat-profile-list-item', self.$students).length);\n      }.bind(self);\n\n      self.lessonRoomUsers.on('child_added', setUser);\n      self.lessonRoomUsers.on('child_removed', removeUser);\n    },\n\n    loadSchoolGroup: function () {\n      var self = app.chat;\n      $.ajax({\n        url: window.CORE_HOST + '/chat/school_group',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        data.is_school = true;\n\n        var $html = $(self.renderTemplate('chat-group-list-item', data));\n        $html.on('click', app.chat.changeRoom);\n        self.$groups.prepend($html);\n      });\n    },\n\n    loadGroups: function () {\n      var self = app.chat;\n      self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/groups?per_page=' + self.groupsPagination.perPage + '&page=' + (self.groupsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.groupsPagination.page = self.groupsPagination.page + 1;\n        self.$loadMoreGroupsButton.removeAttr('disabled', 'disabled');\n        self.groupsPagination.totalPages = data.total_pages;\n\n        if (self.groupsPagination.page >= self.groupsPagination.totalPages) {\n          self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n        }\n\n        var groups = data.groups;\n        groups = _.sortBy(groups, {is_school: false});\n        groups = _.map(groups, function (g) {\n          g.is_school = false;\n          return g;\n        });\n\n        groups.forEach(function (group) {\n          var $html = $(self.renderTemplate('chat-group-list-item', group));\n          $html.on('click', app.chat.changeRoom);\n          self.$groups.append($html);\n        });\n\n        self.selectFirstRoomAvailable();\n      });\n    },\n\n    loadCollaborators: function () {\n      var self = app.chat;\n      self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/collaborators?per_page=' + self.collaboratorsPagination.perPage + '&page=' + (self.collaboratorsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.collaboratorsPagination.page = self.collaboratorsPagination.page + 1;\n        self.$loadMoreCollaboratorsButton.removeAttr('disabled', 'disabled');\n        self.collaboratorsPagination.totalPages = data.total_pages;\n\n        if (self.collaboratorsPagination.page >= self.collaboratorsPagination.totalPages) {\n          self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n        }\n\n        self.addProfileItems(data.collaborators, 'js-team');\n        self.selectFirstRoomAvailable();\n      });\n    },\n\n    loadFollows: function () {\n      var self = app.chat;\n      self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/follows?per_page=' + self.followsPagination.perPage + '&page=' + (self.followsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.followsPagination.page = self.followsPagination.page + 1;\n        self.$loadMoreStudentsButton.removeAttr('disabled', 'disabled');\n        self.followsPagination.totalPages = data.total_pages;\n\n        if (self.followsPagination.page >= self.followsPagination.totalPages) {\n          self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n        }\n\n        self.addProfileItems(data.users, 'js-students');\n        self.selectFirstRoomAvailable();\n      });\n    },\n\n    registerCurrentUser: function () {\n      var self = this;\n\n      self.lessonRoomUsers\n        .orderByChild('id')\n        .equalTo(self.user.id)\n        .once('value')\n        .then(function (snapshot) {\n          if (!snapshot.hasChildren()) {\n            self.lessonRoomUsers.push(self.user).then(function (snap) {\n              self.userFirebase = snap;\n            });\n          }\n        });\n    },\n\n    addProfileItems: function (users, divClass) {\n      var self = app.chat;\n\n      users.forEach(function (user) {\n        var $html = $(self.renderTemplate('chat-profile-list-item', user));\n        $html.on('click', app.chat.changeRoom);\n        $('.' + divClass).append($html);\n      });\n    },\n\n    changeRoom: function (event) {\n      var self = app.chat;\n\n      $('.chat-sidebar-list-item').removeClass('active');\n\n      var roomName = 'messages';\n\n      if (self.chatType === 'lesson-chat') {\n        roomName += '_lessons/' + self.chatLesson.id;\n\n        // change room name on div\n        self.$roomTitle.html(self.chatLesson.title);\n        self.$roomUsersCount.html(0);\n      } else {\n        var $element = $(event.currentTarget);\n        $element.addClass('active');\n\n        if ($element.data('type') === 'products') {\n          // room name on firebase\n          roomName += '_products/' + $element.data('id');\n\n          // change room name on div\n          self.$roomTitle.html($('.js-chat-group-name', $element).html());\n          self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n        } else if ($element.data('type') === 'users') {\n          var ids = [self.userId, parseInt($element.data('id'))].sort();\n          roomName += '_users/' + ids[0] + '/' + ids[1];\n\n          // change room name on div\n          self.$roomTitle.html($('.info .name', $element).html());\n          self.$roomUsersCount.html($('.info .location', $element).html());\n        } else if ($element.data('type') === 'schools') {\n          // room name on firebase\n          roomName += '_schools/' + self.schoolId;\n\n          // change room name on div\n          self.$roomTitle.html($('.js-chat-group-name', $element).html());\n          self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n        }\n      }\n\n      self.$messagesContainer.html('');\n\n      if (self.messages) {\n        self.messages.off();\n      }\n\n      self.messages = self.database.ref(roomName);\n      self.loadMessages();\n    },\n\n    selectFirstRoomAvailable: function () {\n      if (!self.$selectedRoom) {\n        // Select first room\n        self.$selectedRoom = $('.chat-sidebar-list-item').first();\n        self.$selectedRoom.click();\n      }\n    }\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.bindCheckout = function () {\n    $('#js-terms-of-use-check').change(function () {\n      if ($(this).is(\":checked\") === true) {\n        $('.cta-checkout-cart').removeClass('disabled');\n      } else {\n        $('.cta-checkout-cart').addClass('disabled');\n      }\n    });\n\n    $(document).trigger('app:bind:checkout');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.ckeditor = {\n    bindCkeditor: function () {\n      var src = '//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js';\n\n      if ($('.js-ckeditor').length) {\n        loadAsset('window.CKEDITOR', src, function () {\n          $('.js-ckeditor').each(function (index, ckeditorObj) {\n            if (!$('#cke_' + ckeditorObj.id).length) {\n              var config = app.ckeditor.buildConfiguration(ckeditorObj);\n              config.placeholder = ckeditorObj.placeholder; // TODO: fix it\n\n              CKEDITOR.replace(ckeditorObj.id, config);\n            }\n          });\n\n          app.ckeditor.bindCkeditorSubmit();\n          $(document).trigger('app:bind:ckeditor');\n        });\n      }\n    },\n\n    buildConfiguration: function (ckeditorObj) {\n      var config = {\n        language: 'pt-br',\n        skin: 'moono'\n      };\n\n      if ($(ckeditorObj).data('upload-image') == true) {\n        var uploadUrl = '/files/full_upload';\n\n        config.extraPlugins = 'uploadimage';\n        config.imageUploadUrl = uploadUrl;\n        config.filebrowserImageUploadUrl = uploadUrl;\n      }\n\n      return config;\n    },\n\n    bindCkeditorSubmit: function () {\n      $.each($('.js-ckeditor'), function (index, editor) {\n        var $editor = $(editor);\n        var $form = $editor.parents('form');\n        var editorId = $editor.attr('id');\n        var hasCaptcha = $form.find('.js-recaptcha').size();\n\n        if ($form) {\n          var $submitButton = $form.find('button[type=\"submit\"]');\n          var editor = CKEDITOR.instances[editorId];\n\n          app.ckeditor.bindNotifications(editor);\n\n          editor.on('change', function () {\n            if (this.getData().length && !hasCaptcha) {\n              $submitButton.attr('disabled', false);\n            } else {\n              $submitButton.attr('disabled', true);\n            }\n          });\n        }\n      });\n\n      $(document).trigger('app:bind:ckeditor_submit');\n    },\n\n    bindNotifications: function (editor) {\n      var cancelNotification = function (evt) {\n        if (evt.data.notification.override !== true) {\n          evt.cancel();\n        }\n      }\n\n      editor.on('notificationShow', cancelNotification);\n      editor.on('notificationUpdate', cancelNotification);\n\n      editor.on( 'fileUploadRequest', function() {\n        editor.notification = new CKEDITOR.plugins.notification(editor, {\n          message: editor.lang.uploadwidget.uploadOne.replace( '({percentage}%)', '' ),\n          type: 'progress',\n          override: true\n        });\n\n        editor.notification.show();\n      });\n\n      editor.on( 'fileUploadResponse', function() {\n        editor.notification.update( {\n          message: editor.lang.uploadwidget.doneOne,\n          type: 'success'\n        });\n      });\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindCollaborativeDiscussion = function() {\n    $(document).on('click', '#collaborative-discussion .js-edit-button' ,function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').addClass('hide');\n      $comment.find('.js-edit-container').removeClass('hide');\n    });\n\n    $(document).on('click', '#collaborative-discussion .js-cancel-button' ,function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').removeClass('hide');\n      $comment.find('.js-edit-container').addClass('hide');\n    });\n\n\n    $(document).trigger('app:bind:collaborative_discussion');\n  };\n})();\n","(function () {\n     'use strict';\n\n     app.accessibility = function () {\n\n          var adjustPricesForAccessibility = function() {\n          //This function generates Aria-Labels for the tags with prices.\n          //Screen Readers can find some issues when reading '$' and ','.\n\n               var arrayOfPrices = [];\n               var itemList = $('.product-accessibility-list')\n               .find('li')\n               .find('a');\n\n               for (var i = 0; i < itemList.length; i++) {\n                    arrayOfPrices[i] = itemList[i];\n               }\n\n               arrayOfPrices.forEach(function(element) {\n\n                    var price = element.innerHTML.replace(/\\s+/g,' ')\n                    .replace('<span>', '')\n                    .replace('</span>', '')\n                    .replace('<a>', '')\n                    .replace('</a>', '');\n\n                    var currencyPosition = price.indexOf('R$');\n                    var hasPor = price.indexOf('por');\n                    var commaPosition = price.indexOf(',');\n\n                    if(currencyPosition != -1) {\n\n                         if (hasPor != -1) {\n\n                              price = price.substring(currencyPosition + 3, price.length);\n                              var posAfterComma = commaPosition + 3;\n                              price = price.slice(0, posAfterComma) + ' reais' + price.slice( posAfterComma , price.length);\n                         }\n\n                         else {\n                              price = price.substring(currencyPosition + 3, commaPosition + 3)+' reais';\n                         }\n\n                         price = price.replace(',00', '');\n                    }\n                    element.setAttribute('aria-label', price);\n               });\n          }();\n\n          var toggleHighContrast = function() {\n               $(\"html\").toggleClass('accessible');\n               $(\".accessibility-constrast-state-on\").toggleClass(\"hidden\");\n               $(\".accessibility-constrast-state-off\").toggleClass(\"hidden\");\n          }\n\n          $(\".contrast-on-btn\").on('click', function(){\n               toggleHighContrast();\n          });\n\n          var checkPageName = function() {\n          //This function generates a text inside the \"accessibility-location\" div.\n          //It works like a map for Blind Users, since they may find it hard to know exactly on which page they're in.\n               var possibleAddresses =\n               {\n                    \"\" : {\n                         pageName : \"Página Inicial\",\n                         divName : \"home\"\n                    },\n                    \"cart\": {\n                         pageName : \"Carrinho\",\n                         divName : \"cart\"\n                    },\n                    \"sign_in\": {\n                         pageName : \"Fazer Login\",\n                         divName : \"login\"\n                    },\n                    \"enrollments\": {\n                         pageName : \"Meus Cursos\",\n                         divName : \"enrollments\"\n                    },\n                    \"forums\": {\n                         pageName : \"Fóruns\",\n                         divName : \"forums\"\n                    },\n                    \"products\": {\n                         pageName : \"Produtos\",\n                         divName : \"products\"\n                    },\n                    \"edit\": {\n                         pageName : \"Meu Perfil\",\n                         divName : \"profile\"\n                    },\n                    \"certificates\": {\n                         pageName : \"Meus Certificados\",\n                         divName : \"certificates\"\n                    },\n                    \"channels\": {\n                         pageName : \"Mensagens\",\n                         divName : \"messages\"\n                    },\n                    \"orders\": {\n                         pageName : \"Meus Pedidos\",\n                         divName : \"orders\"\n                    },\n                    \"profile\": {\n                         pageName : \"Perfil Público\",\n                         divName : \"profile\"\n                    },\n                    \"products\": {\n                         pageName : \"Matrículas\",\n                         divName : \"products\"\n                    },\n                    \"media\": {\n                         pageName : \"Portifólio\",\n                         divName : \"portifolio\"\n                    }\n               };\n\n               var location, address;\n               location = window.location.href;\n\n               if (location.search('/profile/') != -1) {\n                    if (location.search('products') != -1)\n                         address = 'products';\n                    else if (location.search('media') != -1) {\n                         address = 'media';\n                    }\n                    else {\n                         address = 'profile';\n                    }\n               }\n               else {\n                    address = (location).substring(location.lastIndexOf('/') + 1, location.length);\n               }\n\n               window.$mainContentDiv = address && possibleAddresses && possibleAddresses[address] &&possibleAddresses[address].divName;\n               address = address && possibleAddresses && possibleAddresses[address] && possibleAddresses[address].pageName;\n\n               if (address) {\n                 $(\"#accessibility-location\").text(\"Você está em: \" + address + \" - Topo da Página\");\n               }\n          }();\n\n          var scrollToDiv = function(id) {\n            var $elementToScroll = $(id);\n\n            if ($elementToScroll.size() > 0) {\n                $(window).scrollTop($elementToScroll.offset().top - 50);\n                $elementToScroll.focus();\n            }\n          };\n\n          var checkAccessibiltyFunction = function(selectedElement) {\n               // This Function listens to the accessibility-shortcuts.\n               // It helps the Screen Readers' users to navigate through the website.\n               var a = $mainContentDiv;\n\n               if (selectedElement == null)\n                    var selectedElement = $(':focus').attr('id');\n\n               switch(selectedElement) {\n                    case 'accessibility-btn-1':\n                         scrollToDiv(\"#accessibility-main-content-\" + $mainContentDiv );\n                    break;\n                    case 'accessibility-btn-2':\n                         scrollToDiv(\"#main-navbar\");\n                    break;\n                    case 'accessibility-btn-3':\n                         scrollToDiv(\"#accessibility-contact\");\n                    break;\n                    case 'accessibility-btn-4':\n                         scrollToDiv(\"#accessibility-location\");\n                    break;\n               }\n          };\n\n          $(window).keydown(function(e){\n               if(!$(':focus').is('input')) { //It avoids problems with SHIFT inside 'INPUTS'\n                    switch (e.which) {\n                         case 13: //Enter\n                              checkAccessibiltyFunction();\n                              break;\n                         case 49: //1\n                              if (e.shiftKey)\n                                   checkAccessibiltyFunction('accessibility-btn-1');\n                                   break;\n                         case 50: //2\n                         if (e.shiftKey)\n                              checkAccessibiltyFunction('accessibility-btn-2');\n                              break;\n                         case 51: //3\n                              if (e.shiftKey)\n                                   checkAccessibiltyFunction('accessibility-btn-3');\n                                   break;\n                         case 52: //4\n                              if (e.shiftKey)\n                                   checkAccessibiltyFunction('accessibility-btn-4');\n                                   break;\n                    }\n               }\n          });\n\n          $(document).trigger('app:bind:accessibility');\n     };\n})();\n","(function () {\n  'use strict';\n\n  app.bindCourseRating = function () {\n    $(document).on(\"rate-course\", function (event, courseId) {\n      $('#js-rating-course-'+courseId+'-modal').modal();\n    });\n\n    $(document).on(\"course-rating-created\", function (event, courseId) {\n      $('#js-rating-course-' + courseId + '-modal').modal('hide');\n    });\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindDatepicker = function () {\n    // TODO: Handle i18n\n    $.fn.datepicker.defaults.language = 'pt-BR';\n\n    $('.datepicker').each(function (i, el) {\n      var $el = $(el);\n      var $hidden = $('<input type=\"hidden\" />').insertBefore($el.parent());\n      var frontDate = moment($el.val()).utc().format('DD/MM/YYYY');\n      var serverDate = moment($el.val()).utc().format('YYYY-MM-DD');\n      serverDate = (serverDate === 'Invalid date') ? null : serverDate;\n\n      $hidden.attr('id', $el.attr('id'));\n      $hidden.attr('name', $el.attr('name'));\n      $hidden.attr('value', serverDate);\n\n      $el.removeAttr('id');\n      $el.removeAttr('name');\n\n      if ($el.val() !== \"\") {\n        $el.val(frontDate);\n      }\n\n      $(el).datepicker()\n        .on('change', function () {\n          var date = moment($el.val(), 'DD/MM/YYYY').utc().format('YYYY-MM-DD');\n          date = (date === 'Invalid date') ? null : date;\n          $hidden.val(date);\n        });\n    });\n\n    $(document).trigger('app:bind:datepicker');\n  };\n\n})();\n","/*********************************************************************\n *\n *  components/deadpoolChat.js\n *  @name: DeadpoolChat\n *\n *********************************************************************/\n\n (function () {\n  'use strict';\n\n  app.deadpoolChat = {\n    bindDeadpool: function () {\n      var src = \"https://staging-cdn.eadbox.com/deadpooljs/dist.js\";\n\n      this.$deadpool = $('.deadpool-chat');\n      this.$jwt = this.$deadpool.data(\"jwt\");\n      this.$message_list = $('.chat-message-list');\n      this.$message_inputs = $('.message-inputs');\n      this.$chat_room = this.$deadpool.data(\"chat-room\");\n      this.$is_before = this.$deadpool.data(\"is-before\");\n      this.$message_form = $('form#message');\n      this.$message_input = this.$message_form.find('textarea[name=message-body]');\n\n      if (!this.$is_before) {\n        if (this.$deadpool.length) {\n          var that = this;\n          loadAsset('Deadpool', src, function() {\n            try {\n              deadpool.default.on(`connected`, () => {\n                app.deadpoolChat.joinRoom();\n              });\n\n              deadpool.default.on(`connection_failed`, () => {\n                var notification = {\n                  \"type\": \"close\",\n                  \"message_body\": \"Falha ao conectar com o chat!\"\n                }\n\n                app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n              });\n\n              deadpool.default.on(`disconnected`, () => {\n                var notification = {\n                  \"type\": \"exclamation\",\n                  \"message_body\": \"A conexão com o chat foi encerrada!\"\n                }\n\n                app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n              });\n\n              deadpool.default.connect(\"wss://deadpool.herospark.com/chat-service\", that.$jwt);\n            } catch (error) {\n                console.log(error);\n            }\n\n            $(document).trigger('app:deadpool:connected');\n          });\n\n          $(document).trigger('app:bind:deadpool');\n        }\n      } else {\n        var notification = {\n          \"type\": \"exclamation\",\n          \"message_body\": \"Esse Webinar ainda não começou\"\n        }\n\n        app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n      }\n    },\n    renderNewMessage: function(message) {\n      var hour = moment(message.date).format(\"HH:mm\");\n\n      if (!this.$is_before && !message.notification) {\n        var $msg_html = $(`\n          <div class=\"row message-item\">\n            <div class=\"message-header\">\n              <div class=\"col-md-9\">\n                <h5>${message.user.name}</h5>\n              </div>\n              <div class=\"col-md-3 message-timestamp\">\n                <span class=\"message-timestamp\">${hour}</span>\n              </div>\n            </div>\n            <div class=\"col-md-12 message-body\">\n              <p>${message.message}</p>\n            </div>\n          </div>\n        `)\n      } else {\n        var $msg_html = $(`\n          <div class=\"row message-item\">\n            <div class=\"col-md-12 message-header\">\n              <i class=\"icon-${message.type}\"> ${message.message}</i>\n            </div>\n          </div>\n        `)\n      }\n\n      this.$message_list.append($msg_html);\n    },\n    joinRoom: function() {\n      try {\n        deadpool.default.on(`joined_room`, () => {\n          var notification = {\n            \"type\": \"check\",\n            \"message_body\": \"Conectado ao chat com sucesso!\"\n          }\n\n          app.deadpoolChat.bindMessageEvents();\n          app.deadpoolChat.bindPresenceEvent();\n\n          this.$message_inputs.removeAttr('disabled');\n          app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n        });\n\n        deadpool.default.on(`join_timeout join_crashed join_failed`, () => {\n          var notification = {\n            \"type\": \"close\",\n            \"message_body\": \"Falha ao conectar com o chat!\"\n          }\n\n          app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n        });\n\n        deadpool.default.on(`closed_room`, () => {\n          var notification = {\n            \"type\": \"exclamation\",\n            \"message_body\": \"O chat da transmissão foi encerrado!\"\n          }\n\n          app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n        });\n\n        deadpool.default.join(this.$chat_room);\n      } catch (error) {\n          console.log(error);\n      }\n    },\n    bindMessageEvents: function() {\n      deadpool.default.on(`new_message`, message => {\n        var should_scroll_to_bottom = this.$message_list.scrollTop() + this.$message_list.height() == this.$message_list.prop(\"scrollHeight\");\n        app.deadpoolChat.renderNewMessage(message);\n\n        if (should_scroll_to_bottom)\n          this.$message_list.animate({ scrollTop: this.$message_list.prop(\"scrollHeight\")}, 0);\n      });\n\n      deadpool.default.on(`message_sent`, message => {\n        var should_scroll_to_bottom = this.$message_list.scrollTop() + this.$message_list.height() == this.$message_list.prop(\"scrollHeight\");\n        app.deadpoolChat.renderNewMessage(message);\n\n        if (should_scroll_to_bottom)\n          this.$message_list.animate({ scrollTop: this.$message_list.prop(\"scrollHeight\")}, 0);\n      });\n\n      this.$message_input.on('keyup', function (e) {\n        if (e.keyCode === 13) {\n          e.preventDefault();\n          app.deadpoolChat.submitMessage();\n        }\n      });\n\n      this.$message_form.on('submit', function(e) {\n        e.preventDefault();\n        app.deadpoolChat.submitMessage();\n      });\n\n      deadpool.default.on(`message_failed message_timeout`, () => {\n        var notification = {\n          \"type\": \"close\",\n          \"message_body\": \"Falha ao enviar messagem!\"\n        }\n\n        app.deadpoolChat.renderNewMessage(app.deadpoolChat.buildNotification(notification));\n      });\n    },\n    bindPresenceEvent: function() {\n      // Binding the other events\n      deadpool.default.on(`presence`, presenceList => {\n        // `presenceList` is an array of users, use this to track who is online\n        $('#watch-number').text(' '+presenceList.length);\n      });\n    },\n    submitMessage: function() {\n      var message_body = this.$message_input.val();\n      this.$message_input.val('');\n\n      deadpool.default.sendMessage(message_body);\n    },\n    buildNotification: function(options) {\n      var notification = {\n        \"notification\": true,\n        \"type\": options.type,\n        \"message\": options.message_body\n      }\n\n      return notification;\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindExamQuestionForm = function () {\n    $(document).on('click', '#js-remake-exam', function () {\n      $('#answers-container').addClass('hide');\n      $('#form-container').removeClass('hide');\n    });\n\n    $(document).on('click', '.js-clean-associative-options', function () {\n      $(this).parents('.associative-question')\n        .find('.js-associative-select option:selected')\n        .removeAttr('selected')\n    });\n\n    $(document).on('change', '.js-associative-select', function () {\n      var $question = $(this).parents('.associative-question');\n      var optionIndex = $(this).data('option-index');\n      var assertionId = $(this).find('option:selected').data('first-assertion-id');\n\n      $question.find('.js-associate-assertion[data-option-index=\"' + optionIndex + '\"]').val(assertionId);\n    });\n\n    // bind all form's inputs\n    $(document).on('change', '#exam_answer_form', app.checkFormValidity);\n    // bind all form's textareas for all types of typing\n    $(document).on('input propertychange', '#exam_answer_form', app.checkFormValidity);\n\n    $(document).trigger('app:bind:bind_exam_question_form');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindFixOnScroll = function () {\n    $('.js-fix-on-scroll').each(function (i, el) {\n      if (!$(el).hasClass('js-fix-on-scroll-mobile') && window.innerWidth < 992) {\n        return;\n      }\n\n      var $el = $(el);\n      $el.wrap('<div class=\"js-fix-scroll-wrapper\"/>');\n      var $wrapper = $el.parent('.js-fix-scroll-wrapper');\n\n      var offset = $el.offset();\n      var size = {\n        width: $el.outerWidth(),\n        height: $el.outerHeight()\n      };\n\n      $wrapper.width(size.width);\n      $wrapper.height(size.height);\n\n      $(document).on('scroll', function (e) {\n        var scrollTop = $(document).scrollTop();\n\n        if (scrollTop >= offset.top) {\n          if ($el.css('position') === 'fixed') return;\n\n          $el.parent().addClass('scroll');\n          $el.addClass('scroll');\n          $el.css({\n            position: 'fixed',\n            left: offset.left,\n            top: 0,\n            width: size.width,\n            height: size.height,\n            'z-index': '10000'\n          });\n        } else {\n          if ($el.css('position') === 'static') return;\n\n          $el.removeClass('scroll');\n          $el.parent().removeClass('scroll');\n          $el.css({\n            position: 'static',\n            left: 'auto',\n            top: 'auto',\n            width: 'auto',\n            height: 'auto'\n          });\n        }\n      })\n\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.followBind = function () {\n    $(document).on({\n        mouseenter: function(){\n          $(this).addClass('hidden');\n          $('#js-unfollow').removeClass('hidden');\n        }\n    }, '#js-following');\n\n    $(document).on({\n        mouseleave: function(){\n          $('#js-following').removeClass('hidden');\n          $(this).addClass('hidden');\n        }\n    }, '#js-unfollow');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindForumFeed = function () {\n    $(document).on(\"click\", \".js-collapse-toggle-text\", function (event) {\n        event.preventDefault();\n        var $this          = $(this);\n        var openText       = $this.data('open-text');\n        var closeText      = $this.data('close-text');\n        var $accordionBody = $($this.attr('href'));\n\n        if ($accordionBody.hasClass('in')) {\n          $accordionBody.collapse('hide');\n          $this.html(closeText);\n        } else {\n          $accordionBody.collapse('show');\n          $this.html(openText);\n          app.bindBlazy();\n        }\n    });\n\n    $(document).on(\"fix_forum_feed\", function () {\n      app.fixForumFeed();\n    });\n\n    $(document).on(\"forum_feed_post_created\", function (event, topicId) {\n      var $postsCounter     = $(\"#js-topic-item-\" + topicId + \" .js-posts-count\");\n      var $postsCounterSize = $postsCounter.find('.size');\n      var counter           = parseInt($postsCounterSize.html());\n\n      $postsCounterSize.html(counter + 1);\n      $postsCounter.removeClass('hidden');\n      $(\"#js-topic-\" + topicId + \"-posts\").removeClass('hidden');\n      $(\"#js-topic-\" + topicId + \"-posts-list-panel\").collapse('show');\n\n      app.fixForumFeed();\n    });\n\n    $('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n      app.fixForumFeed();\n    });\n  };\n\n  app.fixForumFeed = function () {\n    app.bindGlobal();\n    app.bindBlazy();\n  }\n})();\n","(function () {\n  'use strict';\n\n  /*\n    Alguns métodos foram sobrescritos no core,\n    visando manter compatibilidade com temas que não possuem a elegance atualizada.\n    - Métodos sobrescritos:\n      - init\n      - checkTrialByType\n  */\n\n  var buildLazyLoadUrl = function (enrollmentId, courseId, type) {\n    return ('/enrollments/:enrollment_id/courses/:course_id/' + type)\n            .replace(':enrollment_id', enrollmentId)\n            .replace(':course_id', courseId);\n  };\n\n\n  var getPaymentMethod = function (enrollmentId, courseId, apiKey) {\n    if (courseId === null || enrollmentId === null) {\n      return false;\n    }\n\n    console.warn('executed: lessonList.getPaymentMethod');\n\n    var request = $.ajax({\n      url: buildLazyLoadUrl(enrollmentId, courseId, 'payment_method'),\n      async: false,\n      headers: {\n        'Authorization': 'Token token=' + apiKey\n      }\n    });\n\n    return request && request.responseJSON.payment_method;\n  };\n\n\n  var getLessonsInfo = function (enrollmentId, courseId, apiKey) {\n    if (courseId === null || enrollmentId === null) {\n      return false;\n    }\n\n    console.warn('executed: lessonList.getLessonInfo');\n\n    var request = $.ajax({\n      url: buildLazyLoadUrl(enrollmentId, courseId, 'lessons_info'),\n      async: false,\n      headers: {\n        'Authorization': 'Token token=' + apiKey\n      }\n    });\n\n    return request && request.responseJSON.lessons_info;\n  };\n\n  app.lessonList = {\n    onTrial: {},\n    paymentMethod: undefined,\n    init: function () {\n      var self = this;\n\n      self.courseTreeExists = self.courseTree().length;\n      self.isActive = self.courseTree().data('is-active');\n      self.course = self.courseTree().data('course');\n      self.enrollment = self.courseTree().data('enrollment');\n      self.courseContent = self.courseTree().data('course-content');\n      self.userType = self.courseTree().data('user-type');\n      self.lessonActions = self.courseTree().data('lesson-actions');\n      self.downloadAction = self.courseTree().data('download-action');\n      self.currentLessonId = parseInt(self.courseTree().data('current-lesson-id'));\n      self.hasRequirements = $('.lesson-list-panel [data-requirements]').length > 0;\n      self.apiKey = self.courseTree().data('api-key');\n      self.translations = {};\n      self.translations['lesson.release_at'] = self.courseTree().data('translation-release-at');\n      self.translations['lesson.release_after'] = self.courseTree().data('translation-release-after');\n      self.translations['lesson.lock_at'] = self.courseTree().data('translation-lock-at');\n      self.translations['lesson.lock_after'] = self.courseTree().data('translation-lock-after');\n      self.translations['product.course_content.views'] = self.courseTree().data('translation-course_content-views');\n\n      if (self.renderAttendanceElement) {\n        $(document).on('activated-lesson', function() {\n            self.renderAttendanceElement();\n        });\n      }\n\n      if (self.course && self.enrollment) {\n        var lessonsInfo = getLessonsInfo(self.enrollment.id, self.course.id, self.apiKey);\n\n        self.courseTree().data('enrollment',  Object.assign({}, self.enrollment, { lessons_info: lessonsInfo }));\n      }\n\n      if (self.lessonProgress() && self.lessonProgress().completed) {\n        $('.btn-next-lesson').removeClass('disabled');\n      }\n\n      if (self.lessonProgress() && !self.lessonProgress().completed) {\n        self.progressIcon('progress').removeClass('hide');\n      }\n\n\n      if (self.hasRequirements) {\n        self.checkNextButtonUnlocked();\n      }\n\n      if (self.courseTreeExists && !self.isActive) {\n        self.bindClicks();\n        self.handleLessons();\n        self.loadTopModules();\n        self.bindChangeLesson();\n\n        $(document).trigger('app:bind:lesson_sidebar');\n\n        $(document).on('lesson-completed', function (event, lessonProgress) {\n          var $mediaControls = $('.btn-next-lesson');\n          var enrollmentId = lessonProgress.data.enrollment_id;\n\n          if (self.progressIcon('completed').hasClass('hide')) {\n            self.progressIcon('completed').removeClass('hide');\n          }\n\n          if (!self.progressIcon('progress').hasClass('hide')) {\n            self.progressIcon('progress').addClass('hide');\n          }\n\n          if ($mediaControls.size() > 0) {\n            $mediaControls.removeClass('disabled');\n          }\n\n          app.lessonList.requirementsExists(lessonProgress.data, function ($item, content_id) {\n            if ($item && content_id) {\n              app.lessonList.checkLessonCompleted(enrollmentId, content_id, function (completed) {\n                if (completed) {\n                  $item.removeClass('blocked');\n                  $item.find('.right > .icon-lock').remove();\n                }\n              });\n            }\n          });\n        });\n      }\n    },\n\n    // Props\n    courseTree: function () {\n      return $('.course-content #js-course-tree-ajax');\n    },\n\n    lazyLoadButtons: function () {\n      return $('.course-content #js-course-content-more-link, .course-content #js-course-content-prev-link');\n    },\n\n    lessons: function () {\n      return this.courseTree().find('.js-content');\n    },\n\n    currentLesson: function () {\n      return $(this.courseTree().find('.js-content.active')[0]);\n    },\n\n    toggleButton: function () {\n      return $('.lesson-list-toggle .btn');\n    },\n\n    lessonListPanel: function () {\n      return $('.lesson-list-panel');\n    },\n\n    lessonProgress: function () {\n      return $('#js-media-player').data('lesson-progress');\n    },\n\n    progressIcon: function (type) {\n      var iconType = {\n        completed: '.js-completed-icon',\n        progress: '.js-in-progress-icon'\n      };\n\n      return this.currentLesson().find(iconType[type]);\n    },\n\n    requirementsExists: function (lessonProgress, cb) {\n      if (!lessonProgress) {\n        return false;\n      }\n\n      var requirementsElements = $('.lesson-list-panel [data-requirements]')\n        .filter(function (index, item) {\n          return $(item).data('requirements').length > 0;\n        });\n\n      var requirementsUnified = requirementsElements.map(function (idx, item) {\n        return {\n          item: $(item),\n          requirements: $(item).data('requirements')\n        }\n      }).toArray();\n\n      var exists = _.find(requirementsUnified, {requirements: [{content_id: lessonProgress.lesson_id}]});\n\n      if (exists) {\n        var $item = exists.item;\n        if (cb) {\n          return cb($item, lessonProgress.lesson_id);\n        }\n      } else {\n        if (cb) {\n          return cb(null);\n        }\n      }\n    },\n\n    checkLessonCompleted: function (enrollmentId, id, cb) {\n      var self = this;\n      var completed = false;\n      var apiKey = $('.course-content #js-course-tree-ajax').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/enrollments/' + enrollmentId + '/lessons_progresses?lesson_id=' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        completed = data.lessons_progresses[0].completed;\n\n        cb(completed);\n      });\n    },\n\n    // Actions\n    bindChangeLesson: function () {\n      var self = this;\n\n      if (!self.bindChangeLessonActive) {\n        self.bindChangeLessonActive = true;\n        var course_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+$/;\n        var lesson_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+\\/course_contents\\/\\d+$/;\n\n        $(document).on(\"ready page:load\", function (e) {\n          var path = window.location.pathname;\n          var lesson_path = lesson_path_regex.test(path);\n\n          if (course_path_regex.test(path) || lesson_path) {\n            self.lessons().removeClass('active');\n\n            if (lesson_path) {\n              var path_array = path.split('/');\n              var content_id = path_array[path_array.length - 1];\n\n              $(\"#content-\" + content_id + \".js-content\").addClass('active');\n            }\n          }\n        })\n      }\n    },\n\n    bindClicks: function () {\n      var self = this;\n\n      self.lessons().find('a').on('click', function (e) {\n        e.preventDefault();\n        app.lessonList.changeLesson(null, $(this).parents('.js-content'));\n      });\n\n      self.courseTree().on('click', '.module', function (e) {\n        if (!$(e.target).hasClass('module') && !$(e.target).parent().hasClass('module')) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        self.loadChildren($(this));\n      });\n\n      self.courseTree().data('is-active', true);\n\n      self.toggleButton().on('click', this.toggleSidebar);\n    },\n\n    getLessonIcon: function (lesson) {\n      var lessonIcon = '';\n\n      if (lesson.type === 'ExamLesson' && lesson.activity) {\n        switch (lesson.activity.type) {\n          case 'Quiz': {\n            lessonIcon = 'icon-puzzle';\n            break;\n          }\n          case 'FileUpload': {\n            lessonIcon = 'icon-arrow-up-circle';\n            break;\n          }\n          case 'CollaborativeDiscussion': {\n            lessonIcon = 'icon-people';\n            break;\n          }\n          default: {\n            lessonIcon = 'icon-puzzle'\n          }\n        }\n      } else if (lesson.media) {\n        switch (lesson.media.type) {\n          case 'Video': {\n            lessonIcon = 'icon-camrecorder';\n            break;\n          }\n          case 'Audio': {\n            lessonIcon = 'icon-microphone';\n            break;\n          }\n          case 'Slide': {\n            lessonIcon = 'icon-chart';\n            break;\n          }\n          case 'Document': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'Image': {\n            lessonIcon = 'icon-picture';\n            break;\n          }\n          case 'Text': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'LiveStream': {\n            lessonIcon = 'icon-control-play';\n            break;\n          }\n          case 'VideoSlide': {\n            lessonIcon = 'icon-film';\n            break;\n          }\n          case 'ScormPackage': {\n            lessonIcon = 'icon-layers';\n            break;\n          }\n          case 'Html': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'Html5': {\n            lessonIcon = 'icon-docs';\n            break;\n          }\n          default: {\n            lessonIcon = 'icon-camrecorder';\n          }\n\n        }\n      }\n\n      return lessonIcon;\n    },\n\n    getContentPath: function (content) {\n      var self = this;\n\n      var enrollmentId = self.enrollment.id;\n      var courseId = self.course.id;\n\n      var path = enrollmentId ? '/enrollments/' + enrollmentId : '/admin_view';\n      path = path + '/courses/' + courseId + '/course_contents/' + content.id;\n\n      return path;\n    },\n\n    getContentDownloadPath: function (content) {\n      var self = this;\n      return self.getContentPath(content) + '/download';\n    },\n\n    checkLessonLocked: function (lesson, userType) {\n      var lessonLockAt = lesson.lock_at;\n      var lessonLockAfter = lesson.lock_after;\n\n      if (userType === 'Collaborator') {\n        return false;\n      }\n\n      if (!lessonLockAt && !lessonLockAfter) {\n        return false;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at).startOf('day');\n\n      var lessonLockTime = lessonLockAt ? moment(lessonLockAt).startOf('day') : enrollmentActivatedAt.add(lessonLockAfter, 'days');\n\n      return moment().startOf('day') >= lessonLockTime;\n    },\n\n    checkLessonAvailability: function (lesson) {\n      var releaseAt = lesson.release_at;\n      var releaseAfter = lesson.release_after;\n\n      if (!releaseAt && !releaseAfter) {\n        return true;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at).startOf('day');\n\n      var releaseTime = releaseAt ? moment(releaseAt).startOf('day') : enrollmentActivatedAt.add(releaseAfter, 'days');\n\n      return moment().startOf('day') >= releaseTime;\n    },\n\n    checkTrialByType: function (type, id) {\n      var self            = this;\n      var apiKey          = self.apiKey;\n      var constrainsName  = 'trial_' + type + '_ids';\n      var enrollmentId    = self.enrollment && self.enrollment.id;\n      var courseId        = self.course && self.course.id;\n\n      var $tree           = $('#js-course-tree-ajax');\n      var enrollment      = $tree.data('enrollment');\n      var schoolProduct   = $tree.data('school-product');\n\n      self.paymentMethod  = self.paymentMethod !== undefined ? self.paymentMethod : getPaymentMethod(enrollmentId, courseId, apiKey);\n      var constrainsTree  = schoolProduct && schoolProduct.trial_constrains;\n      var constrains      = constrainsTree && self.paymentMethod && constrainsTree[self.paymentMethod] || {};\n      var hasConstrains   = Object.keys(constrains).length > 0;\n\n      if (enrollmentId !== null && courseId !== null && !self.onTrial.hasOwnProperty(enrollmentId)) {\n        var request = $.ajax({\n          url: buildLazyLoadUrl(enrollmentId, courseId, 'on_trial'),\n          async: false,\n          headers: {\n            'Authorization': 'Token token=' + apiKey\n          }\n        });\n\n        self.onTrial[enrollmentId] = request && request.responseJSON.on_trial;\n      }\n\n      if (hasConstrains && !constrains.hasOwnProperty(constrainsName)) {\n        return false;\n      }\n\n      if (hasConstrains && constrains[constrainsName]) {\n        return constrains[constrainsName].indexOf(id) > -1;\n      }\n\n      if (enrollment && self.onTrial[enrollmentId]) {\n        return self.onTrial[enrollmentId];\n      }\n\n      return false;\n    },\n\n    fetchModules: function ($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          var modules = _.sortBy(res.course_modules, 'order');\n\n          modules = _.filter(modules, function (m) {\n            var module = _.find(self.allModules, {id: m.id});\n            return module.available !== false && (module.course_content_ids.length > 0 || module.course_modules.length > 0);\n          });\n\n          var $modules = _.map(modules, function (module) {\n            return $(\n              '<li class=\"list-group-item module\" ' +\n              'data-id=\"' + module.id + '\"' +\n              'data-level=\"' + (level + 1) + '\">' +\n              '<i class=\"icon icon-arrow-right\"></i>' +\n              '<span>' + module.name + '</span>' +\n              '<i class=\"busy busy-xs\"></i>' +\n              '</li>');\n          });\n\n          $list.append($modules);\n        }\n      })\n    },\n\n    fetchChildren: function ($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id + '/course_contents',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          var courseContents = _.filter(res.course_contents, function (lesson) {\n            return lesson.available !== false;\n          });\n\n          courseContents = _.sortBy(courseContents, 'order');\n\n          if (self.enrollment) {\n            courseContents = _.map(courseContents, function (content) {\n              content.completed = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(content.lesson.id) > -1;\n              return content;\n            });\n          }\n\n          var $courseContents = _.map(courseContents, function (content) {\n              var active = (self.currentLessonId === content.lesson.id ? 'active js' : '');\n              var lesson = content.lesson;\n              var lessonIcon = self.getLessonIcon(lesson);\n              var hideInProgressIcon = 'hide';\n              var hideCompletedIcon = 'hide';\n              var lessonReleased = null;\n              var releaseType = null;\n              var releaseDate = null;\n              var lessonLocked = null;\n              var lockLessonType = null;\n              var lockLessonDate = null;\n              var progress = null;\n              var requirements = content.requirements;\n              var available = true;\n\n              if (self.enrollment) {\n                lessonReleased = self.checkLessonAvailability(lesson) || self.userType === 'Collaborator';\n\n                lessonLocked = self.checkLessonLocked(lesson, self.userType);\n\n                if (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(lesson.id) > -1) {\n                  hideInProgressIcon = 'hide';\n                  hideCompletedIcon = null;\n                } else {\n                  if (self.enrollment.lessons_info && self.enrollment.lessons_info.in_progress.indexOf(lesson.id) > -1) {\n                    hideInProgressIcon = null;\n                    hideCompletedIcon = 'hide';\n                  } else {\n                    hideInProgressIcon = 'hide';\n                    hideCompletedIcon = 'hide';\n                  }\n                }\n\n                if (lesson.release_at) {\n                  releaseType = 'release_at';\n                  releaseDate = lesson.release_at;\n                } else if (lesson.release_after) {\n                  releaseType = 'release_after';\n                  releaseDate = moment(self.enrollment.activated_at).add(lesson.release_after, 'days');\n                }\n\n                if (lesson.lock_at) {\n                  lockLessonType = 'lock_at';\n                  lockLessonDate = lesson.lock_at;\n                } else if (lesson.lock_after) {\n                  lockLessonType = 'lock_after';\n                  lockLessonDate = moment(self.enrollment.activated_at).add(lesson.lock_after, 'days');\n                }\n\n                if (self.lessonActions) {\n                  progress = _.find(self.enrollment.lessons_progresses, {lesson_id: lesson.id});\n                }\n\n                _.each(requirements, function (requirement) {\n                  var exists = (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(requirement.content_id) > -1) || self.userType === 'Collaborator';\n                  if (!exists) {\n                    available = false;\n                  }\n                });\n              }\n\n              if (content.completed) {\n                $('.btn-next-lesson').removeClass('disabled');\n              }\n\n              var html = '<li class=\"list-group-item content-lesson js-content list-group-item lesson module-item ' + active + (!available || (self.enrollment && self.checkTrialByType('content', content.id)) ? ' blocked' : '') + '\" ' +\n                'id=\"content-' + content.id + '\" ' +\n                'data-requirements=\\'' + JSON.stringify(requirements) + '\\'' +\n                'data-id=\"' + content.lesson.id + '\"' +\n                'data-level=\"1\">' +\n                '<div id=\"lesson-' + lesson.id + '\" class=\"js-lesson content-lesson ' + active + (!lessonReleased ? ' not-released' : '') + (lessonLocked ? ' lesson-locked' : '') + '\" data-lesson-id=\"' + lesson.id + '\">' +\n                '<div class=\"class-info\">' +\n\n                '<div class=\"left\"><i class=\"' + lessonIcon + '\"></i></div>' +\n\n                '<div class=\"center\">' +\n                (self.lessonActions && lessonReleased && !lessonLocked ?\n                  '<a class=\"lesson-title\" href=\"' + self.getContentPath(content) + '\"><span>' + lesson.title + '</span></a>' :\n                  '<span class=\"lesson-title\"><span class=\"disabled\">' + lesson.title + '</span></span>') +\n                '</div>' +\n\n                '<div class=\"right\">' +\n                ((!available || (self.enrollment && self.checkTrialByType('content', content.id))) ? '<i class=\"icon-lock\"></i>' : '') +\n                '<span class=\"progress-icon js-progress-icons\">' +\n                '<i class=\"icon-check js-completed-icon ' + hideCompletedIcon + '\"></i>' +\n                '<i class=\"icon-clock js-in-progress-icon ' + hideInProgressIcon + '\"></i>' +\n                '</span>';\n\n              if (self.lessonActions) {\n                if (progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts') {\n                  var translation = self.translations['product.course_content.views'];\n\n                  translation = translation.replace('{{ progress.views }}', progress.views);\n                  translation = translation.replace('{{ enrollment.max_attendance_length }}', self.enrollment.max_attendance_length);\n\n                  html += '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + translation + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' +\n                    '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' +\n                    '</span>';\n                }\n\n                if (!lessonReleased) {\n                  var zone = moment.tz.guess();\n                  html += '<span class=\"release-date badge\">' + self.translations['lesson.' + releaseType] + '<span> ' + moment.tz(releaseDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n                }\n\n                if (lessonLocked) {\n                  var zone = moment.tz.guess();\n                  html += '<span class=\"lesson-locked-date badge\">' + self.translations['lesson.' + lockLessonType] + '<span> ' + moment.tz(lockLessonDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n                }\n\n                var isDownloadableMedia = content.lesson.media && ['Document', 'Audio', 'Download'].indexOf(content.lesson.media.type) > -1;\n\n                if ((self.downloadAction || content.downloadable) && isDownloadableMedia)\n                  html += '<a class=\"download-link\" href=\"' + self.getContentDownloadPath(content) + '\" data-no-turbolink>' +\n                    '<i class=\"icon-cloud-download\"></i>' +\n                    '</a>';\n                }\n\n              html += '</div>' +\n                '</div>' +\n                '</li>';\n\n              return $(html);\n            }\n          );\n\n          $list.append($courseContents);\n          self.checkNextButtonUnlocked();\n\n          $(document).trigger('loaded-children');\n        }\n      });\n    },\n\n    renderAttendanceElement: function () {\n      var self = this;\n\n      if (!self.lessonProgress)\n        return false;\n\n      var progress = self.lessonProgress();\n      var translation = self.translations['product.course_content.views'];\n\n      translation = translation.replace('{{ progress.views }}', progress.views);\n      translation = translation.replace('{{ enrollment.max_attendance_length }}', self.enrollment.max_attendance_length);\n\n      var el = $('.js-lesson[data-lesson-id=' + progress.lesson_id + '] .right');\n      var isAttempts = progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts';\n\n      if (el.find('.js-attendance').size() === 0 && self.lessonActions && isAttempts) {\n        var html = '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + translation + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' +\n                    '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' +\n                    '</span>';\n\n        el.append(html);\n      }\n\n    },\n\n    checkNextButtonUnlocked: function () {\n      var lessonProgress = this.lessonProgress();\n\n      app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n        if ($item && content_id) {\n          if (!content_id || !lessonProgress.hasOwnProperty('enrollment_id')) {\n            return;\n          }\n\n          app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n            if (completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n              $item.removeClass('blocked');\n              $item.find('.right > .icon-lock').remove();\n            }\n          });\n        }\n        else {\n          $('.btn-next-lesson').removeClass('disabled');\n        }\n      });\n    },\n\n    loadTopModules: function () {\n      var self = this;\n\n      if (!self.course) return;\n\n      $.ajax({\n        url: window.CORE_HOST + '/courses/' + self.course.id + '/course_modules',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          if (!res.course_modules || res.course_modules.length <= 0) return;\n\n          self.allModules = res.course_modules;\n\n          self.topModules = _.filter(res.course_modules, function (x) {\n            return (!x.parent_course_module && x.available !== false) &&\n              (x.course_content_ids.length > 0 || x.course_modules.length > 0);\n          });\n\n          self.topModules = _.sortBy(self.topModules, 'order');\n\n          var $modules = _.map(self.topModules, function (module) {\n            var disabled = self.enrollment && self.checkTrialByType('module', module.id);\n\n            return $(\n              '<li class=\"list-group-item module ' + (disabled ? 'disabled' : '') + '\" ' +\n              'data-id=\"' + module.id + '\"' +\n              'data-level=\"1\">' +\n              '<i class=\"icon icon-arrow-right\"></i>' +\n              '<span>' + module.name + '</span>' +\n              '<i class=\"busy busy-xs\"></i>' +\n              '</li>');\n          });\n\n          self.courseTree().prev('.course-content-busy').fadeOut('fast', function () {\n            self.courseTree().css('display', 'none');\n            self.courseTree().html($modules);\n            self.courseTree().fadeIn('fast');\n\n            if (self.courseContent) {\n              self.expandParentModules(self.courseContent.parent_modules_hash);\n            }\n          });\n        }\n      })\n    },\n\n    loadChildren: function (parent, cb) {\n      var self = this;\n      var $parent = $(parent);\n\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      if ($list.length <= 0) {\n        $parent.find('.busy').css({opacity: 1});\n        $list = $('<ul class=\"list-group\" style=\"display: none;\"></ul>');\n        $list.appendTo($parent);\n\n        $.when(self.fetchModules($parent), self.fetchChildren($parent))\n          .then(function () {\n            $parent.addClass('expanded');\n            $parent.find('.busy').css({opacity: 0});\n\n            $list.slideDown('fast');\n\n            if (typeof cb === 'function') {\n              cb();\n            }\n          });\n      } else {\n        if ($parent.hasClass('expanded')) {\n          $parent.removeClass('expanded');\n          $list.slideUp('fast');\n        } else {\n          $parent.addClass('expanded');\n          $list.slideDown('fast');\n        }\n\n        if (typeof cb === 'function') {\n          cb();\n        }\n      }\n    },\n\n    handleLessons: function () {\n      $(document).on('page:load page:restore', function (e) {\n\n        if (!e.originalEvent || !e.originalEvent.data || e.originalEvent.data.length == 0) return;\n\n        var $html = $(e.originalEvent.data[0]);\n        app.lessonList.lessons().each(function (i, el) {\n          var $el = $(el);\n          var $new = $html.find('#' + $el.attr('id'));\n          $el.html($new.html());\n        });\n      })\n    },\n\n    changeLesson: function (direction, lesson) {\n      var $targetLesson = $(lesson);\n\n      if (direction === 'prev') {\n        var $prev = app.lessonList\n          .currentLesson()\n          .prevAll('.js-content');\n\n        if ($prev.length > 0 && $prev.find('a').length > 0)\n          $targetLesson = $($prev[0]);\n      } else if (direction === 'next') {\n        var $next = app.lessonList\n          .currentLesson()\n          .nextAll('.js-content');\n\n        if ($next.length > 0 && $next.find('a').length > 0)\n          $targetLesson = $($next[0]);\n      }\n\n      $targetLesson.find('a')[0].click();\n    },\n\n    expandParentModules: function (parentModules) {\n      var self = this;\n\n      var modules = [];\n      var loopModule = parentModules.course_module;\n      modules.push(loopModule.id);\n\n      while (loopModule.parent_module) {\n        loopModule = loopModule.parent_module;\n        modules.push(loopModule.id);\n      }\n\n      modules = modules.reverse();\n\n      async.eachSeries(modules, function (moduleId, cb) {\n        var $module = $('.module[data-id=\"' + moduleId + '\"]');\n        self.loadChildren($module, cb);\n      });\n\n    },\n\n    toggleSidebar: function () {\n      app.lessonList.toggleButton().toggleClass('active');\n      app.lessonList.lessonListPanel().toggleClass('active');\n    }\n  };\n\n})();\n","(function () {\n  'use strict';\n\n  app.lessonPage = function () {\n    var REGEX_COLLABORATIVE_DISCUSSIONS = /\\/collaborative_discussions\\/([0-9]+)\\/collaborative_comments/;\n    var REGEX_EXAM_ANSWERS = /\\/exam_answers/;\n\n    var isCollaborativeDiscuttion = function (value) {\n      return REGEX_COLLABORATIVE_DISCUSSIONS.test(value);\n    };\n\n    var isExamAnswer = function (value) {\n      return REGEX_EXAM_ANSWERS.test(value);\n    };\n\n    $(document).ajaxSuccess(function (event, xhr, settings) {\n      if (isCollaborativeDiscuttion(settings.url) || isExamAnswer(settings.url)) {\n        var lessonProgress = app.lessonList.lessonProgress();\n\n        app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n          if (content_id && lessonProgress.enrollment_id) {\n            app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n              if (completed) {\n                var $currentItemIcon = app.lessonList.currentLesson().find('.js-in-progress-icon');\n                $currentItemIcon.removeClass('icon-clock');\n                $currentItemIcon.removeClass('js-in-progress-icon');\n                $currentItemIcon.addClass('js-in-completed-icon');\n                $currentItemIcon.addClass('icon-check');\n\n                $('.btn-next-lesson').removeClass('disabled');\n                $item.removeClass('disabled');\n                $item.removeClass('blocked');\n                $item.find('.right > .icon-lock').remove();\n              }\n            });\n          }\n        }, function () {\n          $('.btn-next-lesson').removeClass('disabled');\n        });\n\n      }\n    });\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindMasks = function () {\n    var phoneMaskBehavior = function (val) {\n      return val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n    };\n\n    var phoneMaskOptions = {\n      onKeyPress: function (val, e, field, options) {\n        field.mask(phoneMaskBehavior.apply({}, arguments), options);\n      }\n    };\n\n    $('#user-phone').mask(phoneMaskBehavior, phoneMaskOptions);\n    $('#user-cpf').mask('999.999.999-99');\n    $('#user-cep').mask('99.999-999');\n\n    $(document).trigger('app:bind:masks');\n  };\n})();\n","app.notepad = {\n  page: 1,\n\n  noteContainer: function () {\n    return $('#notepad-container');\n  },\n\n  form: function () {\n    return $('#js-notepad-form');\n  },\n\n  loadNote: function (lesson_id, cb) {\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'GET',\n      success: function () {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    })\n  },\n\n  saveNote: function (cb) {\n    var note = $(\"#js-note\").html();\n    var note_id = $(\"#js_note_id\").val();\n\n    var $button = $(\"#save_notepad_button\");\n    var buttonLabel = $button.html();\n    $button.html($button.data(\"sending\"));\n    $button.prop('disabled', true);\n\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'POST',\n      data: {\n        _id: note_id,\n        note: note\n      },\n      success: function () {\n        $button.html(buttonLabel);\n        $button.prop('disabled', false);\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function () {\n    var self = this;\n    if (this.noteContainer().length <= 0) return;\n    this.loadNote($(\"#lesson_id\").val());\n\n    $(\"#notepad_form\").on('submit', function(event) {\n      event.preventDefault();\n      self.saveNote();\n    });\n  }\n};\n","(function () {\n  'use strict';\n\n  app.bindPostsForm = function () {\n    $(document).on('click', '.js-post-edit', function () {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').addClass('hidden');\n      post.find('.js-post-form').removeClass('hidden');\n    });\n\n    $(document).on('click', '.js-post-cancel', function (e) {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').removeClass('hidden');\n      post.find('.js-post-form').addClass('hidden');\n    });\n\n    $(document).trigger('app:bind:bind_posts_form');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindReadMore = function () {\n    $('[role=\"readmore\"]').each(function (i, el) {\n      var speed = $(el).data('speed') || 100;\n      var collapsedHeight = $(el).data('collapsed-height') || 200;\n      var moreText = $(el).data('more-text') || 'Leia Mais';\n      var lessText = $(el).data('less-text') || 'Fechar';\n\n      var currHeight = $(el).innerHeight();\n      var showLink = currHeight <= collapsedHeight;\n\n      $(el).readmore({\n        speed: speed,\n        collapsedHeight: collapsedHeight,\n        moreLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + moreText + '</a>',\n        lessLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + lessText + '</a>'\n      })\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  window.onLoadRecaptcha = function () {\n    app.bindRecaptcha();\n  };\n\n  app.bindRecaptcha = function () {\n    var $recaptcha = $('.js-recaptcha');\n\n    if (!$recaptcha.length || typeof grecaptcha === 'undefined' || !grecaptcha.hasOwnProperty('render')) return;\n\n    $recaptcha.each(function (i, el) {\n      const $el = $(el);\n      const sitekey = $el.data('sitekey');\n      const elId = $el.attr('id');\n      const disableButton = $el.data('disable-button') === true;\n      const buttonSelector = $el.data('button-selector');\n\n      const $form = $el.parents('form');\n      const $formButton = buttonSelector ? $form.find(buttonSelector) : $form.find('button[type=\"submit\"], input[type=\"submit\"]');\n\n      if (disableButton) {\n        $formButton.prop('disabled', true);\n      }\n\n      grecaptcha.render(elId, {\n        'sitekey': sitekey,\n        'callback': function () {\n          if (disableButton) {\n            $formButton.prop('disabled', false);\n          }\n        }\n      });\n    });\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.simpleEditor = {\n    createShortcut: function (bindKey, callback) {\n      var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n      var bindFunction = function (e) {\n        var character = String.fromCharCode(e.keyCode);\n        var ctrl = e.ctrlKey;\n        var meta = !!e.metaKey;\n        var score = 0;\n\n        if (isMac && meta) {\n          score++;\n        } else if (ctrl) {\n          score++;\n        }\n\n        if (character === bindKey) {\n          score++;\n\n          if (score === 2) {\n            e.stopPropagation();\n            e.preventDefault();\n            return callback();\n          }\n        }\n      };\n\n      $('body').bind('keydown', bindFunction);\n    },\n\n    handleDrag: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n\n    handleDrop: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var x = e.clientX;\n      var y = e.clientY;\n      var file = e.dataTransfer.files[0];\n\n      var URLObj = window.URL || window.webkitURL;\n      var source = URLObj.createObjectURL(file);\n\n      if (file.type.match('image.*')) {\n\n        var img = document.createElement(\"img\");\n\n        img.src = source;\n\n        var range = null;\n\n        if (document.caretPositionFromPoint) {\n          var pos = document.caretPositionFromPoint(x, y);\n          range = document.createRange();\n          range.setStart(pos.offsetNode, pos.offset);\n          range.collapse();\n          range.insertNode(img);\n        } else if (document.caretRangeFromPoint) {\n          range = document.caretRangeFromPoint(x, y);\n          range.insertNode(img);\n        }\n      }\n    },\n\n    updateButtons: function () {\n      var bold = document.queryCommandState(\"Bold\");\n      var italic = document.queryCommandState(\"Italic\");\n      var underline = document.queryCommandState(\"Underline\");\n\n      if (bold === true) {\n        $('[data-action=bold]').addClass('active');\n      } else {\n        $('[data-action=bold]').removeClass('active');\n      }\n\n      if (italic === true) {\n        $('[data-action=italic]').addClass('active');\n      } else {\n        $('[data-action=italic]').removeClass('active');\n      }\n\n      if (underline === true) {\n        $('[data-action=underline]').addClass('active');\n      } else {\n        $('[data-action=underline]').removeClass('active');\n      }\n    },\n\n    init: function (container) {\n      this.$container = $(container);\n\n      if(this.$container.length <= 0) {\n        return;\n      }\n\n      this.$input = this.$container.find('.js-input');\n      this.$btnAction = this.$container.find('.js-btn-action');\n\n      this.registerTriggers();\n      this.registerDropZone();\n      this.registerShortcuts();\n    },\n\n    registerTriggers: function () {\n      var self = this;\n\n      self.$btnAction.on('click', function () {\n        var action = $(this).attr('data-action');\n        document.execCommand(action);\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('click', function () {\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('focusin', function () {\n        self.$container.addClass('focused');\n      });\n\n      self.$input.on('focusout', function () {\n        self.$container.removeClass('focused');\n      });\n    },\n\n    registerDropZone: function () {\n      var dropZone = $(this.container).find('.js-input');\n      dropZone.on('dragover', app.simpleEditor.handleDrag, false);\n      dropZone.on('drop', app.simpleEditor.handleDrop, false);\n    },\n\n    registerShortcuts: function () {\n\n      app.simpleEditor.createShortcut('U', function () {\n        document.execCommand('underline');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('B', function () {\n        document.execCommand('bold');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('I', function () {\n        document.execCommand('italic');\n        app.simpleEditor.updateButtons();\n      });\n    }\n  };\n\n})();\n","(function () {\n    'use strict';\n\n    app.randomQuizStatistics = function () {\n        var $statistic = $(\".statistic\");\n        var statisticArray = [];\n        var finalArray = [];\n\n        var getData = function(property) {\n            return $statistic[i].attributes[property].value;\n        }\n\n        for (var i = 0; i < $statistic.size(); i++) {\n            \n            var tag = getData('data-tag');\n            var difficulty = getData('data-difficulty');\n            var quantity = getData('data-quantity');\n            var hits = getData('data-hits');\n\n            statisticArray.push({\n                'id' : `${tag}-${difficulty}`,\n                'quantity' : quantity,\n                'hits' : hits,\n                'tag' : tag,\n                'difficulty': difficulty\n            });\n\n        }\n\n        var groupedTags = _.uniqBy(statisticArray, 'id');\n\n        for (var i = 0; i < groupedTags.length; i++) {\n\n            var currentID = groupedTags[i].id;\n            var matchedTags = _.filter(statisticArray, _.matches({ 'id': currentID }));\n            \n            var totalQuantity = 0,\n            totalHits = 0,\n            finalTag = '',\n            finalDifficulty = ''; \n\n            _.forEach(matchedTags, function(value) {\n                totalQuantity += parseInt(value.quantity);\n                totalHits += parseInt(value.hits);\n                finalTag = value.tag;\n                finalDifficulty = value.difficulty;\n            });\n\n            var totalErrors = totalQuantity - totalHits;\n            var performance = (totalHits / totalQuantity * 100).toFixed() + '%';\n\n            finalArray.push({\n                'tag' : finalTag,\n                'difficulty' : finalDifficulty,\n                'total' : totalQuantity,\n                'correct_anwsers' : totalHits,\n                'wrong_answers' : totalErrors,\n                'performance' : performance \n            });\n        }\n            \n        var vocabulary = $('.statistic-texts').first().data();\n        var $div = $('#course-statistics');\n\n        _.forEach(finalArray, function(value) {\n            var template = \n            `<div class=\"row statistic-item\">    \n                <div class=\"statistics-board\">        \n                    <div class=\"row statistic-label\">\n                        <h2 class=\"tag\">${value.tag}</h2>\n                        <h2 class=\"difficulty\">${value.difficulty}</h2>\n                    </div>\n                    <div class=\"col-md-3 box-outline\">\n                        <div class=\"statistic-box total\">\n                            <p class=\"result\">${value.total}</p>\n                            <p class=\"name\">${vocabulary.textAnswered}</p>\n                            <div class=\"box-footer\">        \n                            </div>\n                        </div>\n                    </div> \n                    <div class=\"col-md-3 box-outline\">\n                        <div class=\" statistic-box correct\">\n                            <p class=\"result\">${value.correct_anwsers}</p>\n                            <p class=\"name\">${vocabulary.textRight}</p>\n                            <div class=\"box-footer\">\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col-md-3 box-outline\">\n                        <div class=\"statistic-box wrong\">\n                            <p class=\"result\">${value.wrong_answers}</p>\n                            <p class=\"name\">${vocabulary.textWrong}</p>\n                            <div class=\"box-footer\">\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col-md-3 box-outline\">\n                        <div class=\"statistic-box performance\">\n                            <p class=\"result\">${value.performance}</p>\n                            <p class=\"name\">${vocabulary.textPerformance}</p>\n                            <div class=\"box-footer\">\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>`;\n    \n            $div.append(template);\n        });\n\n         $(document).trigger('app:bind:randomQuizStatistics');\n    };\n})();\n","(function () {\n    'use strict';\n\n    var strength = function(pass) {\n        var force = 0;\n\n        // rules\n        var lowerLetters = /[a-z]+/;\n        var upperLetters = /[A-Z]+/;\n        var numbers = /\\d+/;\n        var symbols = /.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/;\n\n        // check if password is > 6\n        if ( pass.length >= 6 ) force++;\n\n        // check lowercase and uppercase \n        if ( ( pass.match(lowerLetters) ) && ( pass.match(upperLetters) ) ) force++;\n\n        // check numbers\n        if ( pass.match(numbers) ) force++;\n\n        // check symbols\n        if ( pass.match(symbols) ) force++;\n\n        // check if password is > 12\n        if ( pass.length > 12 ) force++;\n\n        return force;\n    }\n  \n    app.bindStrongPassword = function () {\n        var input = $('.strong--password'),\n            form  = input.parents('form:first'),\n            alert = form.find('.alert');\n\n        $('.strong--password')\n            .bind('change focus paste keyup', function () {\n                if ( $(this).val() !== '' && (strength($(this).val()) >= 3) ) {\n                    alert.hide();\n                    form.find('input[type=\"submit\"]').removeClass('disabled');\n                } else {\n                    alert.show();\n                    form.find('input[type=\"submit\"]').addClass('disabled');\n                }\n            })\n            .bind('blur', function () {\n                alert.hide();\n            });\n    }\n  })();\n  ","app.studentDoubts = {\n  page: 1,\n\n  doubtsContainer: function () {\n    return $('#js-doubts-container');\n  },\n\n  form: function () {\n    return $('#js-student-doubts-form');\n  },\n\n  expandButton: function () {\n    return $('#js-expand-student-doubts-form');\n  },\n\n  hideButton: function () {\n    return $('#js-hide-student-doubts-form');\n  },\n\n  loadMoreButton: function () {\n    return $('#js-load-more-doubts');\n  },\n\n  loadDoubts: function (cb) {\n    var self = this;\n\n    $.ajax({\n      url: window.location.pathname + '/student_doubts/page/' + self.page,\n      method: 'GET',\n      data: {\n        per_page: 3\n      },\n      complete: function () {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    })\n  },\n\n  init: function () {\n    var self = this;\n\n    if (self.doubtsContainer().length <= 0) return;\n\n    self.expandButton().on('click', function () {\n      self.expandButton().hide();\n      self.form().slideDown('fast');\n    });\n\n    self.hideButton().on('click', function () {\n      self.form().slideUp('fast', function () {\n        self.expandButton().fadeIn('fast');\n      });\n    });\n\n    self.loadMoreButton().on('click', function () {\n      self.page = self.page + 1;\n      var $btn = $(this);\n\n      $btn.attr('disabled', 'disabled');\n      self.loadDoubts(function () {\n        $btn.removeAttr('disabled');\n      });\n    });\n\n    self.loadDoubts();\n  }\n};\n","(function () {\n  'use strict';\n\n  app.timeTags = function () {\n    var $edoolsPlayerContainer = $('.js-edools-player');\n    if ($edoolsPlayerContainer.length <= 0) {\n      return;\n    }\n\n    var edoolsPlayer = $edoolsPlayerContainer[0].edoolsPlayer;\n\n    $('.js-timetags .list-group-item').on('click', function (e) {\n      e.preventDefault();\n\n      if ($edoolsPlayerContainer.length > 0) {\n        var time = $(this).data('time');\n\n        edoolsPlayer.setTime(time);\n      }\n    })\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.changeTimeZone = function () {\n    $('.js-to-client-timezone').each(function (i, el) {\n      var $el = $(el);\n      var format = $el.data('format');\n      var zone = moment.tz.guess();\n      var time = $el.data('timezone');\n\n      $el.html(moment.tz(time, zone).format(format));\n    });\n\n    $(document).trigger('app:change:timezone');\n  };\n\n  // TODO: FIXME: Essa chamada é para funcionar no primeiro load. Não deveria\n  // ser assim, parece ser algum erro com a inserção de cod no tema\n  app.changeTimeZone();\n})();\n","(function () {\n  $(document).on('page:load', function () {\n    app.init();\n  });\n\n  $(document).on('page:partial-load', function () {\n    app.bindBlazy();\n  });\n\n  $(document).ready(function () {\n    app.init();\n  });\n})();\n"]}