{"version":3,"sources":["theme.base.min.js","app.js","blazy.js","categoryList.js","chat.js","checkout.js","ckeditor.js","colaborativeDiscussion.js","datepicker.js","examQuestionForm.js","fixOnScroll.js","follow.js","lessonList.js","lessonPage.js","mask.js","notepad.js","pagarme.js","postsForm.js","readmore.js","simpleEditor.js","studentDoubts.js","timezone.js","main.js"],"names":["window","app","bindGlobal","FastClick","attach","document","body","$","timeago","trigger","bindOpenOnLoad","toOpen","length","each","i","elem","open","attr","bindTooltips","tooltip","checkFormValidity","event","form","currentTarget","submitButton","find","checkValidity","removeAttr","init","pagarme","bindBlazy","bindMasks","bindReadMore","bindDatepicker","bindFixOnScroll","ckeditor","bindCkeditor","bindCheckout","lessonList","chat","studentDoubts","notepad","categoryList","bindExamQuestionForm","changeTimeZone","followBind","lessonPage","bindPostsForm","on","bindCollaborativeDiscussion","e","Blazy","self","this","$categoryList","isActive","data","bindClicks","expandParents","expandParent","parent","$parent","animate","$nextListGroup","first","$parentCategoryItem","stop","slideToggle","toggle","toggleClass","$loopItem","parents","$jsChat","$text","$messagesContainer","bindScroll","empty","keyup","code","keyCode","which","shiftKey","submitMessage","loadGroups","didLoadGroups","loadGeneral","didLoadGeneral","loadFollowers","didLoadFollowers","simpleEditor","switchRoom","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","firebase","initializeApp","database","messages","ref","loadMessages","chatHeight","height","$messagesScrollContainer","$messagesScroll","$messagesHeader","$messagesFooter","messagesScrollHeight","scrollbar","setMessage","insertMessage","val","bind","limitToLast","sanitizeHtml","$root","remove","children","el","$el","tagName","last","get","pad","n","preventDefault","$html","text","html","focus","date","Date","user","push","id","name","avatar_url","timestamp","moment","unix","schedule","getHours","getMinutes","renderTemplate","avatar","append","scrollTop","scrollHeight","key","liquid","template","Liquid","parse","render","callback","ajax","url","CORE_HOST","method","headers","Authorization","success","groups","groupTemplate","forEach","group","$template","$usersCont","users_count","users","addProfileItems","divClass","profileTemplate","$avatar","addClass","cover_image_url","first_name","last_name","status","last_seen","change","is","removeClass","src","loadAsset","language","skin","index","ckeditorObj","placeholder","CKEDITOR","replace","bindCkeditorSubmit","editor","$editor","$form","editorId","$submitButton","instances","getData","commentId","$comment","fn","datepicker","defaults","$hidden","insertBefore","frontDate","utc","format","serverDate","$question","optionIndex","assertionId","hasClass","innerWidth","wrap","$wrapper","offset","size","width","outerWidth","outerHeight","top","css","position","left","z-index","mouseenter","mouseleave","courseTreeExists","courseTree","course","enrollment","courseContent","userType","lessonActions","downloadAction","currentLessonId","parseInt","translations","handleLessons","loadTopModules","bindChangeLesson","lessonProgress","$mediaControls","enrollmentId","enrollment_id","requirementsExists","$item","content_id","checkLessonCompleted","completed","lazyLoadButtons","lessons","currentLesson","toggleButton","lessonListPanel","cb","cbNotExists","requirementsElements","filter","item","requirementsUnified","map","idx","requirements","toArray","exists","_","lesson_id","lessons_progresses","bindChangeLessonActive","course_path_regex","lesson_path_regex","path","location","pathname","lesson_path","test","path_array","split","changeLesson","target","stopPropagation","loadChildren","toggleSidebar","getLessonIcon","lesson","lessonIcon","type","activity","media","getContentPath","content","courseId","getContentDownloadPath","checkLessonAvailability","releaseAt","release_at","releaseAfter","release_after","enrollmentActivatedAt","activated_at","releaseTime","add","checkTrialByType","$tree","$enrollment","constrains_name","payment_method","constrains_tree","trial_constrains","constrains","hasOwnProperty","indexOf","fetchModules","level","$list","res","modules","sortBy","course_modules","m","module","allModules","available","course_content_ids","$modules","fetchChildren","blockedContent","courseContents","course_contents","lessons_info","$courseContents","active","hideInProgressIcon","hideCompletedIcon","lessonReleased","releaseType","releaseDate","progress","requirements_ids","in_progress","JSON","stringify","title","views","max_attendance_length","max_attendance_type","zone","tz","guess","downloadable","checkNextButtonUnlocked","blockedModule","topModules","x","parent_course_module","disabled","prev","fadeOut","fadeIn","expandParentModules","parent_modules_hash","opacity","appendTo","when","then","slideDown","slideUp","originalEvent","$new","direction","$targetLesson","$prev","prevAll","$next","nextAll","click","parentModules","loopModule","course_module","parent_module","reverse","async","eachSeries","moduleId","$module","REGEX_COLLABORATIVE_DISCUSSIONS","REGEX_EXAM_ANSWERS","isCollaborativeDiscuttion","value","isExamAnswer","ajaxSuccess","xhr","settings","phoneMaskBehavior","phoneMaskOptions","onKeyPress","field","options","mask","apply","arguments","page","noteContainer","loadNote","saveNote","note","note_id","$button","buttonLabel","prop","_id","buildCreditCard","creditCard","PagarMe","expiration","cardExpirationMonth","cardExpirationYear","cardHolderName","cardNumber","cardCVV","submitFormCreditCardHash","paymentForm","fieldErrors","hasErrors","console","log","creditCardTest","generateHash","cardHash","submit","pagarmeKey","encryption_key","post","speed","collapsedHeight","moreText","lessText","currHeight","innerHeight","showLink","readmore","moreLink","lessLink","createShortcut","bindKey","isMac","navigator","platform","toUpperCase","bindFunction","character","String","fromCharCode","ctrl","ctrlKey","meta","metaKey","score","handleDrag","handleDrop","clientX","y","clientY","file","dataTransfer","files","URLObj","URL","webkitURL","source","createObjectURL","match","img","createElement","caretPositionFromPoint","pos","range","createRange","setStart","offsetNode","collapse","insertNode","caretRangeFromPoint","updateButtons","bold","queryCommandState","italic","underline","container","$container","$input","$btnAction","registerTriggers","registerDropZone","registerShortcuts","action","execCommand","dropZone","doubtsContainer","expandButton","hideButton","loadMoreButton","loadDoubts","per_page","complete","hide","$btn","time","ready"],"mappings":"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","file":"theme.base.min.js","sourcesContent":["'use strict';\n\n(function () {\n  'use strict';\n\n  window.app = {\n    bindGlobal: function bindGlobal() {\n      FastClick.attach(document.body);\n\n      $('.timeago').timeago();\n\n      $(document).trigger('app:bind:global');\n    },\n\n    bindOpenOnLoad: function bindOpenOnLoad() {\n      var toOpen = $('.js-open-on-load');\n      if (toOpen.length > 0) {\n        $.each(toOpen, function (i, elem) {\n          window.open($(elem).attr('href'));\n        });\n      }\n\n      $(document).trigger('app:bind:open_on_load');\n    },\n\n    bindTooltips: function bindTooltips() {\n      $(\"[data-toggle='tooltip']\").tooltip(\"destroy\").tooltip();\n\n      $(document).trigger('app:bind:tooltips');\n    },\n\n    checkFormValidity: function checkFormValidity(event) {\n      var form = event.currentTarget;\n      var submitButton = $(form).find('button[type=\"submit\"]');\n\n      if (form.checkValidity()) {\n        submitButton.removeAttr('disabled');\n      } else {\n        submitButton.attr('disabled', 'disabled');\n      }\n\n      $(document).trigger('app:bind:check_form_validity');\n    },\n\n    init: function init() {\n      app.pagarme.init();\n\n      app.bindGlobal();\n      app.bindBlazy();\n      app.bindOpenOnLoad();\n      app.bindMasks();\n      app.bindTooltips();\n      app.bindReadMore();\n      app.bindDatepicker();\n      app.bindFixOnScroll();\n      app.ckeditor.bindCkeditor();\n      app.bindCheckout();\n      app.lessonList.init();\n      app.chat.init();\n      app.studentDoubts.init();\n      app.notepad.init();\n      app.categoryList.init();\n      app.bindExamQuestionForm();\n      app.changeTimeZone();\n      app.followBind();\n      app.lessonPage();\n      app.bindPostsForm();\n\n      $(document).on('app:bind:ckeditor_submit', app.bindCollaborativeDiscussion);\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindBlazy = function (e) {\n    new Blazy();\n\n    $(document).trigger('app:bind:blazy');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.categoryList = {\n    init: function init() {\n      var self = this;\n      self.$categoryList = $('#js-category-list');\n\n      if (self.$categoryList.length == 0) return;\n\n      self.isActive = self.$categoryList.data('is-active') || self.isActive;\n\n      if (!self.isActive) {\n        self.bindClicks();\n        self.$categoryList.attr('data-is-active', true);\n        self.isActive = true;\n      }\n\n      self.expandParents();\n    },\n\n    bindClicks: function bindClicks() {\n      var self = this;\n\n      $(document).on('click', '#js-category-list .category-item .toggle-btn', function () {\n        self.expandParent($(this).parent('.category-item'), true);\n      });\n    },\n\n    expandParent: function expandParent($parent, animate) {\n      var $nextListGroup = $parent.find('.list-group').first();\n      var $parentCategoryItem = $parent;\n\n      if (animate) {\n        $nextListGroup.stop().slideToggle('fast');\n      } else {\n        $nextListGroup.stop().toggle();\n      }\n\n      $parentCategoryItem.toggleClass('expanded');\n    },\n\n    expandParents: function expandParents() {\n      var self = this;\n      var $loopItem = self.$categoryList.find('.category-item.current').first();\n\n      while ($loopItem) {\n        self.expandParent($loopItem, false);\n\n        var $parent = $loopItem.parents('.category-item').first();\n\n        if ($parent.length > 0) {\n          $loopItem = $parent;\n        } else {\n          $loopItem = null;\n        }\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.chat = {\n    init: function init() {\n      this.$jsChat = $('.js-chat');\n      this.$text = $('.js-chat-text');\n      this.$messagesContainer = $('.js-chat-messages .js-content');\n\n      if (this.$jsChat.length <= 0) return;\n\n      var self = this;\n\n      self.bindScroll();\n\n      // empty test messages\n      this.$messagesContainer.empty();\n\n      // bind form\n      self.$text.keyup(function (e) {\n        var code = e.keyCode ? e.keyCode : e.which;\n        if (code == 13 && !e.shiftKey) {\n          self.submitMessage(e);\n        }\n      });\n\n      self.loadGroups(self.didLoadGroups);\n      self.loadGeneral(self.didLoadGeneral);\n      self.loadFollowers(self.didLoadFollowers);\n\n      app.simpleEditor.init('#js-send-messages');\n\n      $('#js-send-messages').on('submit', self.submitMessage);\n      $('#js-chat-group-list-item').on('click', self.switchRoom);\n\n      var config = {\n        apiKey: 'AIzaSyD2oUy-240XWPEWmGrh6PqJRaoA4lJFN4s',\n        authDomain: 'edools-chat.firebaseapp.com',\n        databaseURL: 'https://edools-chat.firebaseio.com',\n        projectId: 'edools-chat',\n        storageBucket: 'edools-chat.appspot.com',\n        messagingSenderId: '322321995609'\n      };\n\n      firebase.initializeApp(config);\n      var database = firebase.database();\n      this.messages = database.ref('messages');\n      this.loadMessages();\n    },\n\n    bindScroll: function bindScroll() {\n      var height = this.$jsChat.data('height');\n\n      this.chatHeight = $(window).height() * .8;\n      this.$messagesScrollContainer = this.$jsChat.find('.chat-messages .js-scroll-container');\n      this.$messagesScroll = this.$messagesScrollContainer.find('.js-scroll');\n\n      var $messagesHeader = this.$jsChat.find('.chat-messages .header');\n      var $messagesFooter = this.$jsChat.find('.chat-messages .editor');\n\n      var messagesScrollHeight = this.chatHeight - 42 - ($messagesHeader.height() + $messagesFooter.height());\n\n      this.$jsChat.height(this.chatHeight);\n      this.$messagesScrollContainer.height(messagesScrollHeight);\n\n      this.$jsChat.find('.js-sidebar-scroll').scrollbar({});\n      this.$messagesScroll.scrollbar({});\n    },\n\n    loadMessages: function loadMessages() {\n      var setMessage = function (data) {\n        this.insertMessage(data.val());\n      }.bind(this);\n\n      this.messages.limitToLast(12).on('child_added', setMessage);\n      this.messages.limitToLast(12).on('child_changed', setMessage);\n    },\n\n    sanitizeHtml: function sanitizeHtml($root) {\n      $root.find('div:empty').remove();\n\n      // Removes elements with only '<br/>' children\n      $root.children().each(function (i, el) {\n        var $el = $(el);\n        if (el.tagName != 'BR' && $el.find('br').length > 0 && $el.find('br').length == $el.children().length) {\n          $el.remove();\n        }\n      });\n\n      // Removes last '<br/>'\n      if ($root.last().get(0).tagName == 'BR') {\n        $root.last().remove();\n      }\n\n      return $root;\n    },\n\n    submitMessage: function submitMessage(event) {\n      event.preventDefault();\n\n      var $html = this.sanitizeHtml(this.$text);\n      var text = $html.html();\n\n      if (text.length <= 0) return;\n\n      this.$text.html('').focus();\n\n      function pad(n) {\n        return n < 10 ? \"0\" + n : n;\n      }\n\n      var date = new Date();\n      var user = $(\"#school-header\").first().data('user');\n\n      app.chat.messages.push({\n        id: user.id,\n        name: user.name,\n        avatar_url: user.avatar_url,\n        text: text,\n        timestamp: moment().unix(),\n        schedule: pad(date.getHours()) + ':' + pad(date.getMinutes())\n      });\n    },\n\n    insertMessage: function insertMessage(data) {\n      var self = this;\n      var html = self.renderTemplate('chat-message', {\n        avatar: data.avatar_url,\n        name: data.name,\n        text: data.text,\n        schedule: data.schedule\n      });\n\n      self.$messagesContainer.append(html);\n      self.$messagesScroll.scrollTop(self.$messagesScroll[0].scrollHeight);\n    },\n\n    renderTemplate: function renderTemplate(key, data) {\n      var liquid = $('#' + key + '-template').html();\n      var template = Liquid.parse(liquid);\n\n      return template.render(data);\n    },\n\n    loadGroups: function loadGroups(callback) {\n      var apiKey = $('#js-chat-page').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/groups',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    loadGeneral: function loadGeneral(callback) {\n      var apiKey = $('#js-chat-page').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/general',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    loadFollowers: function loadFollowers(callback) {\n      var apiKey = $('#js-chat-page').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/followers',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    didLoadGroups: function didLoadGroups(groups) {\n      var groupTemplate = $(\"#js-chat-group-list-item\").html();\n\n      groups.forEach(function (group) {\n        var $template = $(groupTemplate);\n\n        // set group name\n        $('#js-chat-group-name', $template).html(group.name);\n\n        // set users count\n        var $usersCont = $('#js-chat-group-users-count', $template);\n        $usersCont.html(group.users_count + $usersCont.html());\n\n        // append to group list\n        $('.js-groups').append($template);\n      });\n    },\n\n    didLoadGeneral: function didLoadGeneral(users) {\n      var self = app.chat;\n      self.addProfileItems(users, 'js-team');\n    },\n\n    didLoadFollowers: function didLoadFollowers(users) {\n      var self = app.chat;\n      self.addProfileItems(users, 'js-students');\n    },\n\n    addProfileItems: function addProfileItems(users, divClass) {\n      var profileTemplate = $(\"#js-chat-profile-list-item\").html();\n\n      users.forEach(function (user) {\n        var $template = $(profileTemplate);\n\n        var $avatar = $('<img />').addClass('animated').attr('src', user.cover_image_url);\n        $('.avatar', $template).append($avatar);\n\n        $('.name', $template).html(user.first_name + ' ' + user.last_name);\n        $('.location', $template).html(\"Niterói - Rio de Janeiro\");\n\n        if (user.status && user.last_seen) {\n          $('.status', $template).html(\"Niterói - Rio de Janeiro\");\n        }\n\n        $('.' + divClass).append($template);\n      });\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCheckout = function () {\n    $('#js-terms-of-use-check').change(function () {\n      if ($(this).is(\":checked\") === true) {\n        $('.cta-checkout-cart').removeClass('disabled');\n      } else {\n        $('.cta-checkout-cart').addClass('disabled');\n      }\n    });\n\n    $(document).trigger('app:bind:checkout');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.ckeditor = {\n    bindCkeditor: function bindCkeditor() {\n      var src = '//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js';\n\n      if ($('.js-ckeditor').length) {\n        loadAsset('window.CKEDITOR', src, function () {\n          var config = {\n            language: 'pt-br',\n            skin: 'bootstrapck'\n          };\n\n          $('.js-ckeditor').each(function (index, ckeditorObj) {\n            if (!$('#cke_' + ckeditorObj.id).length) {\n              config.placeholder = ckeditorObj.placeholder; // TODO: fix it\n\n              CKEDITOR.replace(ckeditorObj.id, config);\n            }\n          });\n\n          app.ckeditor.bindCkeditorSubmit();\n          $(document).trigger('app:bind:ckeditor');\n        });\n      }\n    },\n\n    bindCkeditorSubmit: function bindCkeditorSubmit() {\n      $.each($('.js-ckeditor'), function (index, editor) {\n        var $editor = $(editor);\n        var $form = $editor.parents('form');\n        var editorId = $editor.attr('id');\n\n        if ($form) {\n          var $submitButton = $form.find('button[type=\"submit\"]');\n\n          CKEDITOR.instances[editorId].on('change', function () {\n            if (this.getData().length) {\n              $submitButton.attr('disabled', false);\n            } else {\n              $submitButton.attr('disabled', true);\n            }\n          });\n        }\n      });\n\n      $(document).trigger('app:bind:ckeditor_submit');\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCollaborativeDiscussion = function () {\n    $(document).on('click', '#collaborative-discussion .js-edit-button', function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').addClass('hide');\n      $comment.find('.js-edit-container').removeClass('hide');\n    });\n\n    $(document).on('click', '#collaborative-discussion .js-cancel-button', function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').removeClass('hide');\n      $comment.find('.js-edit-container').addClass('hide');\n    });\n\n    $(document).trigger('app:bind:collaborative_discussion');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindDatepicker = function () {\n    // TODO: Handle i18n\n    $.fn.datepicker.defaults.language = 'pt-BR';\n\n    $('.datepicker').each(function (i, el) {\n      var $el = $(el);\n      var $hidden = $('<input type=\"hidden\" />').insertBefore($el.parent());\n      var frontDate = moment($el.val()).utc().format('DD/MM/YYYY');\n      var serverDate = moment($el.val()).utc().format('YYYY-MM-DD');\n      serverDate = serverDate === 'Invalid date' ? null : serverDate;\n\n      $hidden.attr('id', $el.attr('id'));\n      $hidden.attr('name', $el.attr('name'));\n      $hidden.attr('value', serverDate);\n\n      $el.removeAttr('id');\n      $el.removeAttr('name');\n\n      if ($el.val() !== \"\") {\n        $el.val(frontDate);\n      }\n\n      $(el).datepicker().on('change', function () {\n        var date = moment($el.val(), 'DD/MM/YYYY').utc().format('YYYY-MM-DD');\n        date = date === 'Invalid date' ? null : date;\n        $hidden.val(date);\n      });\n    });\n\n    $(document).trigger('app:bind:datepicker');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindExamQuestionForm = function () {\n    $(document).on('click', '#js-remake-exam', function () {\n      $('#answers-container').addClass('hide');\n      $('#form-container').removeClass('hide');\n    });\n\n    $(document).on('click', '.js-clean-associative-options', function () {\n      $(this).parents('.associative-question').find('.js-associative-select option:selected').removeAttr('selected');\n    });\n\n    $(document).on('change', '.js-associative-select', function () {\n      var $question = $(this).parents('.associative-question');\n      var optionIndex = $(this).data('option-index');\n      var assertionId = $(this).find('option:selected').data('first-assertion-id');\n\n      $question.find('.js-associate-assertion[data-option-index=\"' + optionIndex + '\"]').val(assertionId);\n    });\n\n    // bind all form's inputs\n    $(document).on('change', '#exam_answer_form', app.checkFormValidity);\n    // bind all form's textareas for all types of typing\n    $(document).on('input propertychange', '#exam_answer_form', app.checkFormValidity);\n\n    $(document).trigger('app:bind:bind_exam_question_form');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindFixOnScroll = function () {\n    $('.js-fix-on-scroll').each(function (i, el) {\n      if (!$(el).hasClass('js-fix-on-scroll-mobile') && window.innerWidth < 992) {\n        return;\n      }\n\n      var $el = $(el);\n      $el.wrap('<div class=\"js-fix-scroll-wrapper\"/>');\n      var $wrapper = $el.parent('.js-fix-scroll-wrapper');\n\n      var offset = $el.offset();\n      var size = {\n        width: $el.outerWidth(),\n        height: $el.outerHeight()\n      };\n\n      $wrapper.width(size.width);\n      $wrapper.height(size.height);\n\n      $(document).on('scroll', function (e) {\n        var scrollTop = $(document).scrollTop();\n\n        if (scrollTop >= offset.top) {\n          if ($el.css('position') === 'fixed') return;\n\n          $el.parent().addClass('scroll');\n          $el.addClass('scroll');\n          $el.css({\n            position: 'fixed',\n            left: offset.left,\n            top: 0,\n            width: size.width,\n            height: size.height,\n            'z-index': '10000'\n          });\n        } else {\n          if ($el.css('position') === 'static') return;\n\n          $el.removeClass('scroll');\n          $el.parent().removeClass('scroll');\n          $el.css({\n            position: 'static',\n            left: 'auto',\n            top: 'auto',\n            width: 'auto',\n            height: 'auto'\n          });\n        }\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.followBind = function () {\n    $(document).on({\n      mouseenter: function mouseenter() {\n        $(this).addClass('hidden');\n        $('#js-unfollow').removeClass('hidden');\n      }\n    }, '#js-following');\n\n    $(document).on({\n      mouseleave: function mouseleave() {\n        $('#js-following').removeClass('hidden');\n        $(this).addClass('hidden');\n      }\n    }, '#js-unfollow');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.lessonList = {\n    init: function init() {\n      var self = this;\n\n      self.courseTreeExists = self.courseTree().length;\n      self.isActive = self.courseTree().data('is-active');\n      self.course = self.courseTree().data('course');\n      self.enrollment = self.courseTree().data('enrollment');\n      self.courseContent = self.courseTree().data('course-content');\n      self.userType = self.courseTree().data('user-type');\n      self.lessonActions = self.courseTree().data('lesson-actions');\n      self.downloadAction = self.courseTree().data('download-action');\n      self.currentLessonId = parseInt(self.courseTree().data('current-lesson-id'));\n      self.apiKey = self.courseTree().data('api-key');\n\n      self.translations = {};\n      self.translations['lesson.release_at'] = self.courseTree().data('translation-release-at');\n      self.translations['lesson.release_after'] = self.courseTree().data('translation-release-after');\n      self.translations['product.course_content.views'] = self.courseTree().data('translation-course_content-views');\n\n      if (self.courseTreeExists && !self.isActive) {\n        self.bindClicks();\n        self.handleLessons();\n        self.loadTopModules();\n        self.bindChangeLesson();\n\n        $(document).trigger('app:bind:lesson_sidebar');\n\n        $(document).on('lesson-completed', function (event, lessonProgress) {\n          var $mediaControls = $('.btn-next-lesson');\n          var enrollmentId = lessonProgress.data.enrollment_id;\n\n          if ($mediaControls.size() > 0) {\n            $mediaControls.removeClass('disabled');\n          }\n\n          app.lessonList.requirementsExists(lessonProgress.data, function ($item, content_id) {\n            if (content_id) {\n              app.lessonList.checkLessonCompleted(enrollmentId, content_id, function (completed) {\n                if (completed) {\n                  $item.removeClass('blocked');\n                  $item.find('.right > .icon-lock').remove();\n                }\n              });\n            }\n          });\n        });\n      }\n    },\n\n    // Props\n\n    courseTree: function courseTree() {\n      return $('.course-content #js-course-tree-ajax');\n    },\n\n    lazyLoadButtons: function lazyLoadButtons() {\n      return $('.course-content #js-course-content-more-link, .course-content #js-course-content-prev-link');\n    },\n\n    lessons: function lessons() {\n      return this.courseTree().find('.js-content');\n    },\n\n    currentLesson: function currentLesson() {\n      return $(this.courseTree().find('.js-content.active')[0]);\n    },\n\n    toggleButton: function toggleButton() {\n      return $('.lesson-list-toggle .btn');\n    },\n\n    lessonListPanel: function lessonListPanel() {\n      return $('.lesson-list-panel');\n    },\n\n    requirementsExists: function requirementsExists(lessonProgress, cb, cbNotExists) {\n      if (!lessonProgress) {\n        return false;\n      }\n\n      var requirementsElements = $('.lesson-list-panel [data-requirements]').filter(function (index, item) {\n        return $(item).data('requirements').length > 0;\n      });\n\n      var requirementsUnified = requirementsElements.map(function (idx, item) {\n        return {\n          item: $(item),\n          requirements: $(item).data('requirements')\n        };\n      }).toArray();\n\n      var exists = _.find(requirementsUnified, { requirements: [{ content_id: lessonProgress.lesson_id }] });\n\n      if (exists) {\n        var $item = exists.item;\n        if (cb) {\n          return cb($item, lessonProgress.lesson_id);\n        }\n      } else {\n        if (cbNotExists) {\n          return cbNotExists();\n        }\n      }\n    },\n\n    checkLessonCompleted: function checkLessonCompleted(enrollmentId, id, cb) {\n      var self = this;\n      var completed = false;\n      var apiKey = $('.course-content #js-course-tree-ajax').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/enrollments/' + enrollmentId + '/lessons_progresses?lesson_id=' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        completed = data.lessons_progresses[0].completed;\n\n        cb(completed);\n      });\n    },\n\n    // Actions\n    bindChangeLesson: function bindChangeLesson() {\n      var self = this;\n\n      if (!self.bindChangeLessonActive) {\n        self.bindChangeLessonActive = true;\n        var course_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+$/;\n        var lesson_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+\\/course_contents\\/\\d+$/;\n\n        $(document).on(\"ready page:load\", function (e) {\n          var path = window.location.pathname;\n          var lesson_path = lesson_path_regex.test(path);\n\n          if (course_path_regex.test(path) || lesson_path) {\n            self.lessons().removeClass('active');\n\n            if (lesson_path) {\n              var path_array = path.split('/');\n              var content_id = path_array[path_array.length - 1];\n\n              $(\"#content-\" + content_id + \".js-content\").addClass('active');\n            }\n          }\n        });\n      }\n    },\n\n    bindClicks: function bindClicks() {\n      var self = this;\n\n      self.lessons().find('a').on('click', function (e) {\n        e.preventDefault();\n        app.lessonList.changeLesson(null, $(this).parents('.js-content'));\n      });\n\n      self.courseTree().on('click', '.module', function (e) {\n        if (!$(e.target).hasClass('module') && !$(e.target).parent().hasClass('module')) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        self.loadChildren($(this));\n      });\n\n      self.courseTree().data('is-active', true);\n\n      self.toggleButton().on('click', this.toggleSidebar);\n    },\n\n    getLessonIcon: function getLessonIcon(lesson) {\n      var lessonIcon = '';\n\n      if (lesson.type == 'ExamLesson' && lesson.activity) {\n        switch (lesson.activity.type) {\n          case 'Quiz':\n            {\n              lessonIcon = 'icon-puzzle';\n              break;\n            }\n          case 'FileUpload':\n            {\n              lessonIcon = 'icon-arrow-up-circle';\n              break;\n            }\n          case 'CollaborativeDiscussion':\n            {\n              lessonIcon = 'icon-people';\n              break;\n            }\n          default:\n            {\n              lessonIcon = 'icon-puzzle';\n            }\n        }\n      } else if (lesson.media) {\n        switch (lesson.media) {\n          case 'Video':\n            {\n              lessonIcon = 'icon-camrecorder';\n              break;\n            }\n          case 'Audio':\n            {\n              lessonIcon = 'icon-microphone';\n              break;\n            }\n          case 'Slide':\n            {\n              lessonIcon = 'icon-chart';\n              break;\n            }\n          case 'Document':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'Image':\n            {\n              lessonIcon = 'icon-picture';\n              break;\n            }\n          case 'Text':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'LiveStream':\n            {\n              lessonIcon = 'icon-control-play';\n              break;\n            }\n          case 'VideoSlide':\n            {\n              lessonIcon = 'icon-film';\n              break;\n            }\n          case 'ScormPackage':\n            {\n              lessonIcon = 'icon-layers';\n              break;\n            }\n          case 'Html':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          default:\n            {\n              lessonIcon = 'icon-camrecorder';\n            }\n\n        }\n      }\n\n      return lessonIcon;\n    },\n\n    getContentPath: function getContentPath(content) {\n      var self = this;\n\n      var enrollmentId = self.enrollment.id;\n      var courseId = self.course.id;\n\n      var path = enrollmentId ? '/enrollments/' + enrollmentId : '/admin_view';\n      path = path + '/courses/' + courseId + '/course_contents/' + content.id;\n\n      return path;\n    },\n\n    getContentDownloadPath: function getContentDownloadPath(content) {\n      var self = this;\n      return self.getContentPath(content) + '/download';\n    },\n\n    checkLessonAvailability: function checkLessonAvailability(lesson) {\n      var releaseAt = lesson.release_at;\n      var releaseAfter = lesson.release_after;\n\n      if (!releaseAt && !releaseAfter) {\n        return true;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at);\n\n      var releaseTime = releaseAt ? moment(releaseAt) : enrollmentActivatedAt.add(releaseAfter, 'days');\n\n      return moment() > releaseTime;\n    },\n\n    checkTrialByType: function checkTrialByType(type) {\n      var $tree = $('#js-course-tree-ajax');\n      var $enrollment = $tree.data('enrollment');\n      var constrains_name = 'trial_' + type + '_ids';\n\n      var payment_method = $enrollment.payment_method;\n      var constrains_tree = $tree.data('school-product').trial_constrains;\n      var constrains = constrains_tree[payment_method];\n\n      if (constrains && !constrains.hasOwnProperty(constrains_name)) {\n        return false;\n      }\n\n      if (!$enrollment['on_trial?']) {\n        return function () {\n          return false;\n        };\n      }\n\n      return function (id) {\n        if (constrains_tree && constrains[constrains_name]) {\n          return constrains[constrains_name].indexOf(id) > -1;\n        }\n      };\n    },\n\n    fetchModules: function fetchModules($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var modules = _.sortBy(res.course_modules, 'order');\n\n          modules = _.filter(modules, function (m) {\n            var module = _.find(self.allModules, { id: m.id });\n            return module.available != false && (module.course_content_ids.length > 0 || module.course_modules.length > 0);\n          });\n\n          var $modules = _.map(modules, function (module) {\n            return $('<li class=\"list-group-item module\" ' + 'data-id=\"' + module.id + '\"' + 'data-level=\"' + (level + 1) + '\">' + '<i class=\"icon icon-arrow-right\"></i>' + '<span>' + module.name + '</span>' + '<i class=\"busy busy-xs\"></i>' + '</li>');\n          });\n\n          $list.append($modules);\n        }\n      });\n    },\n\n    fetchChildren: function fetchChildren($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id + '/course_contents',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var blockedContent = self.checkTrialByType('content');\n          var courseContents = _.filter(res.course_contents, function (lesson) {\n            return lesson.available != false;\n          });\n\n          courseContents = _.sortBy(courseContents, 'order');\n\n          if (self.enrollment) {\n            courseContents = _.map(courseContents, function (content) {\n              content.completed = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(content.lesson.id) > -1;\n              return content;\n            });\n          }\n\n          var $courseContents = _.map(courseContents, function (content) {\n            var active = self.currentLessonId == content.lesson.id ? 'active js' : '';\n            var lesson = content.lesson;\n            var lessonIcon = self.getLessonIcon(lesson);\n            var hideInProgressIcon = 'hide';\n            var hideCompletedIcon = 'hide';\n            var lessonReleased = null;\n            var releaseType = null;\n            var releaseDate = null;\n            var progress = null;\n            var requirements = content.requirements;\n            var available = true;\n            var requirements_ids = requirements.map(function (item) {\n              return item.content_id;\n            });\n\n            if (self.enrollment) {\n              lessonReleased = self.checkLessonAvailability(lesson);\n\n              if (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(lesson.id) > -1) {\n                hideInProgressIcon = 'hide';\n                hideCompletedIcon = null;\n              } else {\n                if (self.enrollment.lessons_info && self.enrollment.lessons_info.in_progress.indexOf(lesson.id) > -1) {\n                  hideInProgressIcon = null;\n                  hideCompletedIcon = 'hide';\n                } else {\n                  hideInProgressIcon = 'hide';\n                  hideCompletedIcon = 'hide';\n                }\n              }\n\n              if (lesson.release_at) {\n                releaseType = 'release_at';\n                releaseDate = lesson.release_at;\n              } else if (lesson.release_after) {\n                releaseType = 'release_after';\n                releaseDate = moment(self.enrollment.activated_at).add(lesson.release_after, 'days');\n              }\n\n              if (self.lessonActions) {\n                progress = _.find(self.enrollment.lessons_progresses, { lesson_id: lesson.id });\n              }\n            }\n\n            if (self.enrollment) {\n              _.each(requirements_ids, function (id) {\n                var exists = _.find(courseContents, { content_id: id, completed: true });\n\n                if (!exists) {\n                  available = false;\n                }\n              });\n            }\n\n            var html = '<li class=\"list-group-item content-lesson js-content list-group-item lesson module-item ' + active + (!available || blockedContent(content.id) ? ' blocked' : '') + '\" ' + 'id=\"content-' + content.id + '\" ' + 'data-requirements=\\'' + JSON.stringify(requirements) + '\\'' + 'data-id=\"' + content.lesson.id + '\"' + 'data-level=\"1\">' + '<div id=\"lesson-' + lesson.id + '\" class=\"js-lesson content-lesson ' + active + (!lessonReleased ? ' not-released' : '') + '\" data-lesson-id=\"' + lesson.id + '\">' + '<div class=\"class-info\">' + '<div class=\"left\"><i class=\"' + lessonIcon + '\"></i></div>' + '<div class=\"center\">' + (self.lessonActions && lessonReleased ? '<a class=\"lesson-title\" href=\"' + self.getContentPath(content) + '\"><span>' + lesson.title + '</span></a>' : '<span class=\"lesson-title\"><span class=\"disabled\">' + lesson.title + '</span></span>') + '</div>' + '<div class=\"right\">' + (!available || blockedContent(content.id) ? '<i class=\"icon-lock\"></i>' : '') + '<span class=\"progress-icon js-progress-icons\">' + '<i class=\"icon-check js-completed-icon ' + hideCompletedIcon + '\"></i>' + '<i class=\"icon-clock js-in-progress-icon ' + hideInProgressIcon + '\"></i>' + '</span>';\n\n            if (self.lessonActions) {\n              if (progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts') {\n                html += '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + self.translations['product.course_content.views'] + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' + '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' + '</span>';\n              }\n\n              if (!lessonReleased) {\n                var zone = moment.tz.guess();\n                html += '<span class=\"release-date badge\">' + self.translations['lesson.' + releaseType] + '<span> ' + moment.tz(releaseDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n              }\n\n              if (self.downloadAction && content.downloadable) {\n                html += '<a class=\"download-link\" href=\"' + self.getContentDownloadPath(content) + '\" data-no-turbolink>' + '<i class=\"icon-cloud-download\"></i>' + '</a>';\n              }\n            }\n\n            html += '</div>' + '</div>' + '</li>';\n\n            return $(html);\n          });\n\n          $list.append($courseContents);\n          self.checkNextButtonUnlocked();\n        }\n      });\n    },\n\n    checkNextButtonUnlocked: function checkNextButtonUnlocked() {\n      var lessonProgress = $('#js-course-tree-ajax').data('lesson-progress');\n\n      app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n        if (content_id && lessonProgress.hasOwnProperty('enrollment_id')) {\n          app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n            if (completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n              $item.removeClass('blocked');\n              $item.find('.right > .icon-lock').remove();\n            }\n          });\n        }\n      }, function () {\n        $('.btn-next-lesson').removeClass('disabled');\n      });\n    },\n\n    loadTopModules: function loadTopModules() {\n      var self = this;\n\n      if (!self.course) return;\n\n      $.ajax({\n        url: window.CORE_HOST + '/courses/' + self.course.id + '/course_modules',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var blockedModule = self.checkTrialByType('module');\n          if (!res.course_modules || res.course_modules.length <= 0) return;\n\n          self.allModules = res.course_modules;\n\n          self.topModules = _.filter(res.course_modules, function (x) {\n            return x.parent_course_module == null && x.available != false && (x.course_content_ids.length > 0 || x.course_modules.length > 0);\n          });\n\n          self.topModules = _.sortBy(self.topModules, 'order');\n\n          var $modules = _.map(self.topModules, function (module) {\n            var disabled = blockedModule(module.id);\n\n            return $('<li class=\"list-group-item module ' + (disabled ? 'disabled' : '') + '\" ' + 'data-id=\"' + module.id + '\"' + 'data-level=\"1\">' + '<i class=\"icon icon-arrow-right\"></i>' + '<span>' + module.name + '</span>' + '<i class=\"busy busy-xs\"></i>' + '</li>');\n          });\n\n          self.courseTree().prev('.course-content-busy').fadeOut('fast', function () {\n            self.courseTree().css('display', 'none');\n            self.courseTree().html($modules);\n            self.courseTree().fadeIn('fast');\n\n            if (self.courseContent) {\n              self.expandParentModules(self.courseContent.parent_modules_hash);\n            }\n          });\n        }\n      });\n    },\n\n    loadChildren: function loadChildren(parent, cb) {\n      var self = this;\n      var $parent = $(parent);\n\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      if ($list.length <= 0) {\n        $parent.find('.busy').css({ opacity: 1 });\n        $list = $('<ul class=\"list-group\" style=\"display: none;\"></ul>');\n        $list.appendTo($parent);\n\n        $.when(self.fetchModules($parent), self.fetchChildren($parent)).then(function () {\n          $parent.addClass('expanded');\n          $parent.find('.busy').css({ opacity: 0 });\n\n          $list.slideDown('fast');\n\n          if (typeof cb == 'function') {\n            cb();\n          }\n        });\n      } else {\n        if ($parent.hasClass('expanded')) {\n          $parent.removeClass('expanded');\n          $list.slideUp('fast');\n        } else {\n          $parent.addClass('expanded');\n          $list.slideDown('fast');\n        }\n\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    },\n\n    handleLessons: function handleLessons() {\n      $(document).on('page:load page:restore', function (e) {\n\n        if (!e.originalEvent || !e.originalEvent.data || e.originalEvent.data.length == 0) return;\n\n        var $html = $(e.originalEvent.data[0]);\n        app.lessonList.lessons().each(function (i, el) {\n          var $el = $(el);\n          var $new = $html.find('#' + $el.attr('id'));\n          $el.html($new.html());\n        });\n      });\n    },\n\n    changeLesson: function changeLesson(direction, lesson) {\n      var $targetLesson = $(lesson);\n\n      if (direction == 'prev') {\n        var $prev = app.lessonList.currentLesson().prevAll('.js-content');\n\n        if ($prev.length > 0 && $prev.find('a').length > 0) $targetLesson = $($prev[0]);\n      } else if (direction == 'next') {\n        var $next = app.lessonList.currentLesson().nextAll('.js-content');\n\n        if ($next.length > 0 && $next.find('a').length > 0) $targetLesson = $($next[0]);\n      }\n\n      $targetLesson.find('a')[0].click();\n    },\n\n    expandParentModules: function expandParentModules(parentModules) {\n      var self = this;\n\n      var modules = [];\n      var loopModule = parentModules.course_module;\n      modules.push(loopModule.id);\n\n      while (loopModule.parent_module) {\n        loopModule = loopModule.parent_module;\n        modules.push(loopModule.id);\n      }\n\n      modules = modules.reverse();\n\n      async.eachSeries(modules, function (moduleId, cb) {\n        var $module = $('.module[data-id=\"' + moduleId + '\"]');\n        self.loadChildren($module, cb);\n      });\n    },\n\n    toggleSidebar: function toggleSidebar() {\n      app.lessonList.toggleButton().toggleClass('active');\n      app.lessonList.lessonListPanel().toggleClass('active');\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.lessonPage = function () {\n    var REGEX_COLLABORATIVE_DISCUSSIONS = /\\/collaborative_discussions\\/([0-9]+)\\/collaborative_comments/;\n    var REGEX_EXAM_ANSWERS = /\\/exam_answers/;\n\n    var isCollaborativeDiscuttion = function isCollaborativeDiscuttion(value) {\n      return REGEX_COLLABORATIVE_DISCUSSIONS.test(value);\n    };\n\n    var isExamAnswer = function isExamAnswer(value) {\n      return REGEX_EXAM_ANSWERS.test(value);\n    };\n\n    $(document).ajaxSuccess(function (event, xhr, settings) {\n\n      if (isCollaborativeDiscuttion(settings.url) || isExamAnswer(settings.url)) {\n\n        var lessonProgress = $('#js-course-tree-ajax').data('lesson-progress');\n\n        app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n          if (content_id && lessonProgress.hasOwnProperty('enrollment_id')) {\n            app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n              if (completed) {\n                $('.btn-next-lesson').removeClass('disabled');\n                $item.removeClass('disabled');\n                $item.find('.right > .icon-lock').remove();\n              }\n            });\n          }\n        }, function () {\n          $('.btn-next-lesson').removeClass('disabled');\n        });\n      }\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindMasks = function () {\n    var phoneMaskBehavior = function phoneMaskBehavior(val) {\n      return val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n    };\n\n    var phoneMaskOptions = {\n      onKeyPress: function onKeyPress(val, e, field, options) {\n        field.mask(phoneMaskBehavior.apply({}, arguments), options);\n      }\n    };\n\n    $('#user-phone').mask(phoneMaskBehavior, phoneMaskOptions);\n    $('#user-cpf').mask('999.999.999-99');\n    $('#user-cep').mask('99.999-999');\n\n    $(document).trigger('app:bind:masks');\n  };\n})();\n\napp.notepad = {\n  page: 1,\n\n  noteContainer: function noteContainer() {\n    return $('#notepad-container');\n  },\n\n  form: function form() {\n    return $('#js-notepad-form');\n  },\n\n  loadNote: function loadNote(lesson_id, cb) {\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'GET',\n      success: function success() {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  saveNote: function saveNote(cb) {\n    var note = $(\"#js-note\").html();\n    var note_id = $(\"#js_note_id\").val();\n\n    var $button = $(\"#save_notepad_button\");\n    var buttonLabel = $button.html();\n    $button.html($button.data(\"sending\"));\n    $button.prop('disabled', true);\n\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'POST',\n      data: {\n        _id: note_id,\n        note: note\n      },\n      success: function success() {\n        $button.html(buttonLabel);\n        $button.prop('disabled', false);\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function init() {\n    var self = this;\n    if (this.noteContainer().length <= 0) return;\n    this.loadNote($(\"#lesson_id\").val());\n\n    $(\"#notepad_form\").on('submit', function (event) {\n      event.preventDefault();\n      self.saveNote();\n    });\n  }\n};\n\n(function () {\n  'use strict';\n\n  app.pagarme = {\n    buildCreditCard: function buildCreditCard() {\n      var creditCard = new PagarMe.creditCard();\n      var expiration = $(\"#card-form #card-expiration\").val().split('/');\n\n      creditCard.cardExpirationMonth = parseInt(expiration[0]);\n      creditCard.cardExpirationYear = parseInt(expiration[1]);\n      creditCard.cardHolderName = $(\"#card-form #card-holder-name\").val();\n      creditCard.cardNumber = $(\"#card-form #card-number\").val();\n      creditCard.cardCVV = $(\"#card-form #card-cvc\").val();\n\n      return creditCard;\n    },\n\n    submitFormCreditCardHash: function submitFormCreditCardHash(paymentForm) {\n      var creditCard = app.pagarme.buildCreditCard();\n      var fieldErrors = creditCard.fieldErrors();\n      var hasErrors = false;\n      for (var field in fieldErrors) {\n        hasErrors = true;break;\n      }\n\n      console.log(1);\n      window.creditCardTest = creditCard;\n\n      if (hasErrors) {\n        window.fieldErrors = fieldErrors;\n\n        console.log(window.fieldErrors);\n      } else {\n        creditCard.generateHash(function (cardHash) {\n          $('#card_hash').val(cardHash);\n\n          paymentForm.get(0).submit();\n        });\n      }\n    },\n\n    init: function init() {\n      var src = 'https://assets.pagar.me/js/pagarme.min.js',\n          paymentForm = $('#card-form'),\n          pagarmeKey = $(\"#pagarme\").val();\n\n      if (paymentForm.length && pagarmeKey) {\n        loadAsset('PagarMe', src, function () {\n          PagarMe.encryption_key = pagarmeKey;\n\n          paymentForm.submit(function (event) {\n            event.preventDefault();\n\n            app.pagarme.submitFormCreditCardHash(paymentForm);\n          });\n\n          $(document).trigger('app:bind:pagarme');\n        });\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindPostsForm = function () {\n    $(document).on('click', '.js-post-edit', function () {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').addClass('hidden');\n      post.find('.js-post-form').removeClass('hidden');\n    });\n\n    $(document).on('click', '.js-post-cancel', function (e) {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').removeClass('hidden');\n      post.find('.js-post-form').addClass('hidden');\n    });\n\n    $(document).trigger('app:bind:bind_posts_form');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindReadMore = function () {\n    $('[role=\"readmore\"]').each(function (i, el) {\n      var speed = $(el).data('speed') || 100;\n      var collapsedHeight = $(el).data('collapsed-height') || 200;\n      var moreText = $(el).data('more-text') || 'Leia Mais';\n      var lessText = $(el).data('less-text') || 'Fechar';\n\n      var currHeight = $(el).innerHeight();\n      var showLink = currHeight <= collapsedHeight;\n\n      $(el).readmore({\n        speed: speed,\n        collapsedHeight: collapsedHeight,\n        moreLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + moreText + '</a>',\n        lessLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + lessText + '</a>'\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.simpleEditor = {\n\n    createShortcut: function createShortcut(bindKey, callback) {\n      var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n      var bindFunction = function bindFunction(e) {\n        var character = String.fromCharCode(e.keyCode);\n        var ctrl = e.ctrlKey;\n        var meta = !!e.metaKey;\n        var score = 0;\n\n        if (isMac && meta) {\n          score++;\n        } else if (ctrl) {\n          score++;\n        }\n\n        if (character == bindKey) {\n          score++;\n        }\n\n        if (score == 2) {\n          e.stopPropagation();\n          e.preventDefault();\n          return callback();\n        }\n      };\n\n      $('body').bind('keydown', bindFunction);\n    },\n\n    handleDrag: function handleDrag(e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n\n    handleDrop: function handleDrop(e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var x = e.clientX;\n      var y = e.clientY;\n      var file = e.dataTransfer.files[0];\n\n      var URLObj = window.URL || window.webkitURL;\n      var source = URLObj.createObjectURL(file);\n\n      if (file.type.match('image.*')) {\n\n        var img = document.createElement(\"img\");\n\n        img.src = source;\n\n        if (document.caretPositionFromPoint) {\n          var pos = document.caretPositionFromPoint(x, y);\n          range = document.createRange();\n          range.setStart(pos.offsetNode, pos.offset);\n          range.collapse();\n          range.insertNode(img);\n        } else if (document.caretRangeFromPoint) {\n          range = document.caretRangeFromPoint(x, y);\n          range.insertNode(img);\n        }\n      }\n    },\n\n    updateButtons: function updateButtons() {\n      var bold = document.queryCommandState(\"Bold\");\n      var italic = document.queryCommandState(\"Italic\");\n      var underline = document.queryCommandState(\"Underline\");\n\n      if (bold === true) {\n        $('[data-action=bold]').addClass('active');\n      } else {\n        $('[data-action=bold]').removeClass('active');\n      }\n\n      if (italic === true) {\n        $('[data-action=italic]').addClass('active');\n      } else {\n        $('[data-action=italic]').removeClass('active');\n      }\n\n      if (underline === true) {\n        $('[data-action=underline]').addClass('active');\n      } else {\n        $('[data-action=underline]').removeClass('active');\n      }\n    },\n\n    init: function init(container) {\n      this.$container = $(container);\n\n      this.$input = this.$container.find('.js-input');\n      this.$btnAction = this.$container.find('.js-btn-action');\n\n      this.registerTriggers();\n      this.registerDropZone();\n      this.registerShortcuts();\n    },\n\n    registerTriggers: function registerTriggers() {\n      var self = this;\n\n      self.$btnAction.on('click', function () {\n        var action = $(this).attr('data-action');\n        document.execCommand(action);\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('click', function () {\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('focusin', function () {\n        self.$container.addClass('focused');\n      });\n\n      self.$input.on('focusout', function () {\n        self.$container.removeClass('focused');\n      });\n    },\n\n    registerDropZone: function registerDropZone() {\n      var dropZone = $(this.container).find('.js-input');\n      dropZone.on('dragover', app.simpleEditor.handleDrag, false);\n      dropZone.on('drop', app.simpleEditor.handleDrop, false);\n    },\n\n    registerShortcuts: function registerShortcuts() {\n\n      app.simpleEditor.createShortcut('U', function () {\n        document.execCommand('underline');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('B', function () {\n        document.execCommand('bold');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('I', function () {\n        document.execCommand('italic');\n        app.simpleEditor.updateButtons();\n      });\n    }\n  };\n})();\n\napp.studentDoubts = {\n  page: 1,\n\n  doubtsContainer: function doubtsContainer() {\n    return $('#js-doubts-container');\n  },\n\n  form: function form() {\n    return $('#js-student-doubts-form');\n  },\n\n  expandButton: function expandButton() {\n    return $('#js-expand-student-doubts-form');\n  },\n\n  hideButton: function hideButton() {\n    return $('#js-hide-student-doubts-form');\n  },\n\n  loadMoreButton: function loadMoreButton() {\n    return $('#js-load-more-doubts');\n  },\n\n  loadDoubts: function loadDoubts(cb) {\n    var self = this;\n\n    $.ajax({\n      url: window.location.pathname + '/student_doubts/page/' + self.page,\n      method: 'GET',\n      data: {\n        per_page: 3\n      },\n      complete: function complete() {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function init() {\n    var self = this;\n\n    if (self.doubtsContainer().length <= 0) return;\n\n    self.expandButton().on('click', function () {\n      self.expandButton().hide();\n      self.form().slideDown('fast');\n    });\n\n    self.hideButton().on('click', function () {\n      self.form().slideUp('fast', function () {\n        self.expandButton().fadeIn('fast');\n      });\n    });\n\n    self.loadMoreButton().on('click', function () {\n      self.page = self.page + 1;\n      var $btn = $(this);\n\n      $btn.attr('disabled', 'disabled');\n      self.loadDoubts(function () {\n        $btn.removeAttr('disabled');\n      });\n    });\n\n    self.loadDoubts();\n  }\n};\n\n(function () {\n  'use strict';\n\n  app.changeTimeZone = function () {\n    $('.js-to-client-timezone').each(function (i, el) {\n      var $el = $(el);\n      var format = $el.data('format');\n      var zone = moment.tz.guess();\n      var time = $el.data('timezone');\n\n      $el.html(moment.tz(time, zone).format(format));\n    });\n\n    $(document).trigger('app:change:timezone');\n  };\n\n  // TODO: FIXME: Essa chamada é para funcionar no primeiro load. Não deveria\n  // ser assim, parece ser algum erro com a inserção de cod no tema\n  app.changeTimeZone();\n})();\n\n(function () {\n  $(document).on('page:load', function () {\n    app.init();\n  });\n\n  $(document).on('page:partial-load', function () {\n    app.bindBlazy();\n  });\n\n  $(document).ready(function () {\n    app.init();\n  });\n})();","(function () {\n  'use strict';\n\n  window.app = {\n    bindGlobal: function () {\n      FastClick.attach(document.body);\n\n      $('.timeago').timeago();\n\n      $(document).trigger('app:bind:global');\n    },\n\n    bindOpenOnLoad: function () {\n      var toOpen = $('.js-open-on-load');\n      if (toOpen.length > 0) {\n        $.each(toOpen, function (i, elem) {\n          window.open($(elem).attr('href'));\n        });\n      }\n\n      $(document).trigger('app:bind:open_on_load');\n    },\n\n    bindTooltips: function () {\n      $(\"[data-toggle='tooltip']\")\n      .tooltip(\"destroy\")\n      .tooltip();\n\n      $(document).trigger('app:bind:tooltips');\n    },\n\n    checkFormValidity: function (event) {\n      var form = event.currentTarget;\n      var submitButton = $(form).find('button[type=\"submit\"]');\n\n      if (form.checkValidity()) {\n        submitButton.removeAttr('disabled');\n      } else {\n        submitButton.attr('disabled', 'disabled');\n      }\n\n      $(document).trigger('app:bind:check_form_validity');\n    },\n\n    init: function () {\n      app.pagarme.init();\n\n      app.bindGlobal();\n      app.bindBlazy();\n      app.bindOpenOnLoad();\n      app.bindMasks();\n      app.bindTooltips();\n      app.bindReadMore();\n      app.bindDatepicker();\n      app.bindFixOnScroll();\n      app.ckeditor.bindCkeditor();\n      app.bindCheckout();\n      app.lessonList.init();\n      app.chat.init();\n      app.studentDoubts.init();\n      app.notepad.init();\n      app.categoryList.init();\n      app.bindExamQuestionForm();\n      app.changeTimeZone();\n      app.followBind();\n      app.lessonPage();\n      app.bindPostsForm();\n\n      $(document).on('app:bind:ckeditor_submit', app.bindCollaborativeDiscussion);\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindBlazy = function (e) {\n    new Blazy();\n\n    $(document).trigger('app:bind:blazy');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.categoryList = {\n    init: function () {\n      var self = this;\n      self.$categoryList = $('#js-category-list');\n\n      if (self.$categoryList.length == 0) return;\n\n      self.isActive = self.$categoryList.data('is-active') || self.isActive;\n\n      if (!self.isActive) {\n        self.bindClicks();\n        self.$categoryList.attr('data-is-active', true);\n        self.isActive = true;\n      }\n\n      self.expandParents();\n    },\n\n    bindClicks: function () {\n      var self = this;\n\n      $(document).on('click', '#js-category-list .category-item .toggle-btn', function () {\n        self.expandParent($(this).parent('.category-item'), true);\n      });\n    },\n\n    expandParent: function ($parent, animate) {\n      var $nextListGroup = $parent.find('.list-group').first();\n      var $parentCategoryItem = $parent;\n\n      if (animate) {\n        $nextListGroup.stop().slideToggle('fast');\n      } else {\n        $nextListGroup.stop().toggle();\n      }\n\n      $parentCategoryItem.toggleClass('expanded');\n    },\n\n    expandParents: function () {\n      var self = this;\n      var $loopItem = self.$categoryList.find('.category-item.current').first();\n\n      while ($loopItem) {\n        self.expandParent($loopItem, false);\n\n        var $parent = $loopItem\n          .parents('.category-item')\n          .first();\n\n        if ($parent.length > 0) {\n          $loopItem = $parent;\n        } else {\n          $loopItem = null;\n        }\n      }\n    }\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.chat = {\n    init: function () {\n      this.$jsChat = $('.js-chat');\n      this.$text = $('.js-chat-text');\n      this.$messagesContainer = $('.js-chat-messages .js-content');\n\n      if (this.$jsChat.length <= 0) return;\n\n      var self = this;\n\n      self.bindScroll();\n\n      // empty test messages\n      this.$messagesContainer.empty();\n\n      // bind form\n      self.$text.keyup(function (e) {\n        var code = e.keyCode ? e.keyCode : e.which;\n        if (code == 13 && !e.shiftKey) {\n          self.submitMessage(e);\n        }\n      });\n\n      self.loadGroups(self.didLoadGroups);\n      self.loadGeneral(self.didLoadGeneral);\n      self.loadFollowers(self.didLoadFollowers);\n\n      app.simpleEditor.init('#js-send-messages');\n\n      $('#js-send-messages').on('submit', self.submitMessage);\n      $('#js-chat-group-list-item').on('click', self.switchRoom);\n\n      const config = {\n        apiKey: 'AIzaSyD2oUy-240XWPEWmGrh6PqJRaoA4lJFN4s',\n        authDomain: 'edools-chat.firebaseapp.com',\n        databaseURL: 'https://edools-chat.firebaseio.com',\n        projectId: 'edools-chat',\n        storageBucket: 'edools-chat.appspot.com',\n        messagingSenderId: '322321995609'\n      };\n\n      firebase.initializeApp(config);\n      var database = firebase.database();\n      this.messages = database.ref('messages');\n      this.loadMessages();\n    },\n\n    bindScroll: function () {\n      var height = this.$jsChat.data('height');\n\n      this.chatHeight = $(window).height() * .8;\n      this.$messagesScrollContainer = this.$jsChat.find('.chat-messages .js-scroll-container');\n      this.$messagesScroll = this.$messagesScrollContainer.find('.js-scroll');\n\n      var $messagesHeader = this.$jsChat.find('.chat-messages .header');\n      var $messagesFooter = this.$jsChat.find('.chat-messages .editor');\n\n      var messagesScrollHeight = (this.chatHeight - 42) - ($messagesHeader.height() + $messagesFooter.height());\n\n      this.$jsChat.height(this.chatHeight);\n      this.$messagesScrollContainer.height(messagesScrollHeight);\n\n      this.$jsChat.find('.js-sidebar-scroll').scrollbar({});\n      this.$messagesScroll.scrollbar({});\n    },\n\n    loadMessages: function () {\n      const setMessage = function (data) {\n        this.insertMessage(data.val());\n\n      }.bind(this);\n\n      this.messages.limitToLast(12).on('child_added', setMessage);\n      this.messages.limitToLast(12).on('child_changed', setMessage);\n    },\n\n    sanitizeHtml: function ($root) {\n      $root.find('div:empty').remove();\n\n      // Removes elements with only '<br/>' children\n      $root.children().each(function (i, el) {\n        var $el = $(el);\n        if (el.tagName != 'BR' && $el.find('br').length > 0 && $el.find('br').length == $el.children().length) {\n          $el.remove();\n        }\n      });\n\n      // Removes last '<br/>'\n      if ($root.last().get(0).tagName == 'BR') {\n        $root.last().remove();\n      }\n\n      return $root;\n    },\n\n    submitMessage: function (event) {\n      event.preventDefault();\n\n      var $html = this.sanitizeHtml(this.$text);\n      var text = $html.html();\n\n      if (text.length <= 0) return;\n\n      this.$text.html('').focus();\n\n      function pad(n) {\n        return (n < 10) ? (\"0\" + n) : n;\n      }\n\n      var date = new Date();\n      var user = $(\"#school-header\").first().data('user');\n\n      app.chat.messages.push({\n        id: user.id,\n        name: user.name,\n        avatar_url: user.avatar_url,\n        text: text,\n        timestamp: moment().unix(),\n        schedule: pad(date.getHours()) + ':' + pad(date.getMinutes())\n      });\n    },\n\n    insertMessage: function (data) {\n      var self = this;\n      var html = self.renderTemplate('chat-message', {\n        avatar: data.avatar_url,\n        name: data.name,\n        text: data.text,\n        schedule: data.schedule\n      });\n\n      self.$messagesContainer.append(html);\n      self.$messagesScroll.scrollTop(self.$messagesScroll[0].scrollHeight);\n    },\n\n    renderTemplate: function (key, data) {\n      var liquid = $('#' + key + '-template').html();\n      var template = Liquid.parse(liquid);\n\n      return template.render(data);\n    },\n\n    loadGroups: function (callback) {\n      var apiKey = $('#js-chat-page').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/groups',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        },\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    loadGeneral: function (callback) {\n      var apiKey = $('#js-chat-page').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/general',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        },\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    loadFollowers: function (callback) {\n      var apiKey = $('#js-chat-page').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/followers',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        },\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    didLoadGroups: function (groups) {\n      var groupTemplate = $(\"#js-chat-group-list-item\").html();\n\n      groups.forEach(function (group) {\n        var $template = $(groupTemplate);\n\n        // set group name\n        $('#js-chat-group-name', $template).html(group.name);\n\n        // set users count\n        var $usersCont = $('#js-chat-group-users-count', $template);\n        $usersCont.html(group.users_count + $usersCont.html());\n\n        // append to group list\n        $('.js-groups').append($template);\n      });\n    },\n\n    didLoadGeneral: function (users) {\n      var self = app.chat;\n      self.addProfileItems(users, 'js-team');\n    },\n\n    didLoadFollowers: function (users) {\n      var self = app.chat;\n      self.addProfileItems(users, 'js-students');\n    },\n\n    addProfileItems: function (users, divClass) {\n      var profileTemplate = $(\"#js-chat-profile-list-item\").html();\n\n      users.forEach(function (user) {\n        var $template = $(profileTemplate);\n\n        var $avatar = $('<img />').addClass('animated').attr('src', user.cover_image_url);\n        $('.avatar', $template).append($avatar);\n\n        $('.name', $template).html(user.first_name + ' ' + user.last_name);\n        $('.location', $template).html(\"Niterói - Rio de Janeiro\");\n\n        if (user.status && user.last_seen) {\n          $('.status', $template).html(\"Niterói - Rio de Janeiro\");\n        }\n\n        $('.' + divClass).append($template);\n      });\n    }\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.bindCheckout = function () {\n    $('#js-terms-of-use-check').change(function () {\n      if ($(this).is(\":checked\") === true) {\n        $('.cta-checkout-cart').removeClass('disabled');\n      } else {\n        $('.cta-checkout-cart').addClass('disabled');\n      }\n    });\n\n    $(document).trigger('app:bind:checkout');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.ckeditor = {\n    bindCkeditor: function () {\n      var src = '//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js';\n\n      if ($('.js-ckeditor').length) {\n        loadAsset('window.CKEDITOR', src, function () {\n          var config = {\n            language: 'pt-br',\n            skin: 'bootstrapck'\n          };\n\n          $('.js-ckeditor').each(function (index, ckeditorObj) {\n            if (!$('#cke_' + ckeditorObj.id).length) {\n              config.placeholder = ckeditorObj.placeholder; // TODO: fix it\n\n              CKEDITOR.replace(ckeditorObj.id, config);\n            }\n          });\n\n          app.ckeditor.bindCkeditorSubmit();\n          $(document).trigger('app:bind:ckeditor');\n        });\n      }\n    },\n\n    bindCkeditorSubmit: function () {\n      $.each($('.js-ckeditor'), function (index, editor) {\n        var $editor = $(editor);\n        var $form = $editor.parents('form');\n        var editorId = $editor.attr('id');\n\n        if ($form) {\n          var $submitButton = $form.find('button[type=\"submit\"]');\n\n          CKEDITOR.instances[editorId].on('change', function () {\n            if (this.getData().length) {\n              $submitButton.attr('disabled', false);\n            } else {\n              $submitButton.attr('disabled', true);\n            }\n          });\n        }\n      });\n\n      $(document).trigger('app:bind:ckeditor_submit');\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindCollaborativeDiscussion = function() {\n    $(document).on('click', '#collaborative-discussion .js-edit-button' ,function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').addClass('hide');\n      $comment.find('.js-edit-container').removeClass('hide');\n    });\n\n    $(document).on('click', '#collaborative-discussion .js-cancel-button' ,function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').removeClass('hide');\n      $comment.find('.js-edit-container').addClass('hide');\n    });\n\n\n    $(document).trigger('app:bind:collaborative_discussion');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindDatepicker = function () {\n    // TODO: Handle i18n\n    $.fn.datepicker.defaults.language = 'pt-BR';\n\n    $('.datepicker').each(function (i, el) {\n      var $el = $(el);\n      var $hidden = $('<input type=\"hidden\" />').insertBefore($el.parent());\n      var frontDate = moment($el.val()).utc().format('DD/MM/YYYY');\n      var serverDate = moment($el.val()).utc().format('YYYY-MM-DD');\n      serverDate = (serverDate === 'Invalid date') ? null : serverDate;\n\n      $hidden.attr('id', $el.attr('id'));\n      $hidden.attr('name', $el.attr('name'));\n      $hidden.attr('value', serverDate);\n\n      $el.removeAttr('id');\n      $el.removeAttr('name');\n\n      if ($el.val() !== \"\") {\n        $el.val(frontDate);\n      }\n\n      $(el).datepicker()\n        .on('change', function () {\n          var date = moment($el.val(), 'DD/MM/YYYY').utc().format('YYYY-MM-DD');\n          date = (date === 'Invalid date') ? null : date;\n          $hidden.val(date);\n        });\n    });\n\n    $(document).trigger('app:bind:datepicker');\n  };\n\n})();\n","(function () {\n  'use strict';\n\n  app.bindExamQuestionForm = function () {\n    $(document).on('click', '#js-remake-exam', function () {\n      $('#answers-container').addClass('hide');\n      $('#form-container').removeClass('hide');\n    });\n\n    $(document).on('click', '.js-clean-associative-options', function () {\n      $(this).parents('.associative-question')\n        .find('.js-associative-select option:selected')\n        .removeAttr('selected')\n    });\n\n    $(document).on('change', '.js-associative-select', function () {\n      var $question = $(this).parents('.associative-question');\n      var optionIndex = $(this).data('option-index');\n      var assertionId = $(this).find('option:selected').data('first-assertion-id');\n\n      $question.find('.js-associate-assertion[data-option-index=\"' + optionIndex + '\"]').val(assertionId);\n    });\n\n    // bind all form's inputs\n    $(document).on('change', '#exam_answer_form', app.checkFormValidity);\n    // bind all form's textareas for all types of typing\n    $(document).on('input propertychange', '#exam_answer_form', app.checkFormValidity);\n\n    $(document).trigger('app:bind:bind_exam_question_form');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindFixOnScroll = function () {\n    $('.js-fix-on-scroll').each(function (i, el) {\n      if (!$(el).hasClass('js-fix-on-scroll-mobile') && window.innerWidth < 992) {\n        return;\n      }\n\n      var $el = $(el);\n      $el.wrap('<div class=\"js-fix-scroll-wrapper\"/>');\n      var $wrapper = $el.parent('.js-fix-scroll-wrapper');\n\n      var offset = $el.offset();\n      var size = {\n        width: $el.outerWidth(),\n        height: $el.outerHeight()\n      };\n\n      $wrapper.width(size.width);\n      $wrapper.height(size.height);\n\n      $(document).on('scroll', function (e) {\n        var scrollTop = $(document).scrollTop();\n\n        if (scrollTop >= offset.top) {\n          if ($el.css('position') === 'fixed') return;\n\n          $el.parent().addClass('scroll');\n          $el.addClass('scroll');\n          $el.css({\n            position: 'fixed',\n            left: offset.left,\n            top: 0,\n            width: size.width,\n            height: size.height,\n            'z-index': '10000'\n          });\n        } else {\n          if ($el.css('position') === 'static') return;\n\n          $el.removeClass('scroll');\n          $el.parent().removeClass('scroll');\n          $el.css({\n            position: 'static',\n            left: 'auto',\n            top: 'auto',\n            width: 'auto',\n            height: 'auto'\n          });\n        }\n      })\n\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.followBind = function () {\n    $(document).on({\n        mouseenter: function(){\n          $(this).addClass('hidden');\n          $('#js-unfollow').removeClass('hidden');\n        }\n    }, '#js-following');\n\n    $(document).on({\n        mouseleave: function(){\n          $('#js-following').removeClass('hidden');\n          $(this).addClass('hidden');\n        }\n    }, '#js-unfollow');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.lessonList = {\n    init: function () {\n      var self = this;\n\n      self.courseTreeExists = self.courseTree().length;\n      self.isActive = self.courseTree().data('is-active');\n      self.course = self.courseTree().data('course');\n      self.enrollment = self.courseTree().data('enrollment');\n      self.courseContent = self.courseTree().data('course-content');\n      self.userType = self.courseTree().data('user-type');\n      self.lessonActions = self.courseTree().data('lesson-actions');\n      self.downloadAction = self.courseTree().data('download-action');\n      self.currentLessonId = parseInt(self.courseTree().data('current-lesson-id'));\n      self.apiKey = self.courseTree().data('api-key');\n\n      self.translations = {};\n      self.translations['lesson.release_at'] = self.courseTree().data('translation-release-at');\n      self.translations['lesson.release_after'] = self.courseTree().data('translation-release-after');\n      self.translations['product.course_content.views'] = self.courseTree().data('translation-course_content-views');\n\n      if (self.courseTreeExists && !self.isActive) {\n        self.bindClicks();\n        self.handleLessons();\n        self.loadTopModules();\n        self.bindChangeLesson();\n\n        $(document).trigger('app:bind:lesson_sidebar');\n\n        $(document).on('lesson-completed', function (event, lessonProgress) {\n          var $mediaControls = $('.btn-next-lesson');\n          var enrollmentId = lessonProgress.data.enrollment_id;\n\n          if ($mediaControls.size() > 0) {\n            $mediaControls.removeClass('disabled');\n          }\n\n          app.lessonList.requirementsExists(lessonProgress.data, function ($item, content_id) {\n            if (content_id) {\n              app.lessonList.checkLessonCompleted(enrollmentId, content_id, function (completed) {\n                if (completed) {\n                  $item.removeClass('blocked');\n                  $item.find('.right > .icon-lock').remove();\n                }\n              });\n            }\n          });\n        });\n      }\n    },\n\n    // Props\n\n    courseTree: function () {\n      return $('.course-content #js-course-tree-ajax');\n    },\n\n    lazyLoadButtons: function () {\n      return $('.course-content #js-course-content-more-link, .course-content #js-course-content-prev-link');\n    },\n\n    lessons: function () {\n      return this.courseTree().find('.js-content');\n    },\n\n    currentLesson: function () {\n      return $(this.courseTree().find('.js-content.active')[0]);\n    },\n\n    toggleButton: function () {\n      return $('.lesson-list-toggle .btn');\n    },\n\n    lessonListPanel: function () {\n      return $('.lesson-list-panel');\n    },\n\n    requirementsExists: function (lessonProgress, cb, cbNotExists) {\n      if (!lessonProgress) {\n        return false;\n      }\n\n      var requirementsElements = $('.lesson-list-panel [data-requirements]').filter(function (index, item) {\n        return $(item).data('requirements').length > 0;\n      });\n\n      var requirementsUnified = requirementsElements.map(function (idx, item) {\n        return {\n          item: $(item),\n          requirements: $(item).data('requirements')\n        }\n      }).toArray();\n\n      var exists = _.find(requirementsUnified, {requirements: [{content_id: lessonProgress.lesson_id}]});\n\n      if (exists) {\n        var $item = exists.item;\n        if (cb) {\n          return cb($item, lessonProgress.lesson_id);\n        }\n      } else {\n        if (cbNotExists) {\n          return cbNotExists();\n        }\n      }\n    },\n\n    checkLessonCompleted: function (enrollmentId, id, cb) {\n      var self = this;\n      var completed = false;\n      var apiKey = $('.course-content #js-course-tree-ajax').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/enrollments/' + enrollmentId + '/lessons_progresses?lesson_id=' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        },\n      }).success(function (data) {\n        completed = data.lessons_progresses[0].completed;\n\n        cb(completed);\n      });\n    },\n\n    // Actions\n    bindChangeLesson: function () {\n      var self = this;\n\n      if (!self.bindChangeLessonActive) {\n        self.bindChangeLessonActive = true;\n        var course_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+$/;\n        var lesson_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+\\/course_contents\\/\\d+$/;\n\n        $(document).on(\"ready page:load\", function (e) {\n          var path = window.location.pathname;\n          var lesson_path = lesson_path_regex.test(path);\n\n          if (course_path_regex.test(path) || lesson_path) {\n            self.lessons().removeClass('active');\n\n            if (lesson_path) {\n              var path_array = path.split('/');\n              var content_id = path_array[path_array.length - 1];\n\n              $(\"#content-\" + content_id + \".js-content\").addClass('active');\n            }\n          }\n        })\n      }\n    },\n\n    bindClicks: function () {\n      var self = this;\n\n      self.lessons().find('a').on('click', function (e) {\n        e.preventDefault();\n        app.lessonList.changeLesson(null, $(this).parents('.js-content'));\n      });\n\n      self.courseTree().on('click', '.module', function (e) {\n        if (!$(e.target).hasClass('module') && !$(e.target).parent().hasClass('module')) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        self.loadChildren($(this));\n      });\n\n      self.courseTree().data('is-active', true);\n\n      self.toggleButton().on('click', this.toggleSidebar);\n    },\n\n    getLessonIcon: function (lesson) {\n      var lessonIcon = '';\n\n      if (lesson.type == 'ExamLesson' && lesson.activity) {\n        switch (lesson.activity.type) {\n          case 'Quiz': {\n            lessonIcon = 'icon-puzzle';\n            break;\n          }\n          case 'FileUpload': {\n            lessonIcon = 'icon-arrow-up-circle';\n            break;\n          }\n          case 'CollaborativeDiscussion': {\n            lessonIcon = 'icon-people';\n            break;\n          }\n          default: {\n            lessonIcon = 'icon-puzzle'\n          }\n        }\n      } else if (lesson.media) {\n        switch (lesson.media) {\n          case 'Video': {\n            lessonIcon = 'icon-camrecorder';\n            break;\n          }\n          case 'Audio': {\n            lessonIcon = 'icon-microphone';\n            break;\n          }\n          case 'Slide': {\n            lessonIcon = 'icon-chart';\n            break;\n          }\n          case 'Document': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'Image': {\n            lessonIcon = 'icon-picture';\n            break;\n          }\n          case 'Text': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'LiveStream': {\n            lessonIcon = 'icon-control-play';\n            break;\n          }\n          case 'VideoSlide': {\n            lessonIcon = 'icon-film';\n            break;\n          }\n          case 'ScormPackage': {\n            lessonIcon = 'icon-layers';\n            break;\n          }\n          case 'Html': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          default: {\n            lessonIcon = 'icon-camrecorder';\n          }\n\n        }\n      }\n\n      return lessonIcon;\n    },\n\n    getContentPath: function (content) {\n      var self = this;\n\n      var enrollmentId = self.enrollment.id;\n      var courseId = self.course.id;\n\n      var path = enrollmentId ? '/enrollments/' + enrollmentId : '/admin_view';\n      path = path + '/courses/' + courseId + '/course_contents/' + content.id;\n\n      return path;\n    },\n\n    getContentDownloadPath: function (content) {\n      var self = this;\n      return self.getContentPath(content) + '/download';\n    },\n\n    checkLessonAvailability: function (lesson) {\n      var releaseAt = lesson.release_at;\n      var releaseAfter = lesson.release_after;\n\n      if (!releaseAt && !releaseAfter) {\n        return true;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at);\n\n      var releaseTime = releaseAt ? moment(releaseAt) : enrollmentActivatedAt.add(releaseAfter, 'days');\n\n      return moment() > releaseTime;\n    },\n\n    checkTrialByType: function (type) {\n      var $tree = $('#js-course-tree-ajax');\n      var $enrollment = $tree.data('enrollment');\n      var constrains_name = 'trial_' + type + '_ids';\n\n      var payment_method = $enrollment.payment_method;\n      var constrains_tree = $tree.data('school-product').trial_constrains;\n      var constrains = constrains_tree[payment_method];\n\n      if (constrains && !constrains.hasOwnProperty(constrains_name)) {\n        return false;\n      }\n\n      if (!$enrollment['on_trial?']) {\n        return function () {\n          return false;\n        }\n      }\n\n      return function (id) {\n        if (constrains_tree && constrains[constrains_name]) {\n          return constrains[constrains_name].indexOf(id) > -1;\n        }\n      }\n    },\n\n    fetchModules: function ($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          var modules = _.sortBy(res.course_modules, 'order');\n\n          modules = _.filter(modules, function (m) {\n            var module = _.find(self.allModules, {id: m.id});\n            return module.available != false && (module.course_content_ids.length > 0 || module.course_modules.length > 0);\n          });\n\n          var $modules = _.map(modules, function (module) {\n            return $(\n              '<li class=\"list-group-item module\" ' +\n              'data-id=\"' + module.id + '\"' +\n              'data-level=\"' + (level + 1) + '\">' +\n              '<i class=\"icon icon-arrow-right\"></i>' +\n              '<span>' + module.name + '</span>' +\n              '<i class=\"busy busy-xs\"></i>' +\n              '</li>');\n          });\n\n          $list.append($modules);\n        }\n      })\n    },\n\n    fetchChildren: function ($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id + '/course_contents',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          var blockedContent = self.checkTrialByType('content');\n          var courseContents = _.filter(res.course_contents, function (lesson) {\n            return lesson.available != false;\n          });\n\n          courseContents = _.sortBy(courseContents, 'order');\n\n          if (self.enrollment) {\n            courseContents = _.map(courseContents, function (content) {\n              content.completed = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(content.lesson.id) > -1;\n              return content;\n            });\n          }\n\n          var $courseContents = _.map(courseContents, function (content) {\n              var active = (self.currentLessonId == content.lesson.id ? 'active js' : '');\n              var lesson = content.lesson;\n              var lessonIcon = self.getLessonIcon(lesson);\n              var hideInProgressIcon = 'hide';\n              var hideCompletedIcon = 'hide';\n              var lessonReleased = null;\n              var releaseType = null;\n              var releaseDate = null;\n              var progress = null;\n              var requirements = content.requirements;\n              var available = true;\n              var requirements_ids = requirements.map(function (item) {\n                return item.content_id;\n              });\n\n              if (self.enrollment) {\n                lessonReleased = self.checkLessonAvailability(lesson);\n\n                if (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(lesson.id) > -1) {\n                  hideInProgressIcon = 'hide';\n                  hideCompletedIcon = null;\n                } else {\n                  if (self.enrollment.lessons_info && self.enrollment.lessons_info.in_progress.indexOf(lesson.id) > -1) {\n                    hideInProgressIcon = null;\n                    hideCompletedIcon = 'hide';\n                  } else {\n                    hideInProgressIcon = 'hide';\n                    hideCompletedIcon = 'hide';\n                  }\n                }\n\n                if (lesson.release_at) {\n                  releaseType = 'release_at';\n                  releaseDate = lesson.release_at;\n                } else if (lesson.release_after) {\n                  releaseType = 'release_after';\n                  releaseDate = moment(self.enrollment.activated_at).add(lesson.release_after, 'days');\n                }\n\n                if (self.lessonActions) {\n                  progress = _.find(self.enrollment.lessons_progresses, {lesson_id: lesson.id});\n                }\n              }\n\n              if (self.enrollment) {\n                _.each(requirements_ids, function (id) {\n                  var exists = _.find(courseContents, {content_id: id, completed: true});\n\n                  if (!exists) {\n                    available = false;\n                  }\n                });\n              }\n\n              var html = '<li class=\"list-group-item content-lesson js-content list-group-item lesson module-item ' + active + (!available || blockedContent(content.id) ? ' blocked' : '') + '\" ' +\n                'id=\"content-' + content.id + '\" ' +\n                'data-requirements=\\'' + JSON.stringify(requirements) + '\\'' +\n                'data-id=\"' + content.lesson.id + '\"' +\n                'data-level=\"1\">' +\n                '<div id=\"lesson-' + lesson.id + '\" class=\"js-lesson content-lesson ' + active + (!lessonReleased ? ' not-released' : '') + '\" data-lesson-id=\"' + lesson.id + '\">' +\n                '<div class=\"class-info\">' +\n\n                '<div class=\"left\"><i class=\"' + lessonIcon + '\"></i></div>' +\n\n                '<div class=\"center\">' +\n                (self.lessonActions && lessonReleased ?\n                  '<a class=\"lesson-title\" href=\"' + self.getContentPath(content) + '\"><span>' + lesson.title + '</span></a>' :\n                  '<span class=\"lesson-title\"><span class=\"disabled\">' + lesson.title + '</span></span>') +\n                '</div>' +\n\n                '<div class=\"right\">' +\n                ((!available || blockedContent(content.id)) ? '<i class=\"icon-lock\"></i>' : '') +\n                '<span class=\"progress-icon js-progress-icons\">' +\n                '<i class=\"icon-check js-completed-icon ' + hideCompletedIcon + '\"></i>' +\n                '<i class=\"icon-clock js-in-progress-icon ' + hideInProgressIcon + '\"></i>' +\n                '</span>';\n\n              if (self.lessonActions) {\n                if (progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts') {\n                  html += '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + self.translations['product.course_content.views'] + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' +\n                    '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' +\n                    '</span>';\n                }\n\n                if (!lessonReleased) {\n                  var zone = moment.tz.guess();\n                  html += '<span class=\"release-date badge\">' + self.translations['lesson.' + releaseType] + '<span> ' + moment.tz(releaseDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n                }\n\n                if (self.downloadAction && content.downloadable) {\n                  html += '<a class=\"download-link\" href=\"' + self.getContentDownloadPath(content) + '\" data-no-turbolink>' +\n                    '<i class=\"icon-cloud-download\"></i>' +\n                    '</a>';\n                }\n              }\n\n              html += '</div>' +\n                '</div>' +\n                '</li>';\n\n              return $(html);\n            }\n          );\n\n          $list.append($courseContents);\n          self.checkNextButtonUnlocked();\n\n        }\n      });\n    },\n\n    checkNextButtonUnlocked: function () {\n      var lessonProgress = $('#js-course-tree-ajax').data('lesson-progress');\n\n      app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n        if (content_id && lessonProgress.hasOwnProperty('enrollment_id')) {\n          app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n            if (completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n              $item.removeClass('blocked');\n              $item.find('.right > .icon-lock').remove();\n            }\n          });\n        }\n      }, function () {\n        $('.btn-next-lesson').removeClass('disabled');\n      });\n    },\n\n    loadTopModules: function () {\n      var self = this;\n\n      if (!self.course) return;\n\n      $.ajax({\n        url: window.CORE_HOST + '/courses/' + self.course.id + '/course_modules',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          const blockedModule = self.checkTrialByType('module');\n          if (!res.course_modules || res.course_modules.length <= 0) return;\n\n          self.allModules = res.course_modules;\n\n          self.topModules = _.filter(res.course_modules, function (x) {\n            return (x.parent_course_module == null && x.available != false) &&\n              (x.course_content_ids.length > 0 || x.course_modules.length > 0);\n          });\n\n          self.topModules = _.sortBy(self.topModules, 'order');\n\n          var $modules = _.map(self.topModules, function (module) {\n            var disabled = blockedModule(module.id);\n\n            return $(\n              '<li class=\"list-group-item module ' + (disabled ? 'disabled' : '') + '\" ' +\n              'data-id=\"' + module.id + '\"' +\n              'data-level=\"1\">' +\n              '<i class=\"icon icon-arrow-right\"></i>' +\n              '<span>' + module.name + '</span>' +\n              '<i class=\"busy busy-xs\"></i>' +\n              '</li>');\n          });\n\n          self.courseTree().prev('.course-content-busy').fadeOut('fast', function () {\n            self.courseTree().css('display', 'none');\n            self.courseTree().html($modules);\n            self.courseTree().fadeIn('fast');\n\n            if (self.courseContent) {\n              self.expandParentModules(self.courseContent.parent_modules_hash);\n            }\n          });\n        }\n      })\n    },\n\n    loadChildren: function (parent, cb) {\n      var self = this;\n      var $parent = $(parent);\n\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      if ($list.length <= 0) {\n        $parent.find('.busy').css({opacity: 1});\n        $list = $('<ul class=\"list-group\" style=\"display: none;\"></ul>');\n        $list.appendTo($parent);\n\n        $.when(self.fetchModules($parent), self.fetchChildren($parent))\n          .then(function () {\n            $parent.addClass('expanded');\n            $parent.find('.busy').css({opacity: 0});\n\n            $list.slideDown('fast');\n\n            if (typeof cb == 'function') {\n              cb();\n            }\n          });\n      } else {\n        if ($parent.hasClass('expanded')) {\n          $parent.removeClass('expanded');\n          $list.slideUp('fast');\n        } else {\n          $parent.addClass('expanded');\n          $list.slideDown('fast');\n        }\n\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    },\n\n    handleLessons: function () {\n      $(document).on('page:load page:restore', function (e) {\n\n        if (!e.originalEvent || !e.originalEvent.data || e.originalEvent.data.length == 0) return;\n\n        var $html = $(e.originalEvent.data[0]);\n        app.lessonList.lessons().each(function (i, el) {\n          var $el = $(el);\n          var $new = $html.find('#' + $el.attr('id'));\n          $el.html($new.html());\n        });\n      })\n    },\n\n    changeLesson: function (direction, lesson) {\n      var $targetLesson = $(lesson);\n\n      if (direction == 'prev') {\n        var $prev = app.lessonList\n          .currentLesson()\n          .prevAll('.js-content');\n\n        if ($prev.length > 0 && $prev.find('a').length > 0)\n          $targetLesson = $($prev[0]);\n      } else if (direction == 'next') {\n        var $next = app.lessonList\n          .currentLesson()\n          .nextAll('.js-content');\n\n        if ($next.length > 0 && $next.find('a').length > 0)\n          $targetLesson = $($next[0]);\n      }\n\n      $targetLesson.find('a')[0].click();\n    },\n\n    expandParentModules: function (parentModules) {\n      var self = this;\n\n      var modules = [];\n      var loopModule = parentModules.course_module;\n      modules.push(loopModule.id);\n\n      while (loopModule.parent_module) {\n        loopModule = loopModule.parent_module;\n        modules.push(loopModule.id);\n      }\n\n      modules = modules.reverse();\n\n      async.eachSeries(modules, function (moduleId, cb) {\n        var $module = $('.module[data-id=\"' + moduleId + '\"]');\n        self.loadChildren($module, cb);\n      });\n\n    },\n\n    toggleSidebar: function () {\n      app.lessonList.toggleButton().toggleClass('active');\n      app.lessonList.lessonListPanel().toggleClass('active');\n    }\n  };\n\n})();\n","(function () {\n  'use strict';\n\n  app.lessonPage = function () {\n    var REGEX_COLLABORATIVE_DISCUSSIONS = /\\/collaborative_discussions\\/([0-9]+)\\/collaborative_comments/;\n    var REGEX_EXAM_ANSWERS = /\\/exam_answers/;\n\n    var isCollaborativeDiscuttion = function (value) {\n      return REGEX_COLLABORATIVE_DISCUSSIONS.test(value);\n    };\n\n    var isExamAnswer = function (value) {\n      return REGEX_EXAM_ANSWERS.test(value);\n    };\n\n    $(document).ajaxSuccess(function (event, xhr, settings) {\n\n      if (isCollaborativeDiscuttion(settings.url) || isExamAnswer(settings.url)) {\n\n        var lessonProgress = $('#js-course-tree-ajax').data('lesson-progress');\n\n        app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n          if (content_id && lessonProgress.hasOwnProperty('enrollment_id')) {\n            app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n              if (completed) {\n                $('.btn-next-lesson').removeClass('disabled');\n                $item.removeClass('disabled');\n                $item.find('.right > .icon-lock').remove();\n              }\n            });\n          }\n        }, function () {\n          $('.btn-next-lesson').removeClass('disabled');\n        });\n\n      }\n    });\n\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindMasks = function () {\n    var phoneMaskBehavior = function (val) {\n      return val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n    };\n\n    var phoneMaskOptions = {\n      onKeyPress: function (val, e, field, options) {\n        field.mask(phoneMaskBehavior.apply({}, arguments), options);\n      }\n    };\n\n    $('#user-phone').mask(phoneMaskBehavior, phoneMaskOptions);\n    $('#user-cpf').mask('999.999.999-99');\n    $('#user-cep').mask('99.999-999');\n\n    $(document).trigger('app:bind:masks');\n  };\n})();\n","app.notepad = {\n  page: 1,\n\n  noteContainer: function () {\n    return $('#notepad-container');\n  },\n\n  form: function () {\n    return $('#js-notepad-form');\n  },\n\n  loadNote: function (lesson_id, cb) {\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'GET',\n      success: function () {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    })\n  },\n\n  saveNote: function (cb) {\n    var note = $(\"#js-note\").html();\n    var note_id = $(\"#js_note_id\").val();\n\n    var $button = $(\"#save_notepad_button\");\n    var buttonLabel = $button.html();\n    $button.html($button.data(\"sending\"));\n    $button.prop('disabled', true);\n\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'POST',\n      data: {\n        _id: note_id,\n        note: note\n      },\n      success: function () {\n        $button.html(buttonLabel);\n        $button.prop('disabled', false);\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function () {\n    var self = this;\n    if (this.noteContainer().length <= 0) return;\n    this.loadNote($(\"#lesson_id\").val());\n\n    $(\"#notepad_form\").on('submit', function(event) {\n      event.preventDefault();\n      self.saveNote();\n    });\n  }\n};\n","(function () {\n  'use strict';\n\n  app.pagarme = {\n    buildCreditCard: function () {\n      var creditCard = new PagarMe.creditCard();\n      var expiration = $(\"#card-form #card-expiration\").val().split('/');\n\n      creditCard.cardExpirationMonth = parseInt(expiration[0]);\n      creditCard.cardExpirationYear  = parseInt(expiration[1]);\n      creditCard.cardHolderName      = $(\"#card-form #card-holder-name\").val();\n      creditCard.cardNumber          = $(\"#card-form #card-number\").val();\n      creditCard.cardCVV             = $(\"#card-form #card-cvc\").val();\n\n      return creditCard;\n    },\n\n    submitFormCreditCardHash: function (paymentForm) {\n      var creditCard  = app.pagarme.buildCreditCard();\n      var fieldErrors = creditCard.fieldErrors();\n      var hasErrors   = false;\n      for(var field in fieldErrors) { hasErrors = true; break; }\n\n      console.log(1);\n      window.creditCardTest = creditCard;\n\n      if(hasErrors) {\n        window.fieldErrors = fieldErrors;\n\n        console.log(window.fieldErrors);\n      } else {\n        creditCard.generateHash(function(cardHash) {\n          $('#card_hash').val(cardHash);\n\n          paymentForm.get(0).submit();\n        });\n      }\n    },\n\n    init: function () {\n      var src = 'https://assets.pagar.me/js/pagarme.min.js',\n        paymentForm = $('#card-form'),\n        pagarmeKey  = $(\"#pagarme\").val();\n\n      if (paymentForm.length && pagarmeKey) {\n        loadAsset('PagarMe', src, function () {\n          PagarMe.encryption_key = pagarmeKey;\n\n          paymentForm.submit(function(event) {\n            event.preventDefault();\n\n            app.pagarme.submitFormCreditCardHash(paymentForm);\n          });\n\n          $(document).trigger('app:bind:pagarme');\n        });\n      }\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindPostsForm = function () {\n    $(document).on('click', '.js-post-edit', function () {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').addClass('hidden');\n      post.find('.js-post-form').removeClass('hidden');\n    });\n\n    $(document).on('click', '.js-post-cancel', function (e) {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').removeClass('hidden');\n      post.find('.js-post-form').addClass('hidden');\n    });\n\n    $(document).trigger('app:bind:bind_posts_form');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindReadMore = function () {\n    $('[role=\"readmore\"]').each(function (i, el) {\n      var speed = $(el).data('speed') || 100;\n      var collapsedHeight = $(el).data('collapsed-height') || 200;\n      var moreText = $(el).data('more-text') || 'Leia Mais';\n      var lessText = $(el).data('less-text') || 'Fechar';\n\n      var currHeight = $(el).innerHeight();\n      var showLink = currHeight <= collapsedHeight;\n\n      $(el).readmore({\n        speed: speed,\n        collapsedHeight: collapsedHeight,\n        moreLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + moreText + '</a>',\n        lessLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + lessText + '</a>'\n      })\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.simpleEditor = {\n\n    createShortcut: function (bindKey, callback) {\n      var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n      var bindFunction = function (e) {\n        var character = String.fromCharCode(e.keyCode);\n        var ctrl = e.ctrlKey;\n        var meta = !!e.metaKey;\n        var score = 0;\n\n        if (isMac && meta) {\n          score++;\n        } else if (ctrl) {\n          score++;\n        }\n\n        if (character == bindKey) {\n          score++;\n        }\n\n        if (score == 2) {\n          e.stopPropagation();\n          e.preventDefault();\n          return callback();\n        }\n\n      };\n\n      $('body').bind('keydown', bindFunction);\n    },\n\n    handleDrag: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n\n    handleDrop: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var x = e.clientX;\n      var y = e.clientY;\n      var file = e.dataTransfer.files[0];\n\n      var URLObj = window.URL || window.webkitURL;\n      var source = URLObj.createObjectURL(file);\n\n      if (file.type.match('image.*')) {\n\n        var img = document.createElement(\"img\");\n\n        img.src = source;\n\n        if (document.caretPositionFromPoint) {\n          var pos = document.caretPositionFromPoint(x, y);\n          range = document.createRange();\n          range.setStart(pos.offsetNode, pos.offset);\n          range.collapse();\n          range.insertNode(img);\n        } else if (document.caretRangeFromPoint) {\n          range = document.caretRangeFromPoint(x, y);\n          range.insertNode(img);\n        }\n      }\n    },\n\n    updateButtons: function () {\n      var bold = document.queryCommandState(\"Bold\");\n      var italic = document.queryCommandState(\"Italic\");\n      var underline = document.queryCommandState(\"Underline\");\n\n      if (bold === true) {\n        $('[data-action=bold]').addClass('active');\n      } else {\n        $('[data-action=bold]').removeClass('active');\n      }\n\n      if (italic === true) {\n        $('[data-action=italic]').addClass('active');\n      } else {\n        $('[data-action=italic]').removeClass('active');\n      }\n\n      if (underline === true) {\n        $('[data-action=underline]').addClass('active');\n      } else {\n        $('[data-action=underline]').removeClass('active');\n      }\n    },\n\n    init: function (container) {\n      this.$container = $(container);\n\n      this.$input = this.$container.find('.js-input');\n      this.$btnAction = this.$container.find('.js-btn-action');\n\n      this.registerTriggers();\n      this.registerDropZone();\n      this.registerShortcuts();\n    },\n\n    registerTriggers: function () {\n      var self = this;\n\n      self.$btnAction.on('click', function () {\n        var action = $(this).attr('data-action');\n        document.execCommand(action);\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('click', function () {\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('focusin', function () {\n        self.$container.addClass('focused');\n      });\n\n      self.$input.on('focusout', function () {\n        self.$container.removeClass('focused');\n      });\n    },\n\n    registerDropZone: function () {\n      var dropZone = $(this.container).find('.js-input');\n      dropZone.on('dragover', app.simpleEditor.handleDrag, false);\n      dropZone.on('drop', app.simpleEditor.handleDrop, false);\n    },\n\n    registerShortcuts: function () {\n\n      app.simpleEditor.createShortcut('U', function () {\n        document.execCommand('underline');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('B', function () {\n        document.execCommand('bold');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('I', function () {\n        document.execCommand('italic');\n        app.simpleEditor.updateButtons();\n      });\n    }\n  };\n\n})();\n","app.studentDoubts = {\n  page: 1,\n\n  doubtsContainer: function () {\n    return $('#js-doubts-container');\n  },\n\n  form: function () {\n    return $('#js-student-doubts-form');\n  },\n\n  expandButton: function () {\n    return $('#js-expand-student-doubts-form');\n  },\n\n  hideButton: function () {\n    return $('#js-hide-student-doubts-form');\n  },\n\n  loadMoreButton: function () {\n    return $('#js-load-more-doubts');\n  },\n\n  loadDoubts: function (cb) {\n    var self = this;\n\n    $.ajax({\n      url: window.location.pathname + '/student_doubts/page/' + self.page,\n      method: 'GET',\n      data: {\n        per_page: 3\n      },\n      complete: function () {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    })\n  },\n\n  init: function () {\n    var self = this;\n\n    if (self.doubtsContainer().length <= 0) return;\n\n    self.expandButton().on('click', function () {\n      self.expandButton().hide();\n      self.form().slideDown('fast');\n    });\n\n    self.hideButton().on('click', function () {\n      self.form().slideUp('fast', function () {\n        self.expandButton().fadeIn('fast');\n      });\n    });\n\n    self.loadMoreButton().on('click', function () {\n      self.page = self.page + 1;\n      var $btn = $(this);\n\n      $btn.attr('disabled', 'disabled');\n      self.loadDoubts(function () {\n        $btn.removeAttr('disabled');\n      });\n    });\n\n    self.loadDoubts();\n  }\n};\n","(function () {\n  'use strict';\n\n  app.changeTimeZone = function () {\n    $('.js-to-client-timezone').each(function (i, el) {\n      var $el = $(el);\n      var format = $el.data('format');\n      var zone = moment.tz.guess();\n      var time = $el.data('timezone');\n\n      $el.html(moment.tz(time, zone).format(format));\n    });\n\n    $(document).trigger('app:change:timezone');\n  };\n\n  // TODO: FIXME: Essa chamada é para funcionar no primeiro load. Não deveria\n  // ser assim, parece ser algum erro com a inserção de cod no tema\n  app.changeTimeZone();\n})();\n","(function () {\n  $(document).on('page:load', function () {\n    app.init();\n  });\n\n  $(document).on('page:partial-load', function () {\n    app.bindBlazy();\n  });\n\n  $(document).ready(function () {\n    app.init();\n  });\n})();\n"]}