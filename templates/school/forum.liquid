<div class="forums-page school-forums-page">
  <div class="forum-page page">
    <div class="container">
      <h3>
        <span class="forum-title">{{ forum.title }}</span>
        <p class="small">{{ forum.description }}</p>
      </h3>

      <div class="modal fade" tabindex="-1" role="dialog" id="sectionModal">
        <div class="modal-dialog" role="document">
          {% form 'forum/section' %}
            <input type="hidden" name="forum_id" value="{{forum.forum_id}}">
            <input type="hidden" name="forum_section[parent_forum_section_id]" value="{{forum.id}}">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">
                  {{ 'forums.new_section' | t }}
                </h4>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label for="name_section">Nome</label>
                  <input type="text" class="form-control" name="forum_section[title]" id="name_section" required />
                </div>
                <div class="form-group">
                  <label for="description_section">Descrição</label>
                  <input type="text" class="form-control" name="forum_section[description]" id="description_section" required />
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="submit" class="btn btn-primary">Salvar</button>
              </div>
            </div>
          {% endform %}
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

      <form accept-charset="UTF-8" method="get" action="/school/forums/{{ forum.id }}" data-turbolinks-scroll="false">
        <div class="input-group input-group-lg">
          <span class="input-group-addon no-background"><i class="icon-magnifier"></i></span>
          <input type="text" class="form-control" name="title" placeholder="{{ 'forums.filter_by_title' | t }}"
          value="{{ current_search.title }}">
          <span class="input-group-btn">
            <input type="submit" value="{{ 'general.search' | t }}" class="btn btn-default">
          </span>
        </div>
      </form>

      <hr/>

      <div class="forum-sections list-group">
        {% paginate sections by 10 sort { order: :asc } %}
          {% if sections.total_count == 0 and current_search.size == 0 %}
            <div class="alert alert-info text-center">
              {{ 'forums.sections.empty' | t }}
            </div>
          {% else %}
            {% for section in sections %}
              <article id="section-{{ section.id }}" class="section list-group-item clearfix">
                <div class="section-content clearfix">
                  <div class="list-group-item-heading needsclick">
                    <section class="head-section">
                      <label class="toggle">
                        <a class="section-title title" href="{{ section | section_path }}">
                          {{ section.title }}
                        </a>
                      </label>
                      <p class="list-group-item-text">{{ section.description }}</p>
                      <div class="clearfix"></div>
                    </section>

                    {% if section.topics.size > 0 %}
                      <div id="section-{{ section.id }}-topics" class="section-topics">
                        <div class="section-topics-list">
                          {% for topic in section.topics %}
                            <div class="section-topic section-topic-striped">
                              <a class="title" href="{{ topic | topic_path }}">
                                {{ topic.title }}
                              </a>
                            </div>
                          {% endfor %}
                        </div>
                      </div>
                    {% endif %}
                  </div>
                </div>
                <div id="topics-count" class="section-meta pull-right">
                  <b>
                    {{ 'forums.sections.topics_count' | t: count: section.topics_count }}
                  </b>
                </div>
              </article>
            {% endfor %}

            {% include 'pagination_links' %}
          {% endif %}
        {% endpaginate %}
      </div>
    </div>
  </div>
</div>
